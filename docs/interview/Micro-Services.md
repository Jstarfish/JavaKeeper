服务注册与发现的基本模型

![](/Users/starfish/Documents/截图/截屏2024-07-02 10.04.09.png)

举一个例子，你去一个陌生的城市出差，下班了想去吃个火锅，还得是重庆火锅。那么你怎 么知道这个城市哪里有重庆火锅？ 你可能会说，我在 App 里面搜一下。那么 App 又怎么知道这里有一家重庆火锅店呢？你继 续说，这肯定是商家去这个 App 注册过了呀！对，服务注册与发现模型就是这样。你扮演了 客户端的角色，火锅店扮演了服务端的角色，而 App 则是扮演了我们常说的注册中心的角 色。



![](/Users/starfish/Documents/截图/截屏2024-07-02 10.08.12.png)

1. 服务端启动的时候，需要往注册中心里注册自身的信息，主要是定位信息。 
2.  注册成功之后，注册中心和服务端要保持心跳。  
3. 客户端第一次发起对某个服务的调用之前，要先找注册中心获得所有可用服务节点列表， 随后客户端会在本地缓存每个服务对应的可用节点列表。 
4. 客户端和注册中心要保持心跳和数据同步，后续服务端有任何变动，注册中心都会通知客 户端，客户端会更新本地的可用节点列表。 
5. 客户端发送请求。 
6. 服务端返回响应。





你们用了什么中间件作为注册中心以及该中间件的优缺点。确保自己在回答“你为什么用 某个中间价作为注册中心”的时候，能够综合这些优缺点来回答。 注册中心的集群规模。 读写 QPS（每秒查询率）。 机器性能，如 CPU 和内存大小。 最好准备一个注册中心出故障之后你排查和后续优化的案例。在讨论使用注册中心的注意 事项，或者遇到过什么 Bug 的时候可以用这个案例。