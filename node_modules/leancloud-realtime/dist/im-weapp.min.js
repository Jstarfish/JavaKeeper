!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("leancloud-realtime",["exports"],t):t((e=e||self).AV=e.AV||{})}(this,(function(e){"use strict";var t="undefined"!=typeof window&&window.process||{};function n(){return function(){return{}}}t.env=t.env||{},global.Object=Object;var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return s(null==t&&n.path)}},n.exports),n.exports}function o(e){return e&&e.default||e}function s(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var a=i((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:{};"number"==typeof __g&&(__g=t)})),u=i((function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)})),c=(u.version,function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}),f=function(e,t,n){if(c(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},l=function(e){return"object"==typeof e?null!==e:"function"==typeof e},h=function(e){if(!l(e))throw TypeError(e+" is not an object!");return e},p=function(e){try{return!!e()}catch(e){return!0}},d=!p((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),m=a.document,v=l(m)&&l(m.createElement),g=function(e){return v?m.createElement(e):{}},y=!d&&!p((function(){return 7!=Object.defineProperty(g("div"),"a",{get:function(){return 7}}).a})),b=function(e,t){if(!l(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!l(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!l(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!l(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},w=Object.defineProperty,_={f:d?Object.defineProperty:function(e,t,n){if(h(e),t=b(t,!0),h(n),y)try{return w(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},E=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},T=d?function(e,t,n){return _.f(e,t,E(1,n))}:function(e,t,n){return e[t]=n,e},S={}.hasOwnProperty,I=function(e,t){return S.call(e,t)},A=function(e,t,r){var i,o,s,c=e&A.F,l=e&A.G,h=e&A.S,p=e&A.P,d=e&A.B,m=e&A.W,v=l?u:u[t]||(u[t]={}),g=v.prototype,y=l?a:h?a[t]:(a[t]||{}).prototype;for(i in l&&(r=t),r)(o=!c&&y&&void 0!==y[i])&&I(v,i)||(s=o?y[i]:r[i],v[i]=l&&"function"!=typeof y[i]?r[i]:d&&o?f(s,a):m&&y[i]==s?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(s):p&&"function"==typeof s?f(n.call,s):s,p&&((v.virtual||(v.virtual={}))[i]=s,e&A.R&&g&&!g[i]&&T(g,i,s)))};A.F=1,A.G=2,A.S=4,A.P=8,A.B=16,A.W=32,A.U=64,A.R=128;var O=A,C={}.toString,M=function(e){return C.call(e).slice(8,-1)},x=Array.isArray||function(e){return"Array"==M(e)};O(O.S,"Array",{isArray:x});var k,P=u.Array.isArray,R=Object.freeze({__proto__:null}),N=Math.ceil,L=Math.floor,j=function(e){return isNaN(e=+e)?0:(e>0?L:N)(e)},F=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},D=T,B={},U=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==M(e)?e.split(""):Object(e)},V=function(e){return U(F(e))},Y=Math.min,q=function(e){return e>0?Y(j(e),9007199254740991):0},z=Math.max,W=Math.min,G=i((function(e){var t=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:u.version,mode:"pure",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})})),$=0,J=Math.random(),Z=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++$+J).toString(36))},K=G("keys"),X=function(e){return K[e]||(K[e]=Z(e))},H=(k=!1,function(e,t,n){var r,i=V(e),o=q(i.length),s=function(e,t){return(e=j(e))<0?z(e+t,0):W(e,t)}(n,o);if(k&&t!=t){for(;o>s;)if((r=i[s++])!=r)return!0}else for(;o>s;s++)if((k||s in i)&&i[s]===t)return k||s||0;return!k&&-1}),Q=X("IE_PROTO"),ee=function(e,t){var n,r=V(e),i=0,o=[];for(n in r)n!=Q&&I(r,n)&&o.push(n);for(;t.length>i;)I(r,n=t[i++])&&(~H(o,n)||o.push(n));return o},te="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ne=Object.keys||function(e){return ee(e,te)},re=d?Object.defineProperties:function(e,t){h(e);for(var n,r=ne(t),i=r.length,o=0;i>o;)_.f(e,n=r[o++],t[n]);return e},ie=a.document,oe=ie&&ie.documentElement,se=X("IE_PROTO"),ae=function(){},ue=function(){var e,t=g("iframe"),n=te.length;for(t.style.display="none",oe.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),ue=e.F;n--;)delete ue.prototype[te[n]];return ue()},ce=Object.create||function(e,t){var n;return null!==e?(ae.prototype=h(e),n=new ae,ae.prototype=null,n[se]=e):n=ue(),void 0===t?n:re(n,t)},fe=i((function(e){var t=G("wks"),n=a.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:Z)("Symbol."+e))}).store=t})),le=_.f,he=fe("toStringTag"),pe=function(e,t,n){e&&!I(e=n?e:e.prototype,he)&&le(e,he,{configurable:!0,value:t})},de={};T(de,fe("iterator"),(function(){return this}));var me,ve=function(e,t,n){e.prototype=ce(de,{next:E(1,n)}),pe(e,t+" Iterator")},ge=function(e){return Object(F(e))},ye=X("IE_PROTO"),be=Object.prototype,we=Object.getPrototypeOf||function(e){return e=ge(e),I(e,ye)?e[ye]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?be:null},_e=fe("iterator"),Ee=!([].keys&&"next"in[].keys()),Te=function(){return this},Se=function(e,t,n,r,i,o,s){ve(n,t,r);var a,u,c,f=function(e){if(!Ee&&e in d)return d[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},l=t+" Iterator",h="values"==i,p=!1,d=e.prototype,m=d[_e]||d["@@iterator"]||i&&d[i],v=m||f(i),g=i?h?f("entries"):v:void 0,y="Array"==t&&d.entries||m;if(y&&(c=we(y.call(new e)))!==Object.prototype&&c.next&&pe(c,l,!0),h&&m&&"values"!==m.name&&(p=!0,v=function(){return m.call(this)}),s&&(Ee||p||!d[_e])&&T(d,_e,v),B[t]=v,B[l]=Te,i)if(a={values:h?v:f("values"),keys:o?v:f("keys"),entries:g},s)for(u in a)u in d||D(d,u,a[u]);else O(O.P+O.F*(Ee||p),t,a);return a},Ie=(me=!0,function(e,t){var n,r,i=String(F(e)),o=j(t),s=i.length;return o<0||o>=s?me?"":void 0:(n=i.charCodeAt(o))<55296||n>56319||o+1===s||(r=i.charCodeAt(o+1))<56320||r>57343?me?i.charAt(o):n:me?i.slice(o,o+2):r-56320+(n-55296<<10)+65536});Se(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=Ie(t,n),this._i+=e.length,{value:e,done:!1})}));var Ae=function(e,t){return{value:t,done:!!e}};Se(Array,"Array",(function(e,t){this._t=V(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,Ae(1)):Ae(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values");B.Arguments=B.Array;for(var Oe=fe("toStringTag"),Ce="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Me=0;Me<Ce.length;Me++){var xe=Ce[Me],ke=a[xe],Pe=ke&&ke.prototype;Pe&&!Pe[Oe]&&T(Pe,Oe,xe),B[xe]=B.Array}var Re=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:T(e,r,t[r]);return e},Ne=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e},Le=function(e,t,n,r){try{return r?t(h(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&h(i.call(e)),t}},je=fe("iterator"),Fe=Array.prototype,De=function(e){return void 0!==e&&(B.Array===e||Fe[je]===e)},Be=fe("toStringTag"),Ue="Arguments"==M(function(){return arguments}()),Ve=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Be))?n:Ue?M(t):"Object"==(r=M(t))&&"function"==typeof t.callee?"Arguments":r},Ye=fe("iterator"),qe=u.getIteratorMethod=function(e){if(null!=e)return e[Ye]||e["@@iterator"]||B[Ve(e)]},ze=i((function(e){var t={},n={},r=e.exports=function(e,r,i,o,s){var a,u,c,l,p=s?function(){return e}:qe(e),d=f(i,o,r?2:1),m=0;if("function"!=typeof p)throw TypeError(e+" is not iterable!");if(De(p)){for(a=q(e.length);a>m;m++)if((l=r?d(h(u=e[m])[0],u[1]):d(e[m]))===t||l===n)return l}else for(c=p.call(e);!(u=c.next()).done;)if((l=Le(c,d,u.value,r))===t||l===n)return l};r.BREAK=t,r.RETURN=n})),We=fe("species"),Ge=function(e){var t="function"==typeof u[e]?u[e]:a[e];d&&t&&!t[We]&&_.f(t,We,{configurable:!0,get:function(){return this}})},$e=i((function(e){var t=Z("meta"),n=_.f,r=0,i=Object.isExtensible||function(){return!0},o=!p((function(){return i(Object.preventExtensions({}))})),s=function(e){n(e,t,{value:{i:"O"+ ++r,w:{}}})},a=e.exports={KEY:t,NEED:!1,fastKey:function(e,n){if(!l(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!I(e,t)){if(!i(e))return"F";if(!n)return"E";s(e)}return e[t].i},getWeak:function(e,n){if(!I(e,t)){if(!i(e))return!0;if(!n)return!1;s(e)}return e[t].w},onFreeze:function(e){return o&&a.NEED&&i(e)&&!I(e,t)&&s(e),e}}})),Je=($e.KEY,$e.NEED,$e.fastKey,$e.getWeak,$e.onFreeze,function(e,t){if(!l(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}),Ze=_.f,Ke=$e.fastKey,Xe=d?"_s":"size",He=function(e,t){var n,r=Ke(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n},Qe={getConstructor:function(e,t,n,r){var i=e((function(e,o){Ne(e,i,t,"_i"),e._t=t,e._i=ce(null),e._f=void 0,e._l=void 0,e[Xe]=0,null!=o&&ze(o,n,e[r],e)}));return Re(i.prototype,{clear:function(){for(var e=Je(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[Xe]=0},delete:function(e){var n=Je(this,t),r=He(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[Xe]--}return!!r},forEach:function(e){Je(this,t);for(var n,r=f(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!He(Je(this,t),e)}}),d&&Ze(i.prototype,"size",{get:function(){return Je(this,t)[Xe]}}),i},def:function(e,t,n){var r,i,o=He(e,t);return o?o.v=n:(e._l=o={i:i=Ke(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[Xe]++,"F"!==i&&(e._i[i]=o)),e},getEntry:He,setStrong:function(e,t,n){Se(e,t,(function(e,n){this._t=Je(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?Ae(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,Ae(1))}),n?"entries":"values",!n,!0),Ge(t)}},et=fe("species"),tt=function(e,t){return new(function(e){var t;return x(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!x(t.prototype)||(t=void 0),l(t)&&null===(t=t[et])&&(t=void 0)),void 0===t?Array:t}(e))(t)},nt=function(e,t){var n=1==e,r=2==e,i=3==e,o=4==e,s=6==e,a=5==e||s,u=t||tt;return function(t,c,l){for(var h,p,d=ge(t),m=U(d),v=f(c,l,3),g=q(m.length),y=0,b=n?u(t,g):r?u(t,0):void 0;g>y;y++)if((a||y in m)&&(p=v(h=m[y],y,d),e))if(n)b[y]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return y;case 2:b.push(h)}else if(o)return!1;return s?-1:i||o?o:b}},rt=_.f,it=nt(0),ot=function(e,t,n,r,i,o){var s=a[e],u=s,c=i?"set":"add",f=u&&u.prototype,h={};return d&&"function"==typeof u&&(o||f.forEach&&!p((function(){(new u).entries().next()})))?(u=t((function(t,n){Ne(t,u,e,"_c"),t._c=new s,null!=n&&ze(n,i,t[c],t)})),it("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in f)||o&&"clear"==e||T(u.prototype,e,(function(n,r){if(Ne(this,u,e),!t&&o&&!l(n))return"get"==e&&void 0;var i=this._c[e](0===n?0:n,r);return t?this:i}))})),o||rt(u.prototype,"size",{get:function(){return this._c.size}})):(u=r.getConstructor(t,e,i,c),Re(u.prototype,n),$e.NEED=!0),pe(u,e),h[e]=u,O(O.G+O.W+O.F,h),o||r.setStrong(u,e,i),u},st=(ot("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=Qe.getEntry(Je(this,"Map"),e);return t&&t.v},set:function(e,t){return Qe.def(Je(this,"Map"),0===e?0:e,t)}},Qe,!0),function(e){return function(){if(Ve(this)!=e)throw TypeError(e+"#toJSON isn't generic");return function(e,t){var n=[];return ze(e,!1,n.push,n,t),n}(this)}});O(O.P+O.R,"Map",{toJSON:st("Map")});var at=function(e){O(O.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})};at("Map");var ut=function(e){O(O.S,e,{from:function(e){var t,n,r,i,o=arguments[1];return c(this),(t=void 0!==o)&&c(o),null==e?new this:(n=[],t?(r=0,i=f(o,arguments[2],2),ze(e,!1,(function(e){n.push(i(e,r++))}))):ze(e,!1,n.push,n),new this(n))}})};ut("Map"),o(R);var ct=u.Map,ft={f:fe},lt=ft.f("iterator"),ht=_.f,pt=function(e){var t=u.Symbol||(u.Symbol={});"_"==e.charAt(0)||e in t||ht(t,e,{value:ft.f(e)})},dt={f:Object.getOwnPropertySymbols},mt={f:{}.propertyIsEnumerable},vt=te.concat("length","prototype"),gt={f:Object.getOwnPropertyNames||function(e){return ee(e,vt)}},yt=gt.f,bt={}.toString,wt="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],_t={f:function(e){return wt&&"[object Window]"==bt.call(e)?function(e){try{return yt(e)}catch(e){return wt.slice()}}(e):yt(V(e))}},Et=Object.getOwnPropertyDescriptor,Tt={f:d?Et:function(e,t){if(e=V(e),t=b(t,!0),y)try{return Et(e,t)}catch(e){}if(I(e,t))return E(!mt.f.call(e,t),e[t])}},St=$e.KEY,It=Tt.f,At=_.f,Ot=_t.f,Ct=a.Symbol,Mt=a.JSON,xt=Mt&&Mt.stringify,kt=fe("_hidden"),Pt=fe("toPrimitive"),Rt={}.propertyIsEnumerable,Nt=G("symbol-registry"),Lt=G("symbols"),jt=G("op-symbols"),Ft=Object.prototype,Dt="function"==typeof Ct,Bt=a.QObject,Ut=!Bt||!Bt.prototype||!Bt.prototype.findChild,Vt=d&&p((function(){return 7!=ce(At({},"a",{get:function(){return At(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=It(Ft,t);r&&delete Ft[t],At(e,t,n),r&&e!==Ft&&At(Ft,t,r)}:At,Yt=function(e){var t=Lt[e]=ce(Ct.prototype);return t._k=e,t},qt=Dt&&"symbol"==typeof Ct.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof Ct},zt=function(e,t,n){return e===Ft&&zt(jt,t,n),h(e),t=b(t,!0),h(n),I(Lt,t)?(n.enumerable?(I(e,kt)&&e[kt][t]&&(e[kt][t]=!1),n=ce(n,{enumerable:E(0,!1)})):(I(e,kt)||At(e,kt,E(1,{})),e[kt][t]=!0),Vt(e,t,n)):At(e,t,n)},Wt=function(e,t){h(e);for(var n,r=function(e){var t=ne(e),n=dt.f;if(n)for(var r,i=n(e),o=mt.f,s=0;i.length>s;)o.call(e,r=i[s++])&&t.push(r);return t}(t=V(t)),i=0,o=r.length;o>i;)zt(e,n=r[i++],t[n]);return e},Gt=function(e){var t=Rt.call(this,e=b(e,!0));return!(this===Ft&&I(Lt,e)&&!I(jt,e))&&(!(t||!I(this,e)||!I(Lt,e)||I(this,kt)&&this[kt][e])||t)},$t=function(e,t){if(e=V(e),t=b(t,!0),e!==Ft||!I(Lt,t)||I(jt,t)){var n=It(e,t);return!n||!I(Lt,t)||I(e,kt)&&e[kt][t]||(n.enumerable=!0),n}},Jt=function(e){for(var t,n=Ot(V(e)),r=[],i=0;n.length>i;)I(Lt,t=n[i++])||t==kt||t==St||r.push(t);return r},Zt=function(e){for(var t,n=e===Ft,r=Ot(n?jt:V(e)),i=[],o=0;r.length>o;)!I(Lt,t=r[o++])||n&&!I(Ft,t)||i.push(Lt[t]);return i};Dt||(D((Ct=function(){if(this instanceof Ct)throw TypeError("Symbol is not a constructor!");var e=Z(arguments.length>0?arguments[0]:void 0),t=function(n){this===Ft&&t.call(jt,n),I(this,kt)&&I(this[kt],e)&&(this[kt][e]=!1),Vt(this,e,E(1,n))};return d&&Ut&&Vt(Ft,e,{configurable:!0,set:t}),Yt(e)}).prototype,"toString",(function(){return this._k})),Tt.f=$t,_.f=zt,gt.f=_t.f=Jt,mt.f=Gt,dt.f=Zt,ft.f=function(e){return Yt(fe(e))}),O(O.G+O.W+O.F*!Dt,{Symbol:Ct});for(var Kt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Xt=0;Kt.length>Xt;)fe(Kt[Xt++]);for(var Ht=ne(fe.store),Qt=0;Ht.length>Qt;)pt(Ht[Qt++]);O(O.S+O.F*!Dt,"Symbol",{for:function(e){return I(Nt,e+="")?Nt[e]:Nt[e]=Ct(e)},keyFor:function(e){if(!qt(e))throw TypeError(e+" is not a symbol!");for(var t in Nt)if(Nt[t]===e)return t},useSetter:function(){Ut=!0},useSimple:function(){Ut=!1}}),O(O.S+O.F*!Dt,"Object",{create:function(e,t){return void 0===t?ce(e):Wt(ce(e),t)},defineProperty:zt,defineProperties:Wt,getOwnPropertyDescriptor:$t,getOwnPropertyNames:Jt,getOwnPropertySymbols:Zt}),Mt&&O(O.S+O.F*(!Dt||p((function(){var e=Ct();return"[null]"!=xt([e])||"{}"!=xt({a:e})||"{}"!=xt(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(l(t)||void 0!==e)&&!qt(e))return x(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!qt(t))return t}),r[1]=t,xt.apply(Mt,r)}}),Ct.prototype[Pt]||T(Ct.prototype,Pt,Ct.prototype.valueOf),pe(Ct,"Symbol"),pe(Math,"Math",!0),pe(a.JSON,"JSON",!0),pt("asyncIterator"),pt("observable");var en=u.Symbol,tn=i((function(e){function t(n){return e.exports=t="function"==typeof en&&"symbol"==typeof lt?function(e){return typeof e}:function(e){return e&&"function"==typeof en&&e.constructor===en&&e!==en.prototype?"symbol":typeof e},t(n)}e.exports=t})),nn=function(e,t){var n=(u.Object||{})[e]||Object[e],r={};r[e]=t(n),O(O.S+O.F*p((function(){n(1)})),"Object",r)};nn("getPrototypeOf",(function(){return function(e){return we(ge(e))}}));var rn=u.Object.getPrototypeOf,on=Tt.f;nn("getOwnPropertyDescriptor",(function(){return function(e,t){return on(V(e),t)}}));var sn=u.Object,an=function(e,t){return sn.getOwnPropertyDescriptor(e,t)};nn("keys",(function(){return function(e){return ne(ge(e))}}));var un=u.Object.keys;O(O.S,"Date",{now:function(){return(new Date).getTime()}});var cn=u.Date.now,fn=Object.assign,ln=!fn||p((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=fn({},e)[n]||Object.keys(fn({},t)).join("")!=r}))?function(e,t){for(var n=ge(e),r=arguments.length,i=1,o=dt.f,s=mt.f;r>i;)for(var a,u=U(arguments[i++]),c=o?ne(u).concat(o(u)):ne(u),f=c.length,l=0;f>l;)s.call(u,a=c[l++])&&(n[a]=u[a]);return n}:fn,hn=$e.getWeak,pn=nt(5),dn=nt(6),mn=0,vn=function(e){return e._l||(e._l=new gn)},gn=function(){this.a=[]},yn=function(e,t){return pn(e.a,(function(e){return e[0]===t}))};gn.prototype={get:function(e){var t=yn(this,e);if(t)return t[1]},has:function(e){return!!yn(this,e)},set:function(e,t){var n=yn(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=dn(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}};var bn={getConstructor:function(e,t,n,r){var i=e((function(e,o){Ne(e,i,t,"_i"),e._t=t,e._i=mn++,e._l=void 0,null!=o&&ze(o,n,e[r],e)}));return Re(i.prototype,{delete:function(e){if(!l(e))return!1;var n=hn(e);return!0===n?vn(Je(this,t)).delete(e):n&&I(n,this._i)&&delete n[this._i]},has:function(e){if(!l(e))return!1;var n=hn(e);return!0===n?vn(Je(this,t)).has(e):n&&I(n,this._i)}}),i},def:function(e,t,n){var r=hn(h(t),!0);return!0===r?vn(e).set(t,n):r[e._i]=n,e},ufstore:vn};i((function(e){var t,n=nt(0),r=Je,i=!a.ActiveXObject&&"ActiveXObject"in a,o=$e.getWeak,s=Object.isExtensible,u=bn.ufstore,c=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},f={get:function(e){if(l(e)){var t=o(e);return!0===t?u(Je(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return bn.def(Je(this,"WeakMap"),e,t)}},h=e.exports=ot("WeakMap",c,f,bn,!0,!0);r&&i&&(t=bn.getConstructor(c,"WeakMap"),ln(t.prototype,f),$e.NEED=!0,n(["delete","has","get","set"],(function(e){var n=h.prototype,r=n[e];D(n,e,(function(n,i){if(l(n)&&!s(n)){this._f||(this._f=new t);var o=this._f[e](n,i);return"set"==e?this:o}return r.call(this,n,i)}))})))}));at("WeakMap"),ut("WeakMap");var wn,_n,En,Tn=u.WeakMap,Sn=fe("species"),In=function(e,t){var n,r=h(e).constructor;return void 0===r||null==(n=h(r)[Sn])?t:c(n)},An=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)},On=a.process,Cn=a.setImmediate,Mn=a.clearImmediate,xn=a.MessageChannel,kn=a.Dispatch,Pn=0,Rn={},Nn=function(){var e=+this;if(Rn.hasOwnProperty(e)){var t=Rn[e];delete Rn[e],t()}},Ln=function(e){Nn.call(e.data)};Cn&&Mn||(Cn=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Rn[++Pn]=function(){An("function"==typeof e?e:function(){return{}},t)},wn(Pn),Pn},Mn=function(e){delete Rn[e]},"process"==M(On)?wn=function(e){On.nextTick(f(Nn,e,1))}:kn&&kn.now?wn=function(e){kn.now(f(Nn,e,1))}:xn?(En=(_n=new xn).port2,_n.port1.onmessage=Ln,wn=f(En.postMessage,En,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts?(wn=function(e){a.postMessage(e+"","*")},a.addEventListener("message",Ln,!1)):wn="onreadystatechange"in g("script")?function(e){oe.appendChild(g("script")).onreadystatechange=function(){oe.removeChild(this),Nn.call(e)}}:function(e){setTimeout(f(Nn,e,1),0)});var jn={set:Cn,clear:Mn},Fn=jn.set,Dn=a.MutationObserver||a.WebKitMutationObserver,Bn=a.process,Un=a.Promise,Vn="process"==M(Bn);function Yn(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=c(t),this.reject=c(n)}var qn={f:function(e){return new Yn(e)}},zn=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},Wn=a.navigator,Gn=Wn&&Wn.userAgent||"",$n=function(e,t){if(h(e),l(t)&&t.constructor===e)return t;var n=qn.f(e);return(0,n.resolve)(t),n.promise},Jn=fe("iterator"),Zn=!1;try{var Kn=[7][Jn]();Kn.return=function(){Zn=!0},Array.from(Kn,(function(){throw 2}))}catch(e){}var Xn,Hn,Qn,er,tr=function(e,t){if(!t&&!Zn)return!1;var n=!1;try{var r=[7],i=r[Jn]();i.next=function(){return{done:n=!0}},r[Jn]=function(){return i},e(r)}catch(e){}return n},nr=jn.set,rr=function(){var e,t,n,r=function(){var r,i;for(Vn&&(r=Bn.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(Vn)n=function(){Bn.nextTick(r)};else if(!Dn||a.navigator&&a.navigator.standalone)if(Un&&Un.resolve){var i=Un.resolve(void 0);n=function(){i.then(r)}}else n=function(){Fn.call(a,r)};else{var o=!0,s=document.createTextNode("");new Dn(r).observe(s,{characterData:!0}),n=function(){s.data=o=!o}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}(),ir=a.TypeError,or=a.process,sr=or&&or.versions,ar=sr&&sr.v8||"",ur=a.Promise,cr="process"==Ve(or),fr=function(){},lr=Hn=qn.f,hr=!!function(){try{var e=ur.resolve(1),t=(e.constructor={})[fe("species")]=function(e){e(fr,fr)};return(cr||"function"==typeof PromiseRejectionEvent)&&e.then(fr)instanceof t&&0!==ar.indexOf("6.6")&&-1===Gn.indexOf("Chrome/66")}catch(e){}}(),pr=function(e){var t;return!(!l(e)||"function"!=typeof(t=e.then))&&t},dr=function(e,t){if(!e._n){e._n=!0;var n=e._c;rr((function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s,a=i?t.ok:t.fail,u=t.resolve,c=t.reject,f=t.domain;try{a?(i||(2==e._h&&gr(e),e._h=1),!0===a?n=r:(f&&f.enter(),n=a(r),f&&(f.exit(),s=!0)),n===t.promise?c(ir("Promise-chain cycle")):(o=pr(n))?o.call(n,u,c):u(n)):c(r)}catch(e){f&&!s&&f.exit(),c(e)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&mr(e)}))}},mr=function(e){nr.call(a,(function(){var t,n,r,i=e._v,o=vr(e);if(o&&(t=zn((function(){cr?or.emit("unhandledRejection",i,e):(n=a.onunhandledrejection)?n({promise:e,reason:i}):(r=a.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=cr||vr(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},vr=function(e){return 1!==e._h&&0===(e._a||e._c).length},gr=function(e){nr.call(a,(function(){var t;cr?or.emit("rejectionHandled",e):(t=a.onrejectionhandled)&&t({promise:e,reason:e._v})}))},yr=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),dr(t,!0))},br=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw ir("Promise can't be resolved itself");(t=pr(e))?rr((function(){var r={_w:n,_d:!1};try{t.call(e,f(br,r,1),f(yr,r,1))}catch(e){yr.call(r,e)}})):(n._v=e,n._s=1,dr(n,!1))}catch(e){yr.call({_w:n,_d:!1},e)}}};hr||(ur=function(e){Ne(this,ur,"Promise","_h"),c(e),Xn.call(this);try{e(f(br,this,1),f(yr,this,1))}catch(e){yr.call(this,e)}},(Xn=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Re(ur.prototype,{then:function(e,t){var n=lr(In(this,ur));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=cr?or.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&dr(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),Qn=function(){var e=new Xn;this.promise=e,this.resolve=f(br,e,1),this.reject=f(yr,e,1)},qn.f=lr=function(e){return e===ur||e===er?new Qn(e):Hn(e)}),O(O.G+O.W+O.F*!hr,{Promise:ur}),pe(ur,"Promise"),Ge("Promise"),er=u.Promise,O(O.S+O.F*!hr,"Promise",{reject:function(e){var t=lr(this);return(0,t.reject)(e),t.promise}}),O(O.S+!0*O.F,"Promise",{resolve:function(e){return $n(this===er?ur:this,e)}}),O(O.S+O.F*!(hr&&tr((function(e){ur.all(e).catch(fr)}))),"Promise",{all:function(e){var t=this,n=lr(t),r=n.resolve,i=n.reject,o=zn((function(){var n=[],o=0,s=1;ze(e,!1,(function(e){var a=o++,u=!1;n.push(void 0),s++,t.resolve(e).then((function(e){u||(u=!0,n[a]=e,--s||r(n))}),i)})),--s||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=lr(t),r=n.reject,i=zn((function(){ze(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}}),O(O.P+O.R,"Promise",{finally:function(e){var t=In(this,u.Promise||a.Promise),n="function"==typeof e;return this.then(n?function(n){return $n(t,e()).then((function(){return n}))}:e,n?function(n){return $n(t,e()).then((function(){throw n}))}:e)}}),O(O.S,"Promise",{try:function(e){var t=qn.f(this),n=zn(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}});var wr=u.Promise,_r=u.Object.getOwnPropertySymbols;O(O.S+O.F,"Object",{assign:ln});var Er=u.Object.assign;O(O.S,"Object",{create:ce});var Tr=u.Object,Sr=function(e,t){return Tr.create(e,t)},Ir=function(e,t){if(h(e),!l(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},Ar={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=f(n.call,Tt.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return Ir(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:Ir};O(O.S,"Object",{setPrototypeOf:Ar.set});var Or=u.Object.setPrototypeOf;O(O.S+O.F*!d,"Object",{defineProperty:_.f});var Cr,Mr=u.Object,xr=function(e,t,n){return Mr.defineProperty(e,t,n)},kr=i((function(e,t){xr(t,"__esModule",{value:!0});
/*! *****************************************************************************
	  Copyright (c) Microsoft Corporation.
	  
	  Permission to use, copy, modify, and/or distribute this software for any
	  purpose with or without fee is hereby granted.
	  
	  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	  PERFORMANCE OF THIS SOFTWARE.
	  ***************************************************************************** */
var n=function(e,t){return(n=Or||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var r=function(){return(r=Er||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof _r){var i=0;for(r=_r(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function o(e,t,n,r){return new(n||(n=wr))((function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof en&&(o[lt]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var a={getItem:function(e){return wx.getStorageSync(e)},setItem:function(e,t){return wx.setStorageSync(e,t)},removeItem:function(e){return wx.removeStorageSync(e)},clear:function(){return wx.clearStorageSync()}},u=new Tn,c=new Tn;function f(e){var t=u.get(e);return console.assert(null!=t,"'this' is expected an Event object, but got",e),t}function l(e){null==e.passiveListener?e.event.cancelable&&(e.canceled=!0,"function"==typeof e.event.preventDefault&&e.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",e.passiveListener)}function h(e,t){u.set(this,{eventTarget:e,event:t,eventPhase:2,currentTarget:e,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:t.timeStamp||cn()}),xr(this,"isTrusted",{value:!1,enumerable:!0});for(var n=un(t),r=0;r<n.length;++r){var i=n[r];i in this||xr(this,i,p(i))}}function p(e){return{get:function(){return f(this).event[e]},set:function(t){f(this).event[e]=t},configurable:!0,enumerable:!0}}function d(e){return{value:function(){var t=f(this).event;return t[e].apply(t,arguments)},configurable:!0,enumerable:!0}}function m(e){if(null==e||e===Object.prototype)return h;var t=c.get(e);return null==t&&(t=function(e,t){var n=un(t);if(0===n.length)return e;function r(t,n){e.call(this,t,n)}r.prototype=Sr(e.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(var i=0;i<n.length;++i){var o=n[i];if(!(o in e.prototype)){var s="function"==typeof an(t,o).value;xr(r.prototype,o,s?d(o):p(o))}}return r}(m(rn(e)),e),c.set(e,t)),t}function v(e){return f(e).immediateStopped}function g(e,t){f(e).passiveListener=t}h.prototype={get type(){return f(this).event.type},get target(){return f(this).eventTarget},get currentTarget(){return f(this).currentTarget},composedPath:function(){var e=f(this).currentTarget;return null==e?[]:[e]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return f(this).eventPhase},stopPropagation:function(){var e=f(this);e.stopped=!0,"function"==typeof e.event.stopPropagation&&e.event.stopPropagation()},stopImmediatePropagation:function(){var e=f(this);e.stopped=!0,e.immediateStopped=!0,"function"==typeof e.event.stopImmediatePropagation&&e.event.stopImmediatePropagation()},get bubbles(){return Boolean(f(this).event.bubbles)},get cancelable(){return Boolean(f(this).event.cancelable)},preventDefault:function(){l(f(this))},get defaultPrevented(){return f(this).canceled},get composed(){return Boolean(f(this).event.composed)},get timeStamp(){return f(this).timeStamp},get srcElement(){return f(this).eventTarget},get cancelBubble(){return f(this).stopped},set cancelBubble(e){if(e){var t=f(this);t.stopped=!0,"boolean"==typeof t.event.cancelBubble&&(t.event.cancelBubble=!0)}},get returnValue(){return!f(this).canceled},set returnValue(e){e||l(f(this))},initEvent:function(){}},xr(h.prototype,"constructor",{value:h,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Or(h.prototype,window.Event.prototype),c.set(window.Event.prototype,h));var y=new Tn;function b(e){return null!==e&&"object"===tn(e)}function w(e){var t=y.get(e);if(null==t)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return t}function _(e,t){xr(e,"on".concat(t),function(e){return{get:function(){for(var t=w(this).get(e);null!=t;){if(3===t.listenerType)return t.listener;t=t.next}return null},set:function(t){"function"==typeof t||b(t)||(t=null);for(var n=w(this),r=null,i=n.get(e);null!=i;)3===i.listenerType?null!==r?r.next=i.next:null!==i.next?n.set(e,i.next):n.delete(e):r=i,i=i.next;if(null!==t){var o={listener:t,listenerType:3,passive:!1,once:!1,next:null};null===r?n.set(e,o):r.next=o}},configurable:!0,enumerable:!0}}(t))}function E(e){function t(){T.call(this)}t.prototype=Sr(T.prototype,{constructor:{value:t,configurable:!0,writable:!0}});for(var n=0;n<e.length;++n)_(t.prototype,e[n]);return t}function T(){if(!(this instanceof T)){if(1===arguments.length&&P(arguments[0]))return E(arguments[0]);if(arguments.length>0){for(var e=new Array(arguments.length),t=0;t<arguments.length;++t)e[t]=arguments[t];return E(e)}throw new TypeError("Cannot call a class as a function")}y.set(this,new ct)}T.prototype={addEventListener:function(e,t,n){if(null!=t){if("function"!=typeof t&&!b(t))throw new TypeError("'listener' should be a function or an object.");var r=w(this),i=b(n),o=(i?Boolean(n.capture):Boolean(n))?1:2,s={listener:t,listenerType:o,passive:i&&Boolean(n.passive),once:i&&Boolean(n.once),next:null},a=r.get(e);if(void 0!==a){for(var u=null;null!=a;){if(a.listener===t&&a.listenerType===o)return;u=a,a=a.next}u.next=s}else r.set(e,s)}},removeEventListener:function(e,t,n){if(null!=t)for(var r=w(this),i=(b(n)?Boolean(n.capture):Boolean(n))?1:2,o=null,s=r.get(e);null!=s;){if(s.listener===t&&s.listenerType===i)return void(null!==o?o.next=s.next:null!==s.next?r.set(e,s.next):r.delete(e));o=s,s=s.next}},dispatchEvent:function(e){if(null==e||"string"!=typeof e.type)throw new TypeError('"event.type" should be a string.');var t=w(this),n=e.type,r=t.get(n);if(null==r)return!0;for(var i=function(e,t){return new(m(rn(t)))(e,t)}(this,e),o=null;null!=r;){if(r.once?null!==o?o.next=r.next:null!==r.next?t.set(n,r.next):t.delete(n):o=r,g(i,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,i)}catch(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e)}else 3!==r.listenerType&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(i);if(v(i))break;r=r.next}return g(i,null),function(e,t){f(e).eventPhase=t}(i,0),function(e,t){f(e).currentTarget=t}(i,null),!i.defaultPrevented}},xr(T.prototype,"constructor",{value:T,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Or(T.prototype,window.EventTarget.prototype);var S=function(e){function t(n,r){var i=this;if(!n)throw new TypeError("Failed to construct 'WebSocket': url required");if(r&&(!wx.canIUse||!wx.canIUse("connectSocket.object.protocols")))throw new Error("subprotocol not supported in weapp");(i=e.call(this)||this)._url=n,i._protocol=r,i._readyState=t.CONNECTING;var o=function(e){i._readyState=t.CLOSED,i.dispatchEvent({type:"error",message:e.errMsg})},s=wx.connectSocket({url:n,protocols:void 0===i._protocol||P(i._protocol)?i._protocol:[i._protocol],fail:function(e){return setTimeout((function(){return o(e)}),0)}});return i._socketTask=s,s.onOpen((function(e){i._readyState=t.OPEN,i.dispatchEvent({type:"open"})})),s.onError(o),s.onMessage((function(e){var t=e.data;i.dispatchEvent({data:t,type:"message"})})),s.onClose((function(e){i._readyState=t.CLOSED;var n=e.code,r=e.reason;i.dispatchEvent({code:n,reason:r,type:"close"})})),i}return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Sr(t):(r.prototype=t.prototype,new r)}(t,e),xr(t.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),xr(t.prototype,"protocol",{get:function(){return this._protocol},enumerable:!0,configurable:!0}),xr(t.prototype,"readyState",{get:function(){return this._readyState},enumerable:!0,configurable:!0}),t.prototype.close=function(){this.readyState!==t.CLOSED&&(this.readyState===t.CONNECTING&&console.warn("close WebSocket which is connecting might not work"),this._socketTask.close({}))},t.prototype.send=function(e){if(this.readyState!==t.OPEN)throw new Error("INVALID_STATE_ERR");if(!("string"==typeof e||e instanceof ArrayBuffer))throw new TypeError("only String/ArrayBuffer supported");this._socketTask.send({data:e})},t.CONNECTING=0,t.OPEN=1,t.CLOSING=2,t.CLOSED=3,t}(T(["open","error","message","close"]));t.WebSocket=S,t.getAuthInfo=function(e){var t=void 0===e?{}:e,n=t.platform,r=void 0===n?"weixin":n,i=t.preferUnionId,a=void 0!==i&&i,u=t.asMainAccount,c=void 0!==u&&u;return o(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,new wr((function(e,t){wx.login({success:function(n){return n.code?e(n.code):t(new Error(n.errMsg))},fail:function(e){var n=e.errMsg;return t(new Error(n))}})}))];case 1:return e=n.sent(),t={code:e},a&&(t.platform=r,t.main_account=c),[2,{authData:t,platform:r,provider:"lc_weapp"}]}}))}))},t.platformInfo={name:"Weapp"},t.request=function(e,t){var n=void 0===t?{}:t,o=n.method,s=n.data,a=n.headers;return new wr((function(t,n){return wx.request({url:e,method:o,data:s,header:a,responseType:"text",success:function(e){var n=e.statusCode,o=e.data,s=i(e,["statusCode","data"]);t(r(r({},s),{data:"string"==typeof o?JSON.parse(o):o,status:n,ok:!(n>=400)}))},fail:function(e){n(new Error(e.errMsg))}})}))},t.storage=a,t.upload=function(e,t,n){var o=void 0===n?{}:n,s=o.headers,a=o.data,u=o.onprogress;return t&&t.data&&t.data.uri?new wr((function(n,o){var c,f=wx.uploadFile({url:e,header:s,filePath:t.data.uri,name:t.field,formData:a,success:function(e){var t=e.statusCode,o=e.data,s=i(e,["statusCode","data"]);n(r(r({},s),{data:"string"==typeof o?JSON.parse(o):o,status:t,ok:!(t>=400)}))},fail:function(e){o(new Error(e.errMsg))}});null===(c=null==f?void 0:f.onProgressUpdate)||void 0===c||c.call(f,(function(e){var t=e.progress,n=e.totalBytesSent,r=e.totalBytesExpectedToSend;return null==u?void 0:u({percent:t,loaded:n,total:r})}))})):wr.reject(new TypeError("File data must be an object like { uri: localPath }."))}}));(Cr=kr)&&Cr.__esModule&&Object.prototype.hasOwnProperty.call(Cr,"default")&&Cr.default;var Pr=kr.WebSocket,Rr=(kr.getAuthInfo,kr.platformInfo,kr.request);kr.storage,kr.upload;O(O.S+O.F*!d,"Object",{defineProperties:re});var Nr=u.Object,Lr=function(e,t){return Nr.defineProperties(e,t)},jr=a.Reflect,Fr=jr&&jr.ownKeys||function(e){var t=gt.f(h(e)),n=dt.f;return n?t.concat(n(e)):t},Dr=function(e,t,n){t in e?_.f(e,t,E(0,n)):e[t]=n};O(O.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=V(e),i=Tt.f,o=Fr(r),s={},a=0;o.length>a;)void 0!==(n=i(r,t=o[a++]))&&Dr(s,t,n);return s}});var Br=u.Object.getOwnPropertyDescriptors;var Ur=function(e,t,n){return t in e?xr(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Vr=i((function(e){
/**
	 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/long.js for details
	 */
!function(t,n){e&&e.exports?e.exports=n():(t.dcodeIO=t.dcodeIO||{}).Long=n()}(r,(function(){function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return!0===(e&&e.__isLong__)}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var n={},r={};function i(e,t){var i,o,a;return t?(a=0<=(e>>>=0)&&e<256)&&(o=r[e])?o:(i=s(e,(0|e)<0?-1:0,!0),a&&(r[e]=i),i):(a=-128<=(e|=0)&&e<128)&&(o=n[e])?o:(i=s(e,e<0?-1:0,!1),a&&(n[e]=i),i)}function o(e,t){if(isNaN(e)||!isFinite(e))return t?m:d;if(t){if(e<0)return m;if(e>=l)return w}else{if(e<=-h)return _;if(e+1>=h)return b}return e<0?o(-e,t).neg():s(e%f|0,e/f|0,t)}function s(t,n,r){return new e(t,n,r)}e.fromInt=i,e.fromNumber=o,e.fromBits=s;var a=Math.pow;function u(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return d;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(e.substring(1),t,n).neg();for(var i=o(a(n,8)),s=d,c=0;c<e.length;c+=8){var f=Math.min(8,e.length-c),l=parseInt(e.substring(c,c+f),n);if(f<8){var h=o(a(n,f));s=s.mul(h).add(o(l))}else s=(s=s.mul(i)).add(o(l))}return s.unsigned=t,s}function c(t){return t instanceof e?t:"number"==typeof t?o(t):"string"==typeof t?u(t):s(t.low,t.high,t.unsigned)}e.fromString=u,e.fromValue=c;var f=4294967296,l=f*f,h=l/2,p=i(1<<24),d=i(0);e.ZERO=d;var m=i(0,!0);e.UZERO=m;var v=i(1);e.ONE=v;var g=i(1,!0);e.UONE=g;var y=i(-1);e.NEG_ONE=y;var b=s(-1,2147483647,!1);e.MAX_VALUE=b;var w=s(-1,-1,!0);e.MAX_UNSIGNED_VALUE=w;var _=s(0,-2147483648,!1);e.MIN_VALUE=_;var E=e.prototype;return E.toInt=function(){return this.unsigned?this.low>>>0:this.low},E.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},E.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var t=o(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=o(a(e,6),this.unsigned),s=this,u="";;){var c=s.div(i),f=(s.sub(c.mul(i)).toInt()>>>0).toString(e);if((s=c).isZero())return f+u;for(;f.length<6;)f="0"+f;u=""+f+u}},E.getHighBits=function(){return this.high},E.getHighBitsUnsigned=function(){return this.high>>>0},E.getLowBits=function(){return this.low},E.getLowBitsUnsigned=function(){return this.low>>>0},E.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},E.isZero=function(){return 0===this.high&&0===this.low},E.isNegative=function(){return!this.unsigned&&this.high<0},E.isPositive=function(){return this.unsigned||this.high>=0},E.isOdd=function(){return 1==(1&this.low)},E.isEven=function(){return 0==(1&this.low)},E.equals=function(e){return t(e)||(e=c(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},E.eq=E.equals,E.notEquals=function(e){return!this.eq(e)},E.neq=E.notEquals,E.lessThan=function(e){return this.comp(e)<0},E.lt=E.lessThan,E.lessThanOrEqual=function(e){return this.comp(e)<=0},E.lte=E.lessThanOrEqual,E.greaterThan=function(e){return this.comp(e)>0},E.gt=E.greaterThan,E.greaterThanOrEqual=function(e){return this.comp(e)>=0},E.gte=E.greaterThanOrEqual,E.compare=function(e){if(t(e)||(e=c(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},E.comp=E.compare,E.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(v)},E.neg=E.negate,E.add=function(e){t(e)||(e=c(e));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=e.high>>>16,u=65535&e.high,f=e.low>>>16,l=0,h=0,p=0,d=0;return p+=(d+=o+(65535&e.low))>>>16,h+=(p+=i+f)>>>16,l+=(h+=r+u)>>>16,l+=n+a,s((p&=65535)<<16|(d&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},E.subtract=function(e){return t(e)||(e=c(e)),this.add(e.neg())},E.sub=E.subtract,E.multiply=function(e){if(this.isZero())return d;if(t(e)||(e=c(e)),e.isZero())return d;if(this.eq(_))return e.isOdd()?_:d;if(e.eq(_))return this.isOdd()?_:d;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(p)&&e.lt(p))return o(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,a=65535&this.low,u=e.high>>>16,f=65535&e.high,l=e.low>>>16,h=65535&e.low,m=0,v=0,g=0,y=0;return g+=(y+=a*h)>>>16,v+=(g+=i*h)>>>16,g&=65535,v+=(g+=a*l)>>>16,m+=(v+=r*h)>>>16,v&=65535,m+=(v+=i*l)>>>16,v&=65535,m+=(v+=a*f)>>>16,m+=n*h+r*l+i*f+a*u,s((g&=65535)<<16|(y&=65535),(m&=65535)<<16|(v&=65535),this.unsigned)},E.mul=E.multiply,E.divide=function(e){if(t(e)||(e=c(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?m:d;var n,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return g;i=m}else{if(this.eq(_))return e.eq(v)||e.eq(y)?_:e.eq(_)?v:(n=this.shr(1).div(e).shl(1)).eq(d)?e.isNegative()?v:y:(r=this.sub(e.mul(n)),i=n.add(r.div(e)));if(e.eq(_))return this.unsigned?m:d;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=d}for(r=this;r.gte(e);){n=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),u=s<=48?1:a(2,s-48),f=o(n),l=f.mul(e);l.isNegative()||l.gt(r);)l=(f=o(n-=u,this.unsigned)).mul(e);f.isZero()&&(f=v),i=i.add(f),r=r.sub(l)}return i},E.div=E.divide,E.modulo=function(e){return t(e)||(e=c(e)),this.sub(this.div(e).mul(e))},E.mod=E.modulo,E.not=function(){return s(~this.low,~this.high,this.unsigned)},E.and=function(e){return t(e)||(e=c(e)),s(this.low&e.low,this.high&e.high,this.unsigned)},E.or=function(e){return t(e)||(e=c(e)),s(this.low|e.low,this.high|e.high,this.unsigned)},E.xor=function(e){return t(e)||(e=c(e)),s(this.low^e.low,this.high^e.high,this.unsigned)},E.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):s(0,this.low<<e-32,this.unsigned)},E.shl=E.shiftLeft,E.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?s(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):s(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},E.shr=E.shiftRight,E.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),0===(e&=63))return this;var n=this.high;return e<32?s(this.low>>>e|n<<32-e,n>>>e,this.unsigned):s(32===e?n:n>>>e-32,0,this.unsigned)},E.shru=E.shiftRightUnsigned,E.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},E.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},E.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},E.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&e,e>>>8&255,e>>>16&255,e>>>24&255]},E.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t]},e}))})),Yr=i((function(e){
/**
	 * @license bytebuffer.js (c) 2015 Daniel Wirtz <dcode@dcode.io>
	 * Backing buffer: ArrayBuffer, Accessor: Uint8Array
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/bytebuffer.js for details
	 */
!function(t,n){e&&e.exports?e.exports=function(){var e;try{e=Vr}catch(e){}return n(e)}():(t.dcodeIO=t.dcodeIO||{}).ByteBuffer=n(t.dcodeIO.Long)}(r,(function(e){var t=function(e,n,i){if(void 0===e&&(e=t.DEFAULT_CAPACITY),void 0===n&&(n=t.DEFAULT_ENDIAN),void 0===i&&(i=t.DEFAULT_NOASSERT),!i){if((e|=0)<0)throw RangeError("Illegal capacity");n=!!n,i=!!i}this.buffer=0===e?r:new ArrayBuffer(e),this.view=0===e?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian=n,this.noAssert=i};t.VERSION="5.0.1",t.LITTLE_ENDIAN=!0,t.BIG_ENDIAN=!1,t.DEFAULT_CAPACITY=16,t.DEFAULT_ENDIAN=t.BIG_ENDIAN,t.DEFAULT_NOASSERT=!1,t.Long=e||null;var n=t.prototype;n.__isByteBuffer__,Object.defineProperty(n,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var r=new ArrayBuffer(0),i=String.fromCharCode;function o(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function s(){var e=[],t=[];return function(){if(0===arguments.length)return t.join("")+i.apply(String,e);e.length+arguments.length>1024&&(t.push(i.apply(String,e)),e.length=0),Array.prototype.push.apply(e,arguments)}}function a(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,f=-7,l=n?i-1:0,h=n?-1:1,p=e[t+l];for(l+=h,o=p&(1<<-f)-1,p>>=-f,f+=a;f>0;o=256*o+e[t+l],l+=h,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+e[t+l],l+=h,f-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)}function u(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,f=(1<<c)-1,l=f>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+l>=1?h/u:h*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*u-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+p]=255&s,p+=d,s/=256,c-=8);e[n+p-d]|=128*m}t.accessor=function(){return Uint8Array},t.allocate=function(e,n,r){return new t(e,n,r)},t.concat=function(e,n,r,i){"boolean"!=typeof n&&"string"==typeof n||(i=r,r=n,n=void 0);for(var o,s=0,a=0,u=e.length;a<u;++a)t.isByteBuffer(e[a])||(e[a]=t.wrap(e[a],n)),(o=e[a].limit-e[a].offset)>0&&(s+=o);if(0===s)return new t(0,r,i);var c,f=new t(s,r,i);for(a=0;a<u;)(o=(c=e[a++]).limit-c.offset)<=0||(f.view.set(c.view.subarray(c.offset,c.limit),f.offset),f.offset+=o);return f.limit=f.offset,f.offset=0,f},t.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},t.type=function(){return ArrayBuffer},t.wrap=function(e,r,i,o){if("string"!=typeof r&&(o=i,i=r,r=void 0),"string"==typeof e)switch(void 0===r&&(r="utf8"),r){case"base64":return t.fromBase64(e,i);case"hex":return t.fromHex(e,i);case"binary":return t.fromBinary(e,i);case"utf8":return t.fromUTF8(e,i);case"debug":return t.fromDebug(e,i);default:throw Error("Unsupported encoding: "+r)}if(null===e||"object"!=typeof e)throw TypeError("Illegal buffer");var s;if(t.isByteBuffer(e))return(s=n.clone.call(e)).markedOffset=-1,s;if(e instanceof Uint8Array)s=new t(0,i,o),e.length>0&&(s.buffer=e.buffer,s.offset=e.byteOffset,s.limit=e.byteOffset+e.byteLength,s.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)s=new t(0,i,o),e.byteLength>0&&(s.buffer=e,s.offset=0,s.limit=e.byteLength,s.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");(s=new t(e.length,i,o)).limit=e.length;for(var a=0;a<e.length;++a)s.view[a]=e[a]}return s},n.writeBitSet=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=t,o=e.length,s=o>>3,a=0;for(t+=this.writeVarint32(o,t);s--;)r=1&!!e[a++]|(1&!!e[a++])<<1|(1&!!e[a++])<<2|(1&!!e[a++])<<3|(1&!!e[a++])<<4|(1&!!e[a++])<<5|(1&!!e[a++])<<6|(1&!!e[a++])<<7,this.writeByte(r,t++);if(a<o){var u=0;for(r=0;a<o;)r|=(1&!!e[a++])<<u++;this.writeByte(r,t++)}return n?(this.offset=t,this):t-i},n.readBitSet=function(e){var t=void 0===e;t&&(e=this.offset);var n,r=this.readVarint32(e),i=r.value,o=i>>3,s=0,a=[];for(e+=r.length;o--;)n=this.readByte(e++),a[s++]=!!(1&n),a[s++]=!!(2&n),a[s++]=!!(4&n),a[s++]=!!(8&n),a[s++]=!!(16&n),a[s++]=!!(32&n),a[s++]=!!(64&n),a[s++]=!!(128&n);if(s<i){var u=0;for(n=this.readByte(e++);s<i;)a[s++]=!!(n>>u++&1)}return t&&(this.offset=e),a},n.readBytes=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}var r=this.slice(t,t+e);return n&&(this.offset+=e),r},n.writeBytes=n.append,n.writeInt8=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view[t]=e,n&&(this.offset+=1),this},n.writeByte=n.writeInt8,n.readInt8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view[e];return 128==(128&n)&&(n=-(255-n+1)),t&&(this.offset+=1),n},n.readByte=n.readInt8,n.writeUint8=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view[t]=e,n&&(this.offset+=1),this},n.writeUInt8=n.writeUint8,n.readUint8=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view[e];return t&&(this.offset+=1),n},n.readUInt8=n.readUint8,n.writeInt16=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},n.writeShort=n.writeInt16,n.readInt16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),32768==(32768&n)&&(n=-(65535-n+1)),t&&(this.offset+=2),n},n.readShort=n.readInt16,n.writeUint16=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},n.writeUInt16=n.writeUint16,n.readUint16=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),t&&(this.offset+=2),n},n.readUInt16=n.readUint16,n.writeInt32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},n.writeInt=n.writeInt32,n.readInt32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),n|=0,t&&(this.offset+=4),n},n.readInt=n.readInt32,n.writeUint32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},n.writeUInt32=n.writeUint32,n.readUint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),t&&(this.offset+=4),n},n.readUInt32=n.readUint32,e&&(n.writeInt64=function(t,n){var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),n+=8;var i=this.buffer.byteLength;n>i&&this.resize((i*=2)>n?i:n),n-=8;var o=t.low,s=t.high;return this.littleEndian?(this.view[n+3]=o>>>24&255,this.view[n+2]=o>>>16&255,this.view[n+1]=o>>>8&255,this.view[n]=255&o,n+=4,this.view[n+3]=s>>>24&255,this.view[n+2]=s>>>16&255,this.view[n+1]=s>>>8&255,this.view[n]=255&s):(this.view[n]=s>>>24&255,this.view[n+1]=s>>>16&255,this.view[n+2]=s>>>8&255,this.view[n+3]=255&s,n+=4,this.view[n]=o>>>24&255,this.view[n+1]=o>>>16&255,this.view[n+2]=o>>>8&255,this.view[n+3]=255&o),r&&(this.offset+=8),this},n.writeLong=n.writeInt64,n.readInt64=function(t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=0,i=0;this.littleEndian?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0,t+=4,i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0,t+=4,r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var o=new e(r,i,!1);return n&&(this.offset+=8),o},n.readLong=n.readInt64,n.writeUint64=function(t,n){var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),n+=8;var i=this.buffer.byteLength;n>i&&this.resize((i*=2)>n?i:n),n-=8;var o=t.low,s=t.high;return this.littleEndian?(this.view[n+3]=o>>>24&255,this.view[n+2]=o>>>16&255,this.view[n+1]=o>>>8&255,this.view[n]=255&o,n+=4,this.view[n+3]=s>>>24&255,this.view[n+2]=s>>>16&255,this.view[n+1]=s>>>8&255,this.view[n]=255&s):(this.view[n]=s>>>24&255,this.view[n+1]=s>>>16&255,this.view[n+2]=s>>>8&255,this.view[n+3]=255&s,n+=4,this.view[n]=o>>>24&255,this.view[n+1]=o>>>16&255,this.view[n+2]=o>>>8&255,this.view[n+3]=255&o),r&&(this.offset+=8),this},n.writeUInt64=n.writeUint64,n.readUint64=function(t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=0,i=0;this.littleEndian?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0,t+=4,i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0,t+=4,r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var o=new e(r,i,!0);return n&&(this.offset+=8),o},n.readUInt64=n.readUint64),n.writeFloat32=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,u(this.view,e,t,this.littleEndian,23,4),n&&(this.offset+=4),this},n.writeFloat=n.writeFloat32,n.readFloat32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=a(this.view,e,this.littleEndian,23,4);return t&&(this.offset+=4),n},n.readFloat=n.readFloat32,n.writeFloat64=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=8,u(this.view,e,t,this.littleEndian,52,8),n&&(this.offset+=8),this},n.writeDouble=n.writeFloat64,n.readFloat64=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=a(this.view,e,this.littleEndian,52,8);return t&&(this.offset+=8),n},n.readDouble=n.readFloat64,t.MAX_VARINT32_BYTES=5,t.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:e<1<<21?3:e<1<<28?4:5},t.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},t.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},n.writeVarint32=function(e,n){var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=t.calculateVarint32(e);n+=o;var s=this.buffer.byteLength;for(n>s&&this.resize((s*=2)>n?s:n),n-=o,e>>>=0;e>=128;)i=127&e|128,this.view[n++]=i,e>>>=7;return this.view[n++]=e,r?(this.offset=n,this):o},n.writeVarint32ZigZag=function(e,n){return this.writeVarint32(t.zigZagEncode32(e),n)},n.readVarint32=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=0,i=0;do{if(!this.noAssert&&e>this.limit){var o=Error("Truncated");throw o.truncated=!0,o}n=this.view[e++],r<5&&(i|=(127&n)<<7*r),++r}while(0!=(128&n));return i|=0,t?(this.offset=e,i):{value:i,length:r}},n.readVarint32ZigZag=function(e){var n=this.readVarint32(e);return"object"==typeof n?n.value=t.zigZagDecode32(n.value):n=t.zigZagDecode32(n),n},e&&(t.MAX_VARINT64_BYTES=10,t.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:i<128?9:10},t.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},t.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},n.writeVarint64=function(n,r){var i=void 0===r;if(i&&(r=this.offset),!this.noAssert){if("number"==typeof n)n=e.fromNumber(n);else if("string"==typeof n)n=e.fromString(n);else if(!(n&&n instanceof e))throw TypeError("Illegal value: "+n+" (not an integer or Long)");if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}"number"==typeof n?n=e.fromNumber(n,!1):"string"==typeof n?n=e.fromString(n,!1):!1!==n.unsigned&&(n=n.toSigned());var o=t.calculateVarint64(n),s=n.toInt()>>>0,a=n.shiftRightUnsigned(28).toInt()>>>0,u=n.shiftRightUnsigned(56).toInt()>>>0;r+=o;var c=this.buffer.byteLength;switch(r>c&&this.resize((c*=2)>r?c:r),r-=o,o){case 10:this.view[r+9]=u>>>7&1;case 9:this.view[r+8]=9!==o?128|u:127&u;case 8:this.view[r+7]=8!==o?a>>>21|128:a>>>21&127;case 7:this.view[r+6]=7!==o?a>>>14|128:a>>>14&127;case 6:this.view[r+5]=6!==o?a>>>7|128:a>>>7&127;case 5:this.view[r+4]=5!==o?128|a:127&a;case 4:this.view[r+3]=4!==o?s>>>21|128:s>>>21&127;case 3:this.view[r+2]=3!==o?s>>>14|128:s>>>14&127;case 2:this.view[r+1]=2!==o?s>>>7|128:s>>>7&127;case 1:this.view[r]=1!==o?128|s:127&s}return i?(this.offset+=o,this):o},n.writeVarint64ZigZag=function(e,n){return this.writeVarint64(t.zigZagEncode64(e),n)},n.readVarint64=function(t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var r=t,i=0,o=0,s=0,a=0;if(i=127&(a=this.view[t++]),128&a&&(i|=(127&(a=this.view[t++]))<<7,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[t++]))<<14,(128&a||this.noAssert&&void 0===a)&&(i|=(127&(a=this.view[t++]))<<21,(128&a||this.noAssert&&void 0===a)&&(o=127&(a=this.view[t++]),(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.view[t++]))<<7,(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.view[t++]))<<14,(128&a||this.noAssert&&void 0===a)&&(o|=(127&(a=this.view[t++]))<<21,(128&a||this.noAssert&&void 0===a)&&(s=127&(a=this.view[t++]),(128&a||this.noAssert&&void 0===a)&&(s|=(127&(a=this.view[t++]))<<7,128&a||this.noAssert&&void 0===a))))))))))throw Error("Buffer overrun");var u=e.fromBits(i|o<<28,o>>>4|s<<24,!1);return n?(this.offset=t,u):{value:u,length:t-r}},n.readVarint64ZigZag=function(n){var r=this.readVarint64(n);return r&&r.value instanceof e?r.value=t.zigZagDecode64(r.value):r=t.zigZagDecode64(r),r}),n.writeCString=function(e,t){var n=void 0===t;n&&(t=this.offset);var r,i=e.length;if(!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;r<i;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}i=f.calculateUTF16asUTF8(o(e))[1],t+=i+1;var s=this.buffer.byteLength;return t>s&&this.resize((s*=2)>t?s:t),t-=i+1,f.encodeUTF16toUTF8(o(e),function(e){this.view[t++]=e}.bind(this)),this.view[t++]=0,n?(this.offset=t,this):i},n.readCString=function(e){var t=void 0===e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=e,i=-1;return f.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view[e++])?null:i}.bind(this),n=s(),!0),t?(this.offset=e,n()):{string:n(),length:e-r}},n.writeIString=function(e,t){var n=void 0===t;if(n&&(t=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=t;r=f.calculateUTF16asUTF8(o(e),this.noAssert)[1],t+=4+r;var s=this.buffer.byteLength;if(t>s&&this.resize((s*=2)>t?s:t),t-=4+r,this.littleEndian?(this.view[t+3]=r>>>24&255,this.view[t+2]=r>>>16&255,this.view[t+1]=r>>>8&255,this.view[t]=255&r):(this.view[t]=r>>>24&255,this.view[t+1]=r>>>16&255,this.view[t+2]=r>>>8&255,this.view[t+3]=255&r),t+=4,f.encodeUTF16toUTF8(o(e),function(e){this.view[t++]=e}.bind(this)),t!==i+4+r)throw RangeError("Illegal range: Truncated data, "+t+" == "+(t+4+r));return n?(this.offset=t,this):t-i},n.readIString=function(e){var n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var r=e,i=this.readUint32(e),o=this.readUTF8String(i,t.METRICS_BYTES,e+=4);return e+=o.length,n?(this.offset=e,o.string):{string:o.string,length:e-r}},t.METRICS_CHARS="c",t.METRICS_BYTES="b",n.writeUTF8String=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var i=t;n=f.calculateUTF16asUTF8(o(e))[1],t+=n;var s=this.buffer.byteLength;return t>s&&this.resize((s*=2)>t?s:t),t-=n,f.encodeUTF16toUTF8(o(e),function(e){this.view[t++]=e}.bind(this)),r?(this.offset=t,this):t-i},n.writeString=n.writeUTF8String,t.calculateUTF8Chars=function(e){return f.calculateUTF16asUTF8(o(e))[0]},t.calculateUTF8Bytes=function(e){return f.calculateUTF16asUTF8(o(e))[1]},t.calculateString=t.calculateUTF8Bytes,n.readUTF8String=function(e,n,r){"number"==typeof n&&(r=n,n=void 0);var i=void 0===r;if(i&&(r=this.offset),void 0===n&&(n=t.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}var o,a=0,u=r;if(n===t.METRICS_CHARS){if(o=s(),f.decodeUTF8(function(){return a<e&&r<this.limit?this.view[r++]:null}.bind(this),(function(e){++a,f.UTF8toUTF16(e,o)})),a!==e)throw RangeError("Illegal range: Truncated data, "+a+" == "+e);return i?(this.offset=r,o()):{string:o(),length:r-u}}if(n===t.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}var c=r+e;if(f.decodeUTF8toUTF16(function(){return r<c?this.view[r++]:null}.bind(this),o=s(),this.noAssert),r!==c)throw RangeError("Illegal range: Truncated data, "+r+" == "+c);return i?(this.offset=r,o()):{string:o(),length:r-u}}throw TypeError("Unsupported metrics: "+n)},n.readString=n.readUTF8String,n.writeVString=function(e,n){var r=void 0===n;if(r&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,s,a=n;i=f.calculateUTF16asUTF8(o(e),this.noAssert)[1],s=t.calculateVarint32(i),n+=s+i;var u=this.buffer.byteLength;if(n>u&&this.resize((u*=2)>n?u:n),n-=s+i,n+=this.writeVarint32(i,n),f.encodeUTF16toUTF8(o(e),function(e){this.view[n++]=e}.bind(this)),n!==a+i+s)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+i+s));return r?(this.offset=n,this):n-a},n.readVString=function(e){var n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r=e,i=this.readVarint32(e),o=this.readUTF8String(i.value,t.METRICS_BYTES,e+=i.length);return e+=o.length,n?(this.offset=e,o.string):{string:o.string,length:e-r}},n.append=function(e,n,r){"number"!=typeof n&&"string"==typeof n||(r=n,n=void 0);var i=void 0===r;if(i&&(r=this.offset),!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}e instanceof t||(e=t.wrap(e,n));var o=e.limit-e.offset;if(o<=0)return this;r+=o;var s=this.buffer.byteLength;return r>s&&this.resize((s*=2)>r?s:r),r-=o,this.view.set(e.view.subarray(e.offset,e.limit),r),e.offset+=o,i&&(this.offset+=o),this},n.appendTo=function(e,t){return e.append(this,t),this},n.assert=function(e){return this.noAssert=!e,this},n.capacity=function(){return this.buffer.byteLength},n.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},n.clone=function(e){var n=new t(0,this.littleEndian,this.noAssert);return e?(n.buffer=new ArrayBuffer(this.buffer.byteLength),n.view=new Uint8Array(n.buffer)):(n.buffer=this.buffer,n.view=this.view),n.offset=this.offset,n.markedOffset=this.markedOffset,n.limit=this.limit,n},n.compact=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var n=t-e;if(0===n)return this.buffer=r,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var i=new ArrayBuffer(n),o=new Uint8Array(i);return o.set(this.view.subarray(e,t)),this.buffer=i,this.view=o,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this},n.copy=function(e,n){if(void 0===e&&(e=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,e<0||e>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+n+" <= "+this.buffer.byteLength)}if(e===n)return new t(0,this.littleEndian,this.noAssert);var r=n-e,i=new t(r,this.littleEndian,this.noAssert);return i.offset=0,i.limit=r,i.markedOffset>=0&&(i.markedOffset-=e),this.copyTo(i,0,e,n),i},n.copyTo=function(e,n,r,i){var o,s;if(!this.noAssert&&!t.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(n=(s=void 0===n)?e.offset:0|n,r=(o=void 0===r)?this.offset:0|r,i=void 0===i?this.limit:0|i,n<0||n>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+n+" <= "+e.buffer.byteLength);if(r<0||i>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+r+" <= "+this.buffer.byteLength);var a=i-r;return 0===a?e:(e.ensureCapacity(n+a),e.view.set(this.view.subarray(r,i),n),o&&(this.offset+=a),s&&(e.offset+=a),this)},n.ensureCapacity=function(e){var t=this.buffer.byteLength;return t<e?this.resize((t*=2)>e?t:e):this},n.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;t<n;)this.view[t++]=e;return r&&(this.offset=t),this},n.flip=function(){return this.limit=this.offset,this.offset=0,this},n.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},n.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},n.LE=function(e){return this.littleEndian=void 0===e||!!e,this},n.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},n.prepend=function(e,n,r){"number"!=typeof n&&"string"==typeof n||(r=n,n=void 0);var i=void 0===r;if(i&&(r=this.offset),!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}e instanceof t||(e=t.wrap(e,n));var o=e.limit-e.offset;if(o<=0)return this;var s=o-r;if(s>0){var a=new ArrayBuffer(this.buffer.byteLength+s),u=new Uint8Array(a);u.set(this.view.subarray(r,this.buffer.byteLength),o),this.buffer=a,this.view=u,this.offset+=s,this.markedOffset>=0&&(this.markedOffset+=s),this.limit+=s,r+=s}else new Uint8Array(this.buffer);return this.view.set(e.view.subarray(e.offset,e.limit),r-o),e.offset=e.limit,i&&(this.offset-=o),this},n.prependTo=function(e,t){return e.prepend(this,t),this},n.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},n.remaining=function(){return this.limit-this.offset},n.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},n.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}if(this.buffer.byteLength<e){var t=new ArrayBuffer(e),n=new Uint8Array(t);n.set(this.view),this.buffer=t,this.view=n}return this},n.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},n.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},n.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},n.toBuffer=function(e){var t=this.offset,n=this.limit;if(!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(!e&&0===t&&n===this.buffer.byteLength)return this.buffer;if(t===n)return r;var i=new ArrayBuffer(n-t);return new Uint8Array(i).set(new Uint8Array(this.buffer).subarray(t,n),0),i},n.toArrayBuffer=n.toBuffer,n.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}};var c=function(){for(var e={},t=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],n=[],r=0,i=t.length;r<i;++r)n[t[r]]=r;return e.encode=function(e,n){for(var r,i;null!==(r=e());)n(t[r>>2&63]),i=(3&r)<<4,null!==(r=e())?(n(t[63&((i|=r>>4&15)|r>>4&15)]),i=(15&r)<<2,null!==(r=e())?(n(t[63&(i|r>>6&3)]),n(t[63&r])):(n(t[63&i]),n(61))):(n(t[63&i]),n(61),n(61))},e.decode=function(e,t){var r,i,o;function s(e){throw Error("Illegal character code: "+e)}for(;null!==(r=e());)if(void 0===(i=n[r])&&s(r),null!==(r=e())&&(void 0===(o=n[r])&&s(r),t(i<<2>>>0|(48&o)>>4),null!==(r=e()))){if(void 0===(i=n[r])){if(61===r)break;s(r)}if(t((15&o)<<4>>>0|(60&i)>>2),null!==(r=e())){if(void 0===(o=n[r])){if(61===r)break;s(r)}t((3&i)<<6>>>0|o)}}},e.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)},e}();n.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||e>t)throw RangeError("begin, end");var n;return c.encode(function(){return e<t?this.view[e++]:null}.bind(this),n=s()),n()},t.fromBase64=function(e,n){if("string"!=typeof e)throw TypeError("str");var r=new t(e.length/4*3,n),i=0;return c.decode(o(e),(function(e){r.view[i++]=e})),r.limit=i,r},t.btoa=function(e){return t.fromBinary(e).toBase64()},t.atob=function(e){return t.fromBase64(e).toBinary()},n.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];e<t;)n.push(this.view[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},t.fromBinary=function(e,n){if("string"!=typeof e)throw TypeError("str");for(var r,i=0,o=e.length,s=new t(o,n);i<o;){if((r=e.charCodeAt(i))>255)throw RangeError("illegal char code: "+r);s.view[i++]=r}return s.limit=o,s},n.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",s="";n<r;){if(-1!==n&&(i+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=t>32&&t<127?String.fromCharCode(t):".")),++n,e&&n>0&&n%16==0&&n!==r){for(;i.length<51;)i+=" ";s+=i+o+"\n",i=o=""}n===this.offset&&n===this.limit?i+=n===this.markedOffset?"!":"|":n===this.offset?i+=n===this.markedOffset?"[":"<":n===this.limit?i+=n===this.markedOffset?"]":">":i+=n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";s+=i+o+"\n"}return e?s:i},t.fromDebug=function(e,n,r){for(var i,o,s=e.length,a=new t((s+1)/3|0,n,r),u=0,c=0,f=!1,l=!1,h=!1,p=!1,d=!1;u<s;){switch(i=e.charAt(u++)){case"!":if(!r){if(l||h||p){d=!0;break}l=h=p=!0}a.offset=a.markedOffset=a.limit=c,f=!1;break;case"|":if(!r){if(l||p){d=!0;break}l=p=!0}a.offset=a.limit=c,f=!1;break;case"[":if(!r){if(l||h){d=!0;break}l=h=!0}a.offset=a.markedOffset=c,f=!1;break;case"<":if(!r){if(l){d=!0;break}l=!0}a.offset=c,f=!1;break;case"]":if(!r){if(p||h){d=!0;break}p=h=!0}a.limit=a.markedOffset=c,f=!1;break;case">":if(!r){if(p){d=!0;break}p=!0}a.limit=c,f=!1;break;case"'":if(!r){if(h){d=!0;break}h=!0}a.markedOffset=c,f=!1;break;case" ":f=!1;break;default:if(!r&&f){d=!0;break}if(o=parseInt(i+e.charAt(u++),16),!r&&(isNaN(o)||o<0||o>255))throw TypeError("Illegal str: Not a debug encoded string");a.view[c++]=o,f=!0}if(d)throw TypeError("Illegal str: Invalid symbol at "+u)}if(!r){if(!l||!p)throw TypeError("Illegal str: Missing offset or limit");if(c<a.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+c+" < "+s)}return a},n.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);e<t;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},t.fromHex=function(e,n,r){if(!r){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var i,o=e.length,s=new t(o/2|0,n),a=0,u=0;a<o;a+=2){if(i=parseInt(e.substring(a,a+2),16),!r&&(!isFinite(i)||i<0||i>255))throw TypeError("Illegal str: Contains non-hex characters");s.view[u++]=i}return s.limit=u,s};var f=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(n>>6&31|192),t(63&n|128)):n<65536?(t(n>>12&15|224),t(n>>6&63|128),t(63&n|128)):(t(n>>18&7|240),t(n>>12&63|128),t(n>>6&63|128),t(63&n|128)),n=null},decodeUTF8:function(e,t){for(var n,r,i,o,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&s([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))(null===(r=e())||null===(i=e()))&&s([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(o=e()))&&s([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(t,n){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,n)}))},decodeUTF8toUTF16:function(t,n){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,n)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(t){var n=0,r=0;return e.UTF16toUTF8(t,(function(e){++n,r+=e<128?1:e<2048?2:e<65536?3:4})),[n,r]}};return e}();return n.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n;try{f.decodeUTF8toUTF16(function(){return e<t?this.view[e++]:null}.bind(this),n=s())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return n()},t.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var i=new t(f.calculateUTF16asUTF8(o(e),!0)[1],n,r),s=0;return f.encodeUTF16toUTF8(o(e),(function(e){i.view[s++]=e})),i.limit=s,i},t}))})),qr=o(Object.freeze({__proto__:null,default:{}})),zr=i((function(e){
/**
	 * @license protobuf.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/protobuf.js for details
	 */
!function(t,n){e&&e.exports?e.exports=n(Yr,!0):(t.dcodeIO=t.dcodeIO||{}).ProtoBuf=n(t.dcodeIO.ByteBuffer)}(r,(function(e,n){var r,i={};return i.ByteBuffer=e,i.Long=e.Long||null,i.VERSION="5.0.3",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},float:{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=((r={}).IS_NODE=!("object"!=typeof t||t+""!="[object process]"||t.browser),r.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,n=0;n<e.length;n++){try{t=e[n]()}catch(e){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},r.fetch=function(e,t){if(t&&"function"!=typeof t&&(t=null),r.IS_NODE){var n=qr;if(t)n.readFile(e,(function(e,n){t(e?null:""+n)}));else try{return n.readFileSync(e)}catch(e){return null}}else{var i=r.XHR();if(i.open("GET",e,!!t),i.setRequestHeader("Accept","text/plain"),"function"==typeof i.overrideMimeType&&i.overrideMimeType("text/plain"),!t)return i.send(null),200==i.status||0==i.status&&"string"==typeof i.responseText?i.responseText:null;if(i.onreadystatechange=function(){4==i.readyState&&(200==i.status||0==i.status&&"string"==typeof i.responseText?t(i.responseText):t(null))},4==i.readyState)return;i.send(null)}},r.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},r),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,FQTYPEREF:/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.Reflect=function(t){var n={},r=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className},i=r.prototype;i.fqn=function(){for(var e=this.name,t=this;;){if(null==(t=t.parent))break;e=t.name+"."+e}return e},i.toString=function(e){return(e?this.className+" ":"")+this.fqn()},i.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},n.T=r;var o=function(e,t,n,i,o){r.call(this,e,t,n),this.className="Namespace",this.children=[],this.options=i||{},this.syntax=o||"proto2"},s=o.prototype=Object.create(r.prototype);s.getChildren=function(e){if(null==(e=e||null))return this.children.slice();for(var t=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},s.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof f.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof f.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},s.getChild=function(e){for(var t="number"==typeof e?"id":"name",n=0,r=this.children.length;n<r;++n)if(this.children[n][t]===e)return this.children[n];return null},s.resolve=function(e,t){var r,i="string"==typeof e?e.split("."):e,o=this,s=0;if(""===i[s]){for(;null!==o.parent;)o=o.parent;s++}do{do{if(!(o instanceof n.Namespace)){o=null;break}if(!(r=o.getChild(i[s]))||!(r instanceof n.T)||t&&!(r instanceof n.Namespace)){o=null;break}o=r,s++}while(s<i.length);if(null!=o)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=o);return o},s.qn=function(e){var t=[],r=e;do{t.unshift(r.name),r=r.parent}while(null!==r);for(var i=1;i<=t.length;i++){var o=t.slice(t.length-i);if(e===this.resolve(o,e instanceof n.Namespace))return o.join(".")}return e.fqn()},s.build=function(){for(var e,t={},n=this.children,r=0,i=n.length;r<i;++r)(e=n[r])instanceof o&&(t[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},s.buildOpt=function(){for(var e={},t=Object.keys(this.options),n=0,r=t.length;n<r;++n){var i=t[n],o=this.options[t[n]];e[i]=o}return e},s.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},n.Namespace=o;var a=function(e,n,r,i,o){if(this.type=e,this.resolvedType=n,this.isMapKey=r,this.syntax=i,this.name=o,r&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},u=a.prototype;function c(e,n){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low==e.low&&e.high==e.high)return new t.Long(e.low,e.high,void 0===n?e.unsigned:n);if("string"==typeof e)return t.Long.fromString(e,n||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,n||!1);throw Error("not convertible to Long")}a.defaultFieldValue=function(n){if("string"==typeof n&&(n=t.TYPES[n]),void 0===n.defaultValue)throw Error("default value for type "+n.name+" is not supported");return n==t.TYPES.bytes?new e(0):n.defaultValue},u.toString=function(){return(this.name||"")+(this.isMapKey?"map":"value")+" element"},u.verifyValue=function(n){var r=this;function i(e,t){throw Error("Illegal value for "+r.toString(!0)+" of type "+r.type.name+": "+e+" ("+t+")")}switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof n||n==n&&n%1!=0)&&i(typeof n,"not an integer"),n>4294967295?0|n:n;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof n||n==n&&n%1!=0)&&i(typeof n,"not an integer"),n<0?n>>>0:n;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return c(n,!1)}catch(e){i(typeof n,e.message)}else i(typeof n,"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return c(n,!0)}catch(e){i(typeof n,e.message)}else i(typeof n,"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof n&&i(typeof n,"not a boolean"),n;case t.TYPES.float:case t.TYPES.double:return"number"!=typeof n&&i(typeof n,"not a number"),n;case t.TYPES.string:return"string"==typeof n||n&&n instanceof String||i(typeof n,"not a string"),""+n;case t.TYPES.bytes:return e.isByteBuffer(n)?n:e.wrap(n,"base64");case t.TYPES.enum:var o=this.resolvedType.getChildren(t.Reflect.Enum.Value);for(a=0;a<o.length;a++){if(o[a].name==n)return o[a].id;if(o[a].id==n)return o[a].id}if("proto3"===this.syntax)return("number"!=typeof n||n==n&&n%1!=0)&&i(typeof n,"not an integer"),(n>4294967295||n<0)&&i(typeof n,"not in range for uint32"),n;i(n,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(n&&"object"==typeof n||i(typeof n,"object expected"),n instanceof this.resolvedType.clazz)return n;if(n instanceof t.Builder.Message){var s={};for(var a in n)n.hasOwnProperty(a)&&(s[a]=n[a]);n=s}return new this.resolvedType.clazz(n)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+n+" (undefined type "+this.type+")")},u.calculateLength=function(n,r){if(null===r)return 0;var i;switch(this.type){case t.TYPES.int32:return r<0?e.calculateVarint64(r):e.calculateVarint32(r);case t.TYPES.uint32:return e.calculateVarint32(r);case t.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(r));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES.float:return 4;case t.TYPES.int64:case t.TYPES.uint64:return e.calculateVarint64(r);case t.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(r));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES.enum:return e.calculateVarint32(r);case t.TYPES.double:return 8;case t.TYPES.string:return i=e.calculateUTF8Bytes(r),e.calculateVarint32(i)+i;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return e.calculateVarint32(r.remaining())+r.remaining();case t.TYPES.message:return i=this.resolvedType.calculate(r),e.calculateVarint32(i)+i;case t.TYPES.group:return(i=this.resolvedType.calculate(r))+e.calculateVarint32(n<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},u.encodeValue=function(n,r,i){if(null===r)return i;switch(this.type){case t.TYPES.int32:r<0?i.writeVarint64(r):i.writeVarint32(r);break;case t.TYPES.uint32:i.writeVarint32(r);break;case t.TYPES.sint32:i.writeVarint32ZigZag(r);break;case t.TYPES.fixed32:i.writeUint32(r);break;case t.TYPES.sfixed32:i.writeInt32(r);break;case t.TYPES.int64:case t.TYPES.uint64:i.writeVarint64(r);break;case t.TYPES.sint64:i.writeVarint64ZigZag(r);break;case t.TYPES.fixed64:i.writeUint64(r);break;case t.TYPES.sfixed64:i.writeInt64(r);break;case t.TYPES.bool:"string"==typeof r?i.writeVarint32("false"===r.toLowerCase()?0:!!r):i.writeVarint32(r?1:0);break;case t.TYPES.enum:i.writeVarint32(r);break;case t.TYPES.float:i.writeFloat32(r);break;case t.TYPES.double:i.writeFloat64(r);break;case t.TYPES.string:i.writeVString(r);break;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");var o=r.offset;i.writeVarint32(r.remaining()),i.append(r),r.offset=o;break;case t.TYPES.message:var s=(new e).LE();this.resolvedType.encode(r,s),i.writeVarint32(s.offset),i.append(s.flip());break;case t.TYPES.group:this.resolvedType.encode(r,i),i.writeVarint32(n<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return i},u.decode=function(e,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,o;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES.enum:return e.readVarint32();case t.TYPES.float:return e.readFloat();case t.TYPES.double:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(o=e.readVarint32(),e.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+e.remaining());return(i=e.clone()).limit=i.offset+o,e.offset+=o,i;case t.TYPES.message:return o=e.readVarint32(),this.resolvedType.decode(e,o);case t.TYPES.group:return this.resolvedType.decode(e,-1,r)}throw Error("[INTERNAL] Illegal decode type")},u.valueFromString=function(n){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(n));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(n);case t.TYPES.bool:return"true"===n;case t.TYPES.string:return this.verifyValue(n);case t.TYPES.bytes:return e.fromBinary(n)}},u.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},n.Element=a;var f=function(e,t,n,r,i,s){o.call(this,e,t,n,r,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null},l=f.prototype=Object.create(o.prototype);function h(e,n){var r=n.readVarint32(),i=7&r,o=r>>>3;switch(i){case t.WIRE_TYPES.VARINT:do{r=n.readUint8()}while(128==(128&r));break;case t.WIRE_TYPES.BITS64:n.offset+=8;break;case t.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case t.WIRE_TYPES.STARTGROUP:h(o,n);break;case t.WIRE_TYPES.ENDGROUP:if(o===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+o+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+i)}return!0}l.build=function(n){if(this.clazz&&!n)return this.clazz;var r=function(t,n){var r=n.getChildren(t.Reflect.Message.Field),i=n.getChildren(t.Reflect.Message.OneOf),o=function(s,a){t.Builder.Message.call(this);for(var u=0,c=i.length;u<c;++u)this[i[u].name]=null;for(u=0,c=r.length;u<c;++u){var f=r[u];this[f.name]=f.repeated?[]:f.map?new t.Map(f):null,!f.required&&"proto3"!==n.syntax||null===f.defaultValue||(this[f.name]=f.defaultValue)}var l;if(arguments.length>0)if(1!==arguments.length||null===s||"object"!=typeof s||!("function"!=typeof s.encode||s instanceof o)||Array.isArray(s)||s instanceof t.Map||e.isByteBuffer(s)||s instanceof ArrayBuffer||t.Long&&s instanceof t.Long)for(u=0,c=arguments.length;u<c;++u)void 0!==(l=arguments[u])&&this.$set(r[u].name,l);else this.$set(s)},s=o.prototype=Object.create(t.Builder.Message.prototype);s.add=function(e,r,i){var o=n._fieldsByName[e];if(!i){if(!o)throw Error(this+"#"+e+" is undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+e+" is not a repeated field");r=o.verifyValue(r,!0)}return null===this[e]&&(this[e]=[]),this[e].push(r),this},s.$add=s.add,s.set=function(e,r,i){if(e&&"object"==typeof e){for(var o in i=r,e)e.hasOwnProperty(o)&&void 0!==(r=e[o])&&void 0===n._oneofsByName[o]&&this.$set(o,r,i);return this}var s=n._fieldsByName[e];if(i)this[e]=r;else{if(!s)throw Error(this+"#"+e+" is not a field: undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));this[s.name]=r=s.verifyValue(r)}if(s&&s.oneof){var a=this[s.oneof.name];null!==r?(null!==a&&a!==s.name&&(this[a]=null),this[s.oneof.name]=s.name):a===e&&(this[s.oneof.name]=null)}return this},s.$set=s.set,s.get=function(e,r){if(r)return this[e];var i=n._fieldsByName[e];if(!(i&&i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));return this[i.name]},s.$get=s.get;for(var a=0;a<r.length;a++){var u=r[a];u instanceof t.Reflect.Message.ExtensionField||n.builder.options.populateAccessors&&function(e){var t=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}));t=t.substring(0,1).toUpperCase()+t.substring(1);var r=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),i=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},o=function(){return this[e.name]};null===n.getChild("set"+t)&&(s["set"+t]=i),null===n.getChild("set_"+r)&&(s["set_"+r]=i),null===n.getChild("get"+t)&&(s["get"+t]=o),null===n.getChild("get_"+r)&&(s["get_"+r]=o)}(u)}function c(n,r,i,o){if(null===n||"object"!=typeof n){if(o&&o instanceof t.Reflect.Enum){var s=t.Reflect.Enum.getName(o.object,n);if(null!==s)return s}return n}if(e.isByteBuffer(n))return r?n.toBase64():n.toBuffer();if(t.Long.isLong(n))return i?n.toString():t.Long.fromValue(n);var a;if(Array.isArray(n))return a=[],n.forEach((function(e,t){a[t]=c(e,r,i,o)})),a;if(a={},n instanceof t.Map){for(var u=n.entries(),f=u.next();!f.done;f=u.next())a[n.keyElem.valueToString(f.value[0])]=c(f.value[1],r,i,n.valueElem.resolvedType);return a}var l=n.$type,h=void 0;for(var p in n)n.hasOwnProperty(p)&&(l&&(h=l.getChild(p))?a[p]=c(n[p],r,i,h.resolvedType):a[p]=c(n[p],r,i));return a}return s.encode=function(t,r){"boolean"==typeof t&&(r=t,t=void 0);var i=!1;t||(t=new e,i=!0);var o=t.littleEndian;try{return n.encode(this,t.LE(),r),(i?t.flip():t).LE(o)}catch(e){throw t.LE(o),e}},o.encode=function(e,t,n){return new o(e).encode(t,n)},s.calculate=function(){return n.calculate(this)},s.encodeDelimited=function(t,r){var i=!1;t||(t=new e,i=!0);var o=(new e).LE();return n.encode(this,o,r).flip(),t.writeVarint32(o.remaining()),t.append(o),i?t.flip():t},s.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},s.toArrayBuffer=s.encodeAB,s.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},s.toBuffer=s.encodeNB,s.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},s.toBase64=s.encode64,s.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},s.toHex=s.encodeHex,s.toRaw=function(e,t){return c(this,!!e,!!t,this.$type)},s.encodeJSON=function(){return JSON.stringify(c(this,!0,!0,this.$type))},o.decode=function(t,r,i){"string"==typeof r&&(i=r,r=-1),"string"==typeof t?t=e.wrap(t,i||"base64"):e.isByteBuffer(t)||(t=e.wrap(t));var o=t.littleEndian;try{var s=n.decode(t.LE(),r);return t.LE(o),s}catch(e){throw t.LE(o),e}},o.decodeDelimited=function(t,r){if("string"==typeof t?t=e.wrap(t,r||"base64"):e.isByteBuffer(t)||(t=e.wrap(t)),t.remaining()<1)return null;var i=t.offset,o=t.readVarint32();if(t.remaining()<o)return t.offset=i,null;try{var s=n.decode(t.slice(t.offset,t.offset+o).LE());return t.offset+=o,s}catch(e){throw t.offset+=o,e}},o.decode64=function(e){return o.decode(e,"base64")},o.decodeHex=function(e){return o.decode(e,"hex")},o.decodeJSON=function(e){return new o(JSON.parse(e))},s.toString=function(){return n.toString()},Object.defineProperty&&(Object.defineProperty(o,"$options",{value:n.buildOpt()}),Object.defineProperty(s,"$options",{value:o.$options}),Object.defineProperty(o,"$type",{value:n}),Object.defineProperty(s,"$type",{value:n})),o}(t,this);this._fields=[],this._fieldsById={},this._fieldsByName={},this._oneofsByName={};for(var i,o=0,s=this.children.length;o<s;o++)if((i=this.children[o])instanceof v||i instanceof f||i instanceof b){if(r.hasOwnProperty(i.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+i.toString(!0)+" cannot override static property '"+i.name+"'");r[i.name]=i.build()}else if(i instanceof f.Field)i.build(),this._fields.push(i),this._fieldsById[i.id]=i,this._fieldsByName[i.name]=i;else if(i instanceof f.OneOf)this._oneofsByName[i.name]=i;else if(!(i instanceof f.OneOf||i instanceof y))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[o].toString(!0));return this.clazz=r},l.encode=function(e,t,n){for(var r,i,o=null,s=0,a=this._fields.length;s<a;++s)i=e[(r=this._fields[s]).name],r.required&&null===i?null===o&&(o=r):r.encode(n?i:r.verifyValue(i),t,e);if(null!==o){var u=Error("Missing at least one required field for "+this.toString(!0)+": "+o);throw u.encoded=t,u}return t},l.calculate=function(e){for(var t,n,r=0,i=0,o=this._fields.length;i<o;++i){if(n=e[(t=this._fields[i]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},l.decode=function(e,n,r){"number"!=typeof n&&(n=-1);for(var i,o,s,a,u=e.offset,c=new this.clazz;e.offset<u+n||-1===n&&e.remaining()>0;){if(s=(i=e.readVarint32())>>>3,(o=7&i)===t.WIRE_TYPES.ENDGROUP){if(s!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+s+" ("+(r?r+" expected":"not a group")+")");break}if(a=this._fieldsById[s]){if(a.repeated&&!a.options.packed)c[a.name].push(a.decode(o,e));else if(a.map){var f=a.decode(o,e);c[a.name].set(f[0],f[1])}else if(c[a.name]=a.decode(o,e),a.oneof){var l=c[a.oneof.name];null!==l&&l!==a.name&&(c[l]=null),c[a.oneof.name]=a.name}}else switch(o){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:var p=e.readVarint32();e.offset+=p;break;case t.WIRE_TYPES.STARTGROUP:for(;h(s,e););break;default:throw Error("Illegal wire type for unknown field "+s+" in "+this.toString(!0)+"#decode: "+o)}}for(var d=0,m=this._fields.length;d<m;++d)if(null===c[(a=this._fields[d]).name])if("proto3"===this.syntax)c[a.name]=a.defaultValue;else{if(a.required){var v=Error("Missing at least one required field for "+this.toString(!0)+": "+a.name);throw v.decoded=c,v}t.populateDefaults&&null!==a.defaultValue&&(c[a.name]=a.defaultValue)}return c},n.Message=f;var p=function(e,n,i,o,s,a,u,c,l,h){r.call(this,e,n,a),this.className="Message.Field",this.required="required"===i,this.repeated="repeated"===i,this.map="map"===i,this.keyType=o||null,this.type=s,this.resolvedType=null,this.id=u,this.options=c||{},this.defaultValue=null,this.oneof=l||null,this.syntax=h||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof f.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},d=p.prototype=Object.create(r.prototype);d.build=function(){this.element=new a(this.type,this.resolvedType,!1,this.syntax,this.name),this.map&&(this.keyElement=new a(this.keyType,void 0,!0,this.syntax,this.name)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=a.defaultFieldValue(this.type)},d.verifyValue=function(e,n){n=n||!1;var r,i=this;function o(e,t){throw Error("Illegal value for "+i.toString(!0)+" of type "+i.type.name+": "+e+" ("+t+")")}if(null===e)return this.required&&o(typeof e,"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&o(typeof e,"proto3 field without field presence cannot be null"),null;if(this.repeated&&!n){Array.isArray(e)||(e=[e]);var s=[];for(r=0;r<e.length;r++)s.push(this.element.verifyValue(e[r]));return s}return this.map&&!n?e instanceof t.Map?e:(e instanceof Object||o(typeof e,"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&o(typeof e,"no array expected"),this.element.verifyValue(e))},d.hasWirePresence=function(e,n){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES.float:case t.TYPES.double:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES.enum:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},d.encode=function(n,r,i){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===n||this.repeated&&0==n.length)return r;try{var o;if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.ensureCapacity(r.offset+=1);var s=r.offset;for(o=0;o<n.length;o++)this.element.encodeValue(this.id,n[o],r);var a=r.offset-s,u=e.calculateVarint32(a);if(u>1){var c=r.slice(s,r.offset);s+=u-1,r.offset=s,r.append(c)}r.writeVarint32(a,s-u)}else for(o=0;o<n.length;o++)r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,n[o],r);else this.map?n.forEach((function(n,i,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,i)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,n);r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.writeVarint32(s),r.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,i,r),r.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,n,r)}),this):this.hasWirePresence(n,i)&&(r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,n,r))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+n+" ("+e+")")}return r},d.calculate=function(n,r){if(n=this.verifyValue(n),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===n||this.repeated&&0==n.length)return 0;var i=0;try{var o,s;if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(i+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),s=0,o=0;o<n.length;o++)s+=this.element.calculateLength(this.id,n[o]);i+=e.calculateVarint32(s),i+=s}else for(o=0;o<n.length;o++)i+=e.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,n[o]);else this.map?n.forEach((function(n,r,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,n);i+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i+=e.calculateVarint32(s),i+=s}),this):this.hasWirePresence(n,r)&&(i+=e.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,n))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+n+" ("+e+")")}return i},d.decode=function(e,n,r){var i,o;if(!(!this.map&&e==this.type.wireType||!r&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){o=n.readVarint32(),o=n.offset+o;for(var s=[];n.offset<o;)s.push(this.decode(this.type.wireType,n,!0));return s}if(this.map){var u=a.defaultFieldValue(this.keyType);if(i=a.defaultFieldValue(this.type),o=n.readVarint32(),n.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+n.remaining());var c=n.clone();for(c.limit=c.offset+o,n.offset+=o;c.remaining()>0;){var f=c.readVarint32();e=7&f;var l=f>>>3;if(1===l)u=this.keyElement.decode(c,e,l);else{if(2!==l)throw Error("Unexpected tag in map field key/value submessage");i=this.element.decode(c,e,l)}}return[u,i]}return this.element.decode(n,e,this.id)},n.Message.Field=p;var m=function(e,t,n,r,i,o,s){p.call(this,e,t,n,null,r,i,o,s),this.extension};m.prototype=Object.create(p.prototype),n.Message.ExtensionField=m;n.Message.OneOf=function(e,t,n){r.call(this,e,t,n),this.fields=[]};var v=function(e,t,n,r,i){o.call(this,e,t,n,r,i),this.className="Enum",this.object=null};v.getName=function(e,t){for(var n,r=Object.keys(e),i=0;i<r.length;++i)if(e[n=r[i]]===t)return n;return null},(v.prototype=Object.create(o.prototype)).build=function(e){if(this.object&&!e)return this.object;for(var n=new t.Builder.Enum,r=this.getChildren(v.Value),i=0,o=r.length;i<o;++i)n[r[i].name]=r[i].id;return Object.defineProperty&&Object.defineProperty(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},n.Enum=v;var g=function(e,t,n,i){r.call(this,e,t,n),this.className="Enum.Value",this.id=i};g.prototype=Object.create(r.prototype),n.Enum.Value=g;var y=function(e,t,n,i){r.call(this,e,t,n),this.field=i};y.prototype=Object.create(r.prototype),n.Extension=y;var b=function(e,t,n,r){o.call(this,e,t,n,r),this.className="Service",this.clazz=null};(b.prototype=Object.create(o.prototype)).build=function(n){return this.clazz&&!n?this.clazz:this.clazz=function(t,n){for(var r=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},i=r.prototype=Object.create(t.Builder.Service.prototype),o=n.getChildren(t.Reflect.Service.RPCMethod),s=0;s<o.length;s++)!function(t){i[t.name]=function(r,i){try{try{r=t.resolvedRequestType.clazz.decode(e.wrap(r))}catch(e){if(!(e instanceof TypeError))throw e}if(null===r||"object"!=typeof r)throw Error("Illegal arguments");r instanceof t.resolvedRequestType.clazz||(r=new t.resolvedRequestType.clazz(r)),this.rpcImpl(t.fqn(),r,(function(e,r){if(e)i(e);else{null===r&&(r="");try{r=t.resolvedResponseType.clazz.decode(r)}catch(e){}r&&r instanceof t.resolvedResponseType.clazz?i(null,r):i(Error("Illegal response type received in service method "+n.name+"#"+t.name))}}))}catch(e){setTimeout(i.bind(this,e),0)}},r[t.name]=function(e,n,i){new r(e)[t.name](n,i)},Object.defineProperty&&(Object.defineProperty(r[t.name],"$options",{value:t.buildOpt()}),Object.defineProperty(i[t.name],"$options",{value:r[t.name].$options}))}(o[s]);return Object.defineProperty&&(Object.defineProperty(r,"$options",{value:n.buildOpt()}),Object.defineProperty(i,"$options",{value:r.$options}),Object.defineProperty(r,"$type",{value:n}),Object.defineProperty(i,"$type",{value:n})),r}(t,this)},n.Service=b;var w=function(e,t,n,i){r.call(this,e,t,n),this.className="Service.Method",this.options=i||{}};(w.prototype=Object.create(r.prototype)).buildOpt=s.buildOpt,n.Service.Method=w;var _=function(e,t,n,r,i,o,s,a){w.call(this,e,t,n,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=o,this.responseStream=s,this.resolvedRequestType=null,this.resolvedResponseType=null};return _.prototype=Object.create(w.prototype),n.Service.RPCMethod=_,n}(i),i.Builder=function(e,t,n){var r=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},i=r.prototype;return r.isMessage=function(e){return"string"==typeof e.name&&(void 0===e.values&&void 0===e.rpc)},r.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},r.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},r.isService=function(e){return!("string"!=typeof e.name||"object"!=typeof e.rpc||!e.rpc)},r.isExtend=function(e){return"string"==typeof e.ref},i.reset=function(){return this.ptr=this.ns,this},i.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},i.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var i=[t];i.length>0;){if(t=i.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){var o=t.shift();if(r.isMessage(o)){var s=new n.Message(this,this.ptr,o.name,o.options,o.isGroup,o.syntax),a={};o.oneofs&&Object.keys(o.oneofs).forEach((function(e){s.addChild(a[e]=new n.Message.OneOf(this,s,e))}),this),o.fields&&o.fields.forEach((function(e){if(null!==s.getChild(0|e.id))throw Error("duplicate or invalid field id in "+s.name+": "+e.id);if(e.options&&"object"!=typeof e.options)throw Error("illegal field options in "+s.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+s.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,s,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,o.syntax),t&&t.fields.push(e),s.addChild(e)}),this);var u=[];if(o.enums&&o.enums.forEach((function(e){u.push(e)})),o.messages&&o.messages.forEach((function(e){u.push(e)})),o.services&&o.services.forEach((function(e){u.push(e)})),o.extensions&&("number"==typeof o.extensions[0]?s.extensions=[o.extensions]:s.extensions=o.extensions),this.ptr.addChild(s),u.length>0){i.push(t),t=u,u=null,this.ptr=s,s=null;continue}u=null}else if(r.isEnum(o))s=new n.Enum(this,this.ptr,o.name,o.options,o.syntax),o.values.forEach((function(e){s.addChild(new n.Enum.Value(this,s,e.name,e.id))}),this),this.ptr.addChild(s);else if(r.isService(o))s=new n.Service(this,this.ptr,o.name,o.options),Object.keys(o.rpc).forEach((function(e){var t=o.rpc[e];s.addChild(new n.Service.RPCMethod(this,s,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(s);else{if(!r.isExtend(o))throw Error("not a valid definition: "+JSON.stringify(o));if(s=this.ptr.resolve(o.ref,!0))o.fields.forEach((function(t){if(null!==s.getChild(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(s.extensions){var r=!1;if(s.extensions.forEach((function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)})),!r)throw Error("illegal extended field id in "+s.name+": "+t.id+" (not within valid ranges)")}var i=t.name;this.options.convertFieldsToCamelCase&&(i=e.Util.toCamelCase(i));var o=new n.Message.ExtensionField(this,s,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),a=new n.Extension(this,this.ptr,t.name,o);o.extension=a,this.ptr.addChild(a),s.addChild(o)}),this);else if(!/\.?google\.protobuf\./.test(o.ref))throw Error("extended message "+o.ref+" is not defined")}o=null,s=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},i.import=function(t,n){var r="/";if("string"==typeof n){if(e.Util.IS_NODE&&(n=qr.resolve(n)),!0===this.files[n])return this.reset();this.files[n]=!0}else if("object"==typeof n){var i,o=n.root;if(e.Util.IS_NODE&&(o=qr.resolve(o)),(o.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(r="\\"),i=e.Util.IS_NODE?qr.join(o,n.file):o+r+n.file,!0===this.files[i])return this.reset();this.files[i]=!0}if(t.imports&&t.imports.length>0){var s,a=!1;"object"==typeof n?(this.importRoot=n.root,a=!0,s=this.importRoot,n=n.file,(s.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(r="\\")):"string"==typeof n?this.importRoot?s=this.importRoot:n.indexOf("/")>=0?""===(s=n.replace(/\/[^\/]*$/,""))&&(s="/"):n.indexOf("\\")>=0?(s=n.replace(/\\[^\\]*$/,""),r="\\"):s=".":s=null;for(var u=0;u<t.imports.length;u++)if("string"==typeof t.imports[u]){if(!s)throw Error("cannot determine import root");var c=t.imports[u];if("google/protobuf/descriptor.proto"===c)continue;if(c=e.Util.IS_NODE?qr.join(s,c):s+r+c,!0===this.files[c])continue;/\.proto$/i.test(c)&&!e.DotProto&&(c=c.replace(/\.proto$/,".json"));var f=e.Util.fetch(c);if(null===f)throw Error("failed to import '"+c+"' in '"+n+"': file not found");/\.json$/i.test(c)?this.import(JSON.parse(f+""),c):this.import(e.DotProto.Parser.parse(f),c)}else n?/\.(\w+)$/.test(n)?this.import(t.imports[u],n.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+u+"."+n}))):this.import(t.imports[u],n+"_import"+u):this.import(t.imports[u]);a&&(this.importRoot=null)}t.package&&this.define(t.package),t.syntax&&function e(t){t.messages&&t.messages.forEach((function(n){n.syntax=t.syntax,e(n)})),t.enums&&t.enums.forEach((function(e){e.syntax=t.syntax}))}(t);var l=this.ptr;return t.options&&Object.keys(t.options).forEach((function(e){l.options[e]=t.options[e]})),t.messages&&(this.create(t.messages),this.ptr=l),t.enums&&(this.create(t.enums),this.ptr=l),t.services&&(this.create(t.services),this.ptr=l),t.extends&&this.create(t.extends),this.reset()},i.resolveAll=function(){var r;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(r=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof n.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}"proto3"===this.ptr.syntax&&this.ptr.repeated&&void 0===this.ptr.options.packed&&-1!==e.PACKABLE_WIRE_TYPES.indexOf(this.ptr.type.wireType)&&(this.ptr.options.packed=!0)}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((r=this.ptr.parent.resolve(this.ptr.requestName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,!((r=this.ptr.parent.resolve(this.ptr.responseName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},i.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},i.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},i.toString=function(){return"Builder"},r.Message=function(){},r.Enum=function(){},r.Service=function(){},r}(i,i.Lang,i.Reflect),i.Map=function(e,t){var n=function(e,n){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),n)for(var r=Object.keys(n),i=0;i<r.length;i++){var o=this.keyElem.valueFromString(r[i]),s=this.valueElem.verifyValue(n[r[i]]);this.map[this.keyElem.valueToString(o)]={key:o,value:s}}},r=n.prototype;function i(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}return r.clear=function(){this.map={}},r.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},r.entries=function(){for(var e,t=[],n=Object.keys(this.map),r=0;r<n.length;r++)t.push([(e=this.map[n[r]]).key,e.value]);return i(t)},r.keys=function(){for(var e=[],t=Object.keys(this.map),n=0;n<t.length;n++)e.push(this.map[t[n]].key);return i(e)},r.values=function(){for(var e=[],t=Object.keys(this.map),n=0;n<t.length;n++)e.push(this.map[t[n]].value);return i(e)},r.forEach=function(e,t){for(var n,r=Object.keys(this.map),i=0;i<r.length;i++)e.call(t,(n=this.map[r[i]]).value,n.key,this)},r.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},r.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));if(t in this.map)return this.map[t].value},r.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},n}(0,i.Reflect),i.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"==typeof t||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},i.loadJsonFile=function(e,t,n){if(t&&"object"==typeof t?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,i.loadJson(JSON.parse(r),n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=i.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===r?null:i.loadJson(JSON.parse(r),n,e)},i}))})).newBuilder({}).import({package:"push_server.messages2",syntax:"proto2",options:{objc_class_prefix:"AVIM"},messages:[{name:"JsonObjectMessage",syntax:"proto2",fields:[{rule:"required",type:"string",name:"data",id:1}]},{name:"UnreadTuple",syntax:"proto2",fields:[{rule:"required",type:"string",name:"cid",id:1},{rule:"required",type:"int32",name:"unread",id:2},{rule:"optional",type:"string",name:"mid",id:3},{rule:"optional",type:"int64",name:"timestamp",id:4},{rule:"optional",type:"string",name:"from",id:5},{rule:"optional",type:"string",name:"data",id:6},{rule:"optional",type:"int64",name:"patchTimestamp",id:7},{rule:"optional",type:"bool",name:"mentioned",id:8},{rule:"optional",type:"bytes",name:"binaryMsg",id:9},{rule:"optional",type:"int32",name:"convType",id:10}]},{name:"LogItem",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"from",id:1},{rule:"optional",type:"string",name:"data",id:2},{rule:"optional",type:"int64",name:"timestamp",id:3},{rule:"optional",type:"string",name:"msgId",id:4},{rule:"optional",type:"int64",name:"ackAt",id:5},{rule:"optional",type:"int64",name:"readAt",id:6},{rule:"optional",type:"int64",name:"patchTimestamp",id:7},{rule:"optional",type:"bool",name:"mentionAll",id:8},{rule:"repeated",type:"string",name:"mentionPids",id:9},{rule:"optional",type:"bool",name:"bin",id:10},{rule:"optional",type:"int32",name:"convType",id:11}]},{name:"ConvMemberInfo",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"pid",id:1},{rule:"optional",type:"string",name:"role",id:2},{rule:"optional",type:"string",name:"infoId",id:3}]},{name:"DataCommand",syntax:"proto2",fields:[{rule:"repeated",type:"string",name:"ids",id:1},{rule:"repeated",type:"JsonObjectMessage",name:"msg",id:2},{rule:"optional",type:"bool",name:"offline",id:3}]},{name:"SessionCommand",syntax:"proto2",fields:[{rule:"optional",type:"int64",name:"t",id:1},{rule:"optional",type:"string",name:"n",id:2},{rule:"optional",type:"string",name:"s",id:3},{rule:"optional",type:"string",name:"ua",id:4},{rule:"optional",type:"bool",name:"r",id:5},{rule:"optional",type:"string",name:"tag",id:6},{rule:"optional",type:"string",name:"deviceId",id:7},{rule:"repeated",type:"string",name:"sessionPeerIds",id:8},{rule:"repeated",type:"string",name:"onlineSessionPeerIds",id:9},{rule:"optional",type:"string",name:"st",id:10},{rule:"optional",type:"int32",name:"stTtl",id:11},{rule:"optional",type:"int32",name:"code",id:12},{rule:"optional",type:"string",name:"reason",id:13},{rule:"optional",type:"string",name:"deviceToken",id:14},{rule:"optional",type:"bool",name:"sp",id:15},{rule:"optional",type:"string",name:"detail",id:16},{rule:"optional",type:"int64",name:"lastUnreadNotifTime",id:17},{rule:"optional",type:"int64",name:"lastPatchTime",id:18},{rule:"optional",type:"int64",name:"configBitmap",id:19}]},{name:"ErrorCommand",syntax:"proto2",fields:[{rule:"required",type:"int32",name:"code",id:1},{rule:"required",type:"string",name:"reason",id:2},{rule:"optional",type:"int32",name:"appCode",id:3},{rule:"optional",type:"string",name:"detail",id:4},{rule:"repeated",type:"string",name:"pids",id:5},{rule:"optional",type:"string",name:"appMsg",id:6}]},{name:"DirectCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"msg",id:1},{rule:"optional",type:"string",name:"uid",id:2},{rule:"optional",type:"string",name:"fromPeerId",id:3},{rule:"optional",type:"int64",name:"timestamp",id:4},{rule:"optional",type:"bool",name:"offline",id:5},{rule:"optional",type:"bool",name:"hasMore",id:6},{rule:"repeated",type:"string",name:"toPeerIds",id:7},{rule:"optional",type:"bool",name:"r",id:10},{rule:"optional",type:"string",name:"cid",id:11},{rule:"optional",type:"string",name:"id",id:12},{rule:"optional",type:"bool",name:"transient",id:13},{rule:"optional",type:"string",name:"dt",id:14},{rule:"optional",type:"string",name:"roomId",id:15},{rule:"optional",type:"string",name:"pushData",id:16},{rule:"optional",type:"bool",name:"will",id:17},{rule:"optional",type:"int64",name:"patchTimestamp",id:18},{rule:"optional",type:"bytes",name:"binaryMsg",id:19},{rule:"repeated",type:"string",name:"mentionPids",id:20},{rule:"optional",type:"bool",name:"mentionAll",id:21},{rule:"optional",type:"int32",name:"convType",id:22}]},{name:"AckCommand",syntax:"proto2",fields:[{rule:"optional",type:"int32",name:"code",id:1},{rule:"optional",type:"string",name:"reason",id:2},{rule:"optional",type:"string",name:"mid",id:3},{rule:"optional",type:"string",name:"cid",id:4},{rule:"optional",type:"int64",name:"t",id:5},{rule:"optional",type:"string",name:"uid",id:6},{rule:"optional",type:"int64",name:"fromts",id:7},{rule:"optional",type:"int64",name:"tots",id:8},{rule:"optional",type:"string",name:"type",id:9},{rule:"repeated",type:"string",name:"ids",id:10},{rule:"optional",type:"int32",name:"appCode",id:11},{rule:"optional",type:"string",name:"appMsg",id:12}]},{name:"UnreadCommand",syntax:"proto2",fields:[{rule:"repeated",type:"UnreadTuple",name:"convs",id:1},{rule:"optional",type:"int64",name:"notifTime",id:2}]},{name:"ConvCommand",syntax:"proto2",fields:[{rule:"repeated",type:"string",name:"m",id:1},{rule:"optional",type:"bool",name:"transient",id:2},{rule:"optional",type:"bool",name:"unique",id:3},{rule:"optional",type:"string",name:"cid",id:4},{rule:"optional",type:"string",name:"cdate",id:5},{rule:"optional",type:"string",name:"initBy",id:6},{rule:"optional",type:"string",name:"sort",id:7},{rule:"optional",type:"int32",name:"limit",id:8},{rule:"optional",type:"int32",name:"skip",id:9},{rule:"optional",type:"int32",name:"flag",id:10},{rule:"optional",type:"int32",name:"count",id:11},{rule:"optional",type:"string",name:"udate",id:12},{rule:"optional",type:"int64",name:"t",id:13},{rule:"optional",type:"string",name:"n",id:14},{rule:"optional",type:"string",name:"s",id:15},{rule:"optional",type:"bool",name:"statusSub",id:16},{rule:"optional",type:"bool",name:"statusPub",id:17},{rule:"optional",type:"int32",name:"statusTTL",id:18},{rule:"optional",type:"string",name:"uniqueId",id:19},{rule:"optional",type:"string",name:"targetClientId",id:20},{rule:"optional",type:"int64",name:"maxReadTimestamp",id:21},{rule:"optional",type:"int64",name:"maxAckTimestamp",id:22},{rule:"optional",type:"bool",name:"queryAllMembers",id:23},{rule:"repeated",type:"MaxReadTuple",name:"maxReadTuples",id:24},{rule:"repeated",type:"string",name:"cids",id:25},{rule:"optional",type:"ConvMemberInfo",name:"info",id:26},{rule:"optional",type:"bool",name:"tempConv",id:27},{rule:"optional",type:"int32",name:"tempConvTTL",id:28},{rule:"repeated",type:"string",name:"tempConvIds",id:29},{rule:"repeated",type:"string",name:"allowedPids",id:30},{rule:"repeated",type:"ErrorCommand",name:"failedPids",id:31},{rule:"optional",type:"string",name:"next",id:40},{rule:"optional",type:"JsonObjectMessage",name:"results",id:100},{rule:"optional",type:"JsonObjectMessage",name:"where",id:101},{rule:"optional",type:"JsonObjectMessage",name:"attr",id:103},{rule:"optional",type:"JsonObjectMessage",name:"attrModified",id:104}]},{name:"RoomCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"roomId",id:1},{rule:"optional",type:"string",name:"s",id:2},{rule:"optional",type:"int64",name:"t",id:3},{rule:"optional",type:"string",name:"n",id:4},{rule:"optional",type:"bool",name:"transient",id:5},{rule:"repeated",type:"string",name:"roomPeerIds",id:6},{rule:"optional",type:"string",name:"byPeerId",id:7}]},{name:"LogsCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"optional",type:"int32",name:"l",id:2},{rule:"optional",type:"int32",name:"limit",id:3},{rule:"optional",type:"int64",name:"t",id:4},{rule:"optional",type:"int64",name:"tt",id:5},{rule:"optional",type:"string",name:"tmid",id:6},{rule:"optional",type:"string",name:"mid",id:7},{rule:"optional",type:"string",name:"checksum",id:8},{rule:"optional",type:"bool",name:"stored",id:9},{rule:"optional",type:"QueryDirection",name:"direction",id:10,options:{default:"OLD"}},{rule:"optional",type:"bool",name:"tIncluded",id:11},{rule:"optional",type:"bool",name:"ttIncluded",id:12},{rule:"optional",type:"int32",name:"lctype",id:13},{rule:"repeated",type:"LogItem",name:"logs",id:105}],enums:[{name:"QueryDirection",syntax:"proto2",values:[{name:"OLD",id:1},{name:"NEW",id:2}]}]},{name:"RcpCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"id",id:1},{rule:"optional",type:"string",name:"cid",id:2},{rule:"optional",type:"int64",name:"t",id:3},{rule:"optional",type:"bool",name:"read",id:4},{rule:"optional",type:"string",name:"from",id:5}]},{name:"ReadTuple",syntax:"proto2",fields:[{rule:"required",type:"string",name:"cid",id:1},{rule:"optional",type:"int64",name:"timestamp",id:2},{rule:"optional",type:"string",name:"mid",id:3}]},{name:"MaxReadTuple",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"pid",id:1},{rule:"optional",type:"int64",name:"maxAckTimestamp",id:2},{rule:"optional",type:"int64",name:"maxReadTimestamp",id:3}]},{name:"ReadCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"repeated",type:"string",name:"cids",id:2},{rule:"repeated",type:"ReadTuple",name:"convs",id:3}]},{name:"PresenceCommand",syntax:"proto2",fields:[{rule:"optional",type:"StatusType",name:"status",id:1},{rule:"repeated",type:"string",name:"sessionPeerIds",id:2},{rule:"optional",type:"string",name:"cid",id:3}]},{name:"ReportCommand",syntax:"proto2",fields:[{rule:"optional",type:"bool",name:"initiative",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"optional",type:"string",name:"data",id:3}]},{name:"PatchItem",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"optional",type:"string",name:"mid",id:2},{rule:"optional",type:"int64",name:"timestamp",id:3},{rule:"optional",type:"bool",name:"recall",id:4},{rule:"optional",type:"string",name:"data",id:5},{rule:"optional",type:"int64",name:"patchTimestamp",id:6},{rule:"optional",type:"string",name:"from",id:7},{rule:"optional",type:"bytes",name:"binaryMsg",id:8},{rule:"optional",type:"bool",name:"mentionAll",id:9},{rule:"repeated",type:"string",name:"mentionPids",id:10},{rule:"optional",type:"int64",name:"patchCode",id:11},{rule:"optional",type:"string",name:"patchReason",id:12}]},{name:"PatchCommand",syntax:"proto2",fields:[{rule:"repeated",type:"PatchItem",name:"patches",id:1},{rule:"optional",type:"int64",name:"lastPatchTime",id:2}]},{name:"PubsubCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"repeated",type:"string",name:"cids",id:2},{rule:"optional",type:"string",name:"topic",id:3},{rule:"optional",type:"string",name:"subtopic",id:4},{rule:"repeated",type:"string",name:"topics",id:5},{rule:"repeated",type:"string",name:"subtopics",id:6},{rule:"optional",type:"JsonObjectMessage",name:"results",id:7}]},{name:"BlacklistCommand",syntax:"proto2",fields:[{rule:"optional",type:"string",name:"srcCid",id:1},{rule:"repeated",type:"string",name:"toPids",id:2},{rule:"optional",type:"string",name:"srcPid",id:3},{rule:"repeated",type:"string",name:"toCids",id:4},{rule:"optional",type:"int32",name:"limit",id:5},{rule:"optional",type:"string",name:"next",id:6},{rule:"repeated",type:"string",name:"blockedPids",id:8},{rule:"repeated",type:"string",name:"blockedCids",id:9},{rule:"repeated",type:"string",name:"allowedPids",id:10},{rule:"repeated",type:"ErrorCommand",name:"failedPids",id:11},{rule:"optional",type:"int64",name:"t",id:12},{rule:"optional",type:"string",name:"n",id:13},{rule:"optional",type:"string",name:"s",id:14}]},{name:"GenericCommand",syntax:"proto2",fields:[{rule:"optional",type:"CommandType",name:"cmd",id:1},{rule:"optional",type:"OpType",name:"op",id:2},{rule:"optional",type:"string",name:"appId",id:3},{rule:"optional",type:"string",name:"peerId",id:4},{rule:"optional",type:"int32",name:"i",id:5},{rule:"optional",type:"string",name:"installationId",id:6},{rule:"optional",type:"int32",name:"priority",id:7},{rule:"optional",type:"int32",name:"service",id:8},{rule:"optional",type:"int64",name:"serverTs",id:9},{rule:"optional",type:"int64",name:"clientTs",id:10},{rule:"optional",type:"int32",name:"notificationType",id:11},{rule:"optional",type:"DataCommand",name:"dataMessage",id:101},{rule:"optional",type:"SessionCommand",name:"sessionMessage",id:102},{rule:"optional",type:"ErrorCommand",name:"errorMessage",id:103},{rule:"optional",type:"DirectCommand",name:"directMessage",id:104},{rule:"optional",type:"AckCommand",name:"ackMessage",id:105},{rule:"optional",type:"UnreadCommand",name:"unreadMessage",id:106},{rule:"optional",type:"ReadCommand",name:"readMessage",id:107},{rule:"optional",type:"RcpCommand",name:"rcpMessage",id:108},{rule:"optional",type:"LogsCommand",name:"logsMessage",id:109},{rule:"optional",type:"ConvCommand",name:"convMessage",id:110},{rule:"optional",type:"RoomCommand",name:"roomMessage",id:111},{rule:"optional",type:"PresenceCommand",name:"presenceMessage",id:112},{rule:"optional",type:"ReportCommand",name:"reportMessage",id:113},{rule:"optional",type:"PatchCommand",name:"patchMessage",id:114},{rule:"optional",type:"PubsubCommand",name:"pubsubMessage",id:115},{rule:"optional",type:"BlacklistCommand",name:"blacklistMessage",id:116}]}],enums:[{name:"CommandType",syntax:"proto2",values:[{name:"session",id:0},{name:"conv",id:1},{name:"direct",id:2},{name:"ack",id:3},{name:"rcp",id:4},{name:"unread",id:5},{name:"logs",id:6},{name:"error",id:7},{name:"login",id:8},{name:"data",id:9},{name:"room",id:10},{name:"read",id:11},{name:"presence",id:12},{name:"report",id:13},{name:"echo",id:14},{name:"loggedin",id:15},{name:"logout",id:16},{name:"loggedout",id:17},{name:"patch",id:18},{name:"pubsub",id:19},{name:"blacklist",id:20},{name:"goaway",id:21}]},{name:"OpType",syntax:"proto2",values:[{name:"open",id:1},{name:"add",id:2},{name:"remove",id:3},{name:"close",id:4},{name:"opened",id:5},{name:"closed",id:6},{name:"query",id:7},{name:"query_result",id:8},{name:"conflict",id:9},{name:"added",id:10},{name:"removed",id:11},{name:"refresh",id:12},{name:"refreshed",id:13},{name:"start",id:30},{name:"started",id:31},{name:"joined",id:32},{name:"members_joined",id:33},{name:"left",id:39},{name:"members_left",id:40},{name:"results",id:42},{name:"count",id:43},{name:"result",id:44},{name:"update",id:45},{name:"updated",id:46},{name:"mute",id:47},{name:"unmute",id:48},{name:"status",id:49},{name:"members",id:50},{name:"max_read",id:51},{name:"is_member",id:52},{name:"member_info_update",id:53},{name:"member_info_updated",id:54},{name:"member_info_changed",id:55},{name:"join",id:80},{name:"invite",id:81},{name:"leave",id:82},{name:"kick",id:83},{name:"reject",id:84},{name:"invited",id:85},{name:"kicked",id:86},{name:"upload",id:100},{name:"uploaded",id:101},{name:"subscribe",id:120},{name:"subscribed",id:121},{name:"unsubscribe",id:122},{name:"unsubscribed",id:123},{name:"is_subscribed",id:124},{name:"modify",id:150},{name:"modified",id:151},{name:"block",id:170},{name:"unblock",id:171},{name:"blocked",id:172},{name:"unblocked",id:173},{name:"members_blocked",id:174},{name:"members_unblocked",id:175},{name:"check_block",id:176},{name:"check_result",id:177},{name:"add_shutup",id:180},{name:"remove_shutup",id:181},{name:"query_shutup",id:182},{name:"shutup_added",id:183},{name:"shutup_removed",id:184},{name:"shutup_result",id:185},{name:"shutuped",id:186},{name:"unshutuped",id:187},{name:"members_shutuped",id:188},{name:"members_unshutuped",id:189},{name:"check_shutup",id:190}]},{name:"StatusType",syntax:"proto2",values:[{name:"on",id:1},{name:"off",id:2}]}],isNamespace:!0}).build().push_server.messages2,Wr=zr.JsonObjectMessage,Gr=zr.UnreadTuple,$r=zr.LogItem,Jr=zr.DataCommand,Zr=zr.SessionCommand,Kr=zr.ErrorCommand,Xr=zr.DirectCommand,Hr=zr.AckCommand,Qr=zr.UnreadCommand,ei=zr.ConvCommand,ti=zr.RoomCommand,ni=zr.LogsCommand,ri=zr.RcpCommand,ii=zr.ReadTuple,oi=zr.MaxReadTuple,si=zr.ReadCommand,ai=zr.PresenceCommand,ui=zr.ReportCommand,ci=zr.GenericCommand,fi=zr.BlacklistCommand,li=zr.PatchCommand,hi=zr.PatchItem,pi=zr.ConvMemberInfo,di=zr.CommandType,mi=zr.OpType,vi=zr.StatusType,gi=Object.freeze({__proto__:null,JsonObjectMessage:Wr,UnreadTuple:Gr,LogItem:$r,DataCommand:Jr,SessionCommand:Zr,ErrorCommand:Kr,DirectCommand:Xr,AckCommand:Hr,UnreadCommand:Qr,ConvCommand:ei,RoomCommand:ti,LogsCommand:ni,RcpCommand:ri,ReadTuple:ii,MaxReadTuple:oi,ReadCommand:si,PresenceCommand:ai,ReportCommand:ui,GenericCommand:ci,BlacklistCommand:fi,PatchCommand:li,PatchItem:hi,ConvMemberInfo:pi,CommandType:di,OpType:mi,StatusType:vi}),yi=i((function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var u,c,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,r),!0;case 4:return f.fn.call(f.context,t,r,i),!0;case 5:return f.fn.call(f.context,t,r,i,o),!0;case 6:return f.fn.call(f.context,t,r,i,o,s),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];f.fn.apply(f.context,u)}else{var h,p=f.length;for(c=0;c<p;c++)switch(f[c].once&&this.removeListener(e,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,t);break;case 3:f[c].fn.call(f[c].context,t,r);break;case 4:f[c].fn.call(f[c].context,t,r,i);break;default:if(!u)for(h=1,u=new Array(l-1);h<l;h++)u[h-1]=arguments[h];f[c].fn.apply(f[c].context,u)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var u=0,c=[],f=a.length;u<f;u++)(a[u].fn!==t||i&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a})),bi=u.JSON||(u.JSON={stringify:JSON.stringify}),wi=function(e){return bi.stringify.apply(bi,arguments)},_i=i((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function a(e,t,n,r){var i=t&&t.prototype instanceof f?t:f,o=Object.create(i.prototype),s=new E(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return S()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=b(s,n);if(a){if(a===c)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var f=u(e,t,n);if("normal"===f.type){if(r=n.done?"completed":"suspendedYield",f.arg===c)continue;return{value:f.arg,done:n.done}}"throw"===f.type&&(r="completed",n.method="throw",n.arg=f.arg)}}}(e,n,s),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=a;var c={};function f(){}function l(){}function h(){}var p={};p[i]=function(){return this};var d=Object.getPrototypeOf,m=d&&d(d(T([])));m&&m!==t&&n.call(m,i)&&(p=m);var v=h.prototype=f.prototype=Object.create(p);function g(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function y(e,t){var r;this._invoke=function(i,o){function s(){return new t((function(r,s){!function r(i,o,s,a){var c=u(e[i],e,o);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(l).then((function(e){f.value=e,s(f)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}(i,o,r,s)}))}return r=r?r.then(s,s):s()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function T(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return l.prototype=v.constructor=h,h.constructor=l,h[s]=l.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},g(y.prototype),y.prototype[o]=function(){return this},e.AsyncIterator=y,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new y(a(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},g(v),v[s]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=t}catch(e){}}));function Ei(e,t,n,r,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void n(e)}a.done?t(u):wr.resolve(u).then(r,i)}var Ti=function(e){return function(){var t=this,n=arguments;return new wr((function(r,i){var o=e.apply(t,n);function s(e){Ei(o,r,i,s,a,"next",e)}function a(e){Ei(o,r,i,s,a,"throw",e)}s(void 0)}))}};var Si=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r};var Ii=function(e){if(P(e))return Si(e)};O(O.S+O.F*!tr((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,r,i,o=ge(e),s="function"==typeof this?this:Array,a=arguments.length,u=a>1?arguments[1]:void 0,c=void 0!==u,l=0,h=qe(o);if(c&&(u=f(u,a>2?arguments[2]:void 0,2)),null==h||s==Array&&De(h))for(n=new s(t=q(o.length));t>l;l++)Dr(n,l,c?u(o[l],l):o[l]);else for(i=h.call(o),n=new s;!(r=i.next()).done;l++)Dr(n,l,c?Le(i,u,[r.value,l],!0):r.value);return n.length=l,n}});var Ai=u.Array.from,Oi=fe("iterator"),Ci=u.isIterable=function(e){var t=Object(e);return void 0!==t[Oi]||"@@iterator"in t||B.hasOwnProperty(Ve(t))};var Mi=function(e){if(void 0!==en&&Ci(Object(e)))return Ai(e)};var xi=function(e,t){if(e){if("string"==typeof e)return Si(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Ai(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Si(e,t):void 0}};var ki=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var Pi=function(e){return Ii(e)||Mi(e)||xi(e)||ki()};ot("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return Qe.def(Je(this,"Set"),e=0===e?0:e,e)}},Qe);O(O.P+O.R,"Set",{toJSON:st("Set")}),at("Set"),ut("Set");var Ri=u.Set;var Ni=function(e,t){if(null==e)return{};var n,r,i={},o=un(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i};var Li=function(e,t){if(null==e)return{};var n,r,i=Ni(e,t);if(_r){var o=_r(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i};var ji=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var Fi=function(e,t){e.prototype=Sr(t.prototype),e.prototype.constructor=e,e.__proto__=t},Di=1e3,Bi=6e4,Ui=60*Bi,Vi=24*Ui,Yi=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*Vi;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Ui;case"minutes":case"minute":case"mins":case"min":case"m":return n*Bi;case"seconds":case"second":case"secs":case"sec":case"s":return n*Di;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===n&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=Vi)return qi(e,t,Vi,"day");if(t>=Ui)return qi(e,t,Ui,"hour");if(t>=Bi)return qi(e,t,Bi,"minute");if(t>=Di)return qi(e,t,Di,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=Vi)return Math.round(e/Vi)+"d";if(t>=Ui)return Math.round(e/Ui)+"h";if(t>=Bi)return Math.round(e/Bi)+"m";if(t>=Di)return Math.round(e/Di)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function qi(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}var zi=function(e){function t(e){for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){var o;function s(){if(s.enabled){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=s,a=Number(new Date),u=a-(o||a);i.diff=u,i.prev=o,i.curr=a,o=a,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var c=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return e;c++;var o=n.formatters[r];if("function"==typeof o){var s=t[c];e=o.call(i,s),t.splice(c,1),c--}return e})),n.formatArgs.call(i,t);var f=i.log||n.log;f.apply(i,t)}}return s.namespace=e,s.enabled=n.enabled(e),s.useColors=n.useColors(),s.color=t(e),s.destroy=r,s.extend=i,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function r(){var e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function i(e,t){return n(this.namespace+(void 0===t?":":t)+e)}return n.debug=n,n.default=n,n.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},n.disable=function(){n.enable("")},n.enable=function(e){var t;n.save(e),n.names=[],n.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(t=0;t<i;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var o=n.instances[t];o.enabled=n.enabled(o.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=Yi,Object.keys(e).forEach((function(t){n[t]=e[t]})),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n},Wi=i((function(e,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":r(console))&&console.log&&(e=console).log.apply(e,arguments)},n.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=function(){var e;try{e=n.storage.getItem("debug")}catch(e){}!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG);return e},n.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage=function(){try{return localStorage}catch(e){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=zi(n),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}));Wi.log,Wi.formatArgs,Wi.save,Wi.load,Wi.useColors,Wi.storage,Wi.colors;var Gi=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},$i=Math.floor,Ji=Math.random;var Zi=function(e,t){return e+$i(Ji()*(t-e+1))};var Ki=function(e,t){var n=-1,r=e.length,i=r-1;for(t=void 0===t?r:t;++n<t;){var o=Zi(n,i),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e};var Xi=function(e){return Ki(Gi(e))};var Hi=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i};var Qi=function(e,t){return Hi(t,(function(t){return e[t]}))};var eo=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},to="object"==typeof r&&r&&r.Object===Object&&r,no="object"==typeof self&&self&&self.Object===Object&&self,ro=to||no||{},io=ro.Symbol,oo=Object.prototype,so=oo.hasOwnProperty,ao=oo.toString,uo=io?io.toStringTag:void 0;var co=function(e){var t=so.call(e,uo),n=e[uo];try{e[uo]=void 0;var r=!0}catch(e){}var i=ao.call(e);return r&&(t?e[uo]=n:delete e[uo]),i},fo=Object.prototype.toString;var lo=function(e){return fo.call(e)},ho=io?io.toStringTag:void 0;var po=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ho&&ho in Object(e)?co(e):lo(e)};var mo=function(e){return null!=e&&"object"==typeof e};var vo=function(e){return mo(e)&&"[object Arguments]"==po(e)},go=Object.prototype,yo=go.hasOwnProperty,bo=go.propertyIsEnumerable,wo=vo(function(){return arguments}())?vo:function(e){return mo(e)&&yo.call(e,"callee")&&!bo.call(e,"callee")},_o=Array.isArray;var Eo=function(){return!1},To=i((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?ro.Buffer:void 0,o=(i?i.isBuffer:void 0)||Eo;e.exports=o})),So=/^(?:0|[1-9]\d*)$/;var Io=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&So.test(e))&&e>-1&&e%1==0&&e<t};var Ao=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},Oo={};Oo["[object Float32Array]"]=Oo["[object Float64Array]"]=Oo["[object Int8Array]"]=Oo["[object Int16Array]"]=Oo["[object Int32Array]"]=Oo["[object Uint8Array]"]=Oo["[object Uint8ClampedArray]"]=Oo["[object Uint16Array]"]=Oo["[object Uint32Array]"]=!0,Oo["[object Arguments]"]=Oo["[object Array]"]=Oo["[object ArrayBuffer]"]=Oo["[object Boolean]"]=Oo["[object DataView]"]=Oo["[object Date]"]=Oo["[object Error]"]=Oo["[object Function]"]=Oo["[object Map]"]=Oo["[object Number]"]=Oo["[object Object]"]=Oo["[object RegExp]"]=Oo["[object Set]"]=Oo["[object String]"]=Oo["[object WeakMap]"]=!1;var Co=function(e){return mo(e)&&Ao(e.length)&&!!Oo[po(e)]};var Mo=function(e){return function(t){return e(t)}},xo=i((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&to.process,o=function(){try{var e=r&&r.require&&r.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o})),ko=xo&&xo.isTypedArray,Po=ko?Mo(ko):Co,Ro=Object.prototype.hasOwnProperty;var No=function(e,t){var n=_o(e),r=!n&&wo(e),i=!n&&!r&&To(e),o=!n&&!r&&!i&&Po(e),s=n||r||i||o,a=s?eo(e.length,String):[],u=a.length;for(var c in e)!t&&!Ro.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Io(c,u))||a.push(c);return a},Lo=Object.prototype;var jo=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Lo)};var Fo=function(e,t){return function(n){return e(t(n))}},Do=Fo(Object.keys,Object),Bo=Object.prototype.hasOwnProperty;var Uo=function(e){if(!jo(e))return Do(e);var t=[];for(var n in Object(e))Bo.call(e,n)&&"constructor"!=n&&t.push(n);return t};var Vo=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var Yo=function(e){if(!Vo(e))return!1;var t=po(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var qo=function(e){return null!=e&&Ao(e.length)&&!Yo(e)};var zo=function(e){return qo(e)?No(e):Uo(e)};var Wo=function(e){return null==e?[]:Qi(e,zo(e))};var Go=function(e){return Ki(Wo(e))};var $o=function(e){return(_o(e)?Xi:Go)(e)};var Jo=function(e){if(P(e))return e};var Zo=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var Ko=function(e){return Jo(e)||Mi(e)||xi(e)||Zo()};function Xo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),xr(e,r.key,r)}}var Ho=function(e,t,n){return t&&Xo(e.prototype,t),n&&Xo(e,n),e};var Qo=function(e,t,n,r,i){var o={};return un(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(e,t,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(xr(e,t,o),o=null),o},es=i((function(e,t){var n;n={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(e,t){var r="string"==typeof e.initial?{state:e.initial}:e.initial,i=e.terminal||e.final,o=t||e.target||{},s=e.events||[],a=e.callbacks||{},u={},c={},f=function(e){var t=Array.isArray(e.from)?e.from:e.from?[e.from]:[n.WILDCARD];u[e.name]=u[e.name]||{};for(var r=0;r<t.length;r++)c[t[r]]=c[t[r]]||[],c[t[r]].push(e.name),u[e.name][t[r]]=e.to||t[r];e.to&&(c[e.to]=c[e.to]||[])};r&&(r.event=r.event||"startup",f({name:r.event,from:"none",to:r.state}));for(var l=0;l<s.length;l++)f(s[l]);for(var h in u)u.hasOwnProperty(h)&&(o[h]=n.buildEvent(h,u[h]));for(var h in a)a.hasOwnProperty(h)&&(o[h]=a[h]);return o.current="none",o.is=function(e){return Array.isArray(e)?e.indexOf(this.current)>=0:this.current===e},o.can=function(e){return!this.transition&&void 0!==u[e]&&(u[e].hasOwnProperty(this.current)||u[e].hasOwnProperty(n.WILDCARD))},o.cannot=function(e){return!this.can(e)},o.transitions=function(){return(c[this.current]||[]).concat(c[n.WILDCARD]||[])},o.isFinished=function(){return this.is(i)},o.error=e.error||function(e,t,n,r,i,o,s){throw s||o},o.states=function(){return Object.keys(c).sort()},r&&!r.defer&&o[r.event](),o},doCallback:function(e,t,r,i,o,s){if(t)try{return t.apply(e,[r,i,o].concat(s))}catch(t){return e.error(r,i,o,s,n.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",t)}},beforeAnyEvent:function(e,t,r,i,o){return n.doCallback(e,e.onbeforeevent,t,r,i,o)},afterAnyEvent:function(e,t,r,i,o){return n.doCallback(e,e.onafterevent||e.onevent,t,r,i,o)},leaveAnyState:function(e,t,r,i,o){return n.doCallback(e,e.onleavestate,t,r,i,o)},enterAnyState:function(e,t,r,i,o){return n.doCallback(e,e.onenterstate||e.onstate,t,r,i,o)},changeState:function(e,t,r,i,o){return n.doCallback(e,e.onchangestate,t,r,i,o)},beforeThisEvent:function(e,t,r,i,o){return n.doCallback(e,e["onbefore"+t],t,r,i,o)},afterThisEvent:function(e,t,r,i,o){return n.doCallback(e,e["onafter"+t]||e["on"+t],t,r,i,o)},leaveThisState:function(e,t,r,i,o){return n.doCallback(e,e["onleave"+r],t,r,i,o)},enterThisState:function(e,t,r,i,o){return n.doCallback(e,e["onenter"+i]||e["on"+i],t,r,i,o)},beforeEvent:function(e,t,r,i,o){if(!1===n.beforeThisEvent(e,t,r,i,o)||!1===n.beforeAnyEvent(e,t,r,i,o))return!1},afterEvent:function(e,t,r,i,o){n.afterThisEvent(e,t,r,i,o),n.afterAnyEvent(e,t,r,i,o)},leaveState:function(e,t,r,i,o){var s=n.leaveThisState(e,t,r,i,o),a=n.leaveAnyState(e,t,r,i,o);return!1!==s&&!1!==a&&(n.ASYNC===s||n.ASYNC===a?n.ASYNC:void 0)},enterState:function(e,t,r,i,o){n.enterThisState(e,t,r,i,o),n.enterAnyState(e,t,r,i,o)},buildEvent:function(e,t){return function(){var r=this.current,i=t[r]||(t[n.WILDCARD]!=n.WILDCARD?t[n.WILDCARD]:r)||r,o=Array.prototype.slice.call(arguments);if(this.transition)return this.error(e,r,i,o,n.Error.PENDING_TRANSITION,"event "+e+" inappropriate because previous transition did not complete");if(this.cannot(e))return this.error(e,r,i,o,n.Error.INVALID_TRANSITION,"event "+e+" inappropriate in current state "+this.current);if(!1===n.beforeEvent(this,e,r,i,o))return n.Result.CANCELLED;if(r===i)return n.afterEvent(this,e,r,i,o),n.Result.NOTRANSITION;var s=this;this.transition=function(){return s.transition=null,s.current=i,n.enterState(s,e,r,i,o),n.changeState(s,e,r,i,o),n.afterEvent(s,e,r,i,o),n.Result.SUCCEEDED},this.transition.cancel=function(){s.transition=null,n.afterEvent(s,e,r,i,o)};var a=n.leaveState(this,e,r,i,o);return!1===a?(this.transition=null,n.Result.CANCELLED):n.ASYNC===a?n.Result.PENDING:this.transition?this.transition():void 0}}},e.exports&&(t=e.exports=n),t.StateMachine=n})),ts=(es.StateMachine,{}),ns=function(e){var t=ts[e];if(void 0===t)throw new Error("".concat(e," adapter is not configured"));return t},rs=function(e){Er(ts,e)},is=Fo(Object.getPrototypeOf,Object),os=n.prototype,ss=Object.prototype,as=os.toString,us=ss.hasOwnProperty,cs=as.call(Object);var fs=function(e){if(!mo(e)||"[object Object]"!=po(e))return!1;var t=is(e);if(null===t)return!0;var n=us.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&as.call(n)==cs},ls="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},hs=en("expired"),ps=Wi("LC:Expirable"),ds=function(){function e(e,t){this.originalValue=e,"number"==typeof t&&(this.expiredAt=cn()+t)}return Ho(e,[{key:"value",get:function(){var e=this.expiredAt&&this.expiredAt<=cn();return e&&ps("expired: ".concat(this.originalValue)),e?hs:this.originalValue}}]),e}();ds.EXPIRED=hs;var ms=Wi("LC:Cache"),vs=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"anonymous";this.name=e,this._map={}}var t=e.prototype;return t.get=function(e){var t=this._map[e];if(t){var n=t.value;if(n!==ds.EXPIRED)return ms("[%s] hit: %s",this.name,e),n;delete this._map[e]}return ms("[".concat(this.name,"] missed: ").concat(e)),null},t.set=function(e,t,n){ms("[%s] set: %s %d",this.name,e,n),this._map[e]=new ds(t,n)},e}();function gs(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function ys(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gs(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):gs(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var bs,ws={enable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LC*";return Wi.enable(e)},disable:Wi.disable},_s=function(e){return function(t){return e(t),t}},Es=function(e){return[function(t){return e(),t},function(t){throw e(),t}]},Ts=function(e){return e?"string"==typeof e||"number"==typeof e?new Date(e):"Date"===e.__type&&e.iso?new Date(e.iso):"function"==typeof e.toNumber?new Date(e.toNumber()):e:e},Ss=function(e){return e&&e.getTime?e.getTime():void 0},Is=function e(t){return t?"Date"===t.__type&&t.iso?new Date(t.iso):P(t)?t.map(e):fs(t)?un(t).reduce((function(n,r){return ys(ys({},n),{},Ur({},r,e(t[r])))}),{}):t:t},As=function e(t){return t instanceof Date?{__type:"Date",iso:t.toJSON()}:P(t)?t.map(e):fs(t)?un(t).reduce((function(n,r){return ys(ys({},n),{},Ur({},r,e(t[r])))}),{}):t},Os=function(e,t){return un(t).reduce((function(n,r){var i=e[r]||r;return Er(n,Ur({},i,t[r]))}),{})},Cs=ls.navigator&&ls.navigator.userAgent&&-1!==ls.navigator.userAgent.indexOf("MSIE 10."),Ms=function e(t,n){return t[n]||(t.__proto__?e(t.__proto__,n):void 0)},xs=function(e,t){return Ai(new Ri([].concat(Pi(e),Pi(t))))},ks=function(e,t){return Ai((n=new Ri(t),new Ri(e.filter((function(e){return!n.has(e)})))));var n},Ps=new Tn,Rs=function(e){return Ps.has(e)||Ps.set(e,{}),Ps.get(e)},Ns=function e(t,n){if(!fs(t))return t;var r=ys({},t);return un(r).forEach((function(t){var i=r[t];i===n?delete r[t]:r[t]=e(i,n)})),r},Ls=function(e){return t=JSON.parse(wi(e)),Ns(t,null);var t},js=function(e){return P(e)?e:null==e?[]:[e]},Fs=function(e,t,n){var r=t.split("."),i=r.pop(),o=e;return r.forEach((function(e){void 0===o[e]&&(o[e]={}),o=o[e]})),o[i]=n,e},Ds="object"===("undefined"==typeof wx?"undefined":tn(wx))&&"function"==typeof wx.connectSocket,Bs=function(e){return function(t,n,r){var i=r.value;if(i.length)throw new Error("throttled function should not accept any arguments");return ys(ys({},r),{},{value:function(){var t=this,r=Rs(this).throttleMeta;r||(r={},Rs(this).throttleMeta=r);var o=r[n];o||(o={},r[n]=o);var s=o,a=s.previouseTimestamp,u=void 0===a?0:a,c=s.timeout,f=cn(),l=e-(f-u);l<=0?(r[n].previouseTimestamp=f,i.apply(this)):c||(o.timeout=setTimeout((function(){o.previouseTimestamp=cn(),delete o.timeout,i.apply(t)}),l))}})}};function Us(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):Us(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var Ys=Wi("LC:WebSocketPlus"),qs="disconnect",zs="reconnect",Ws="retry",Gs="schedule",$s="offline",Js="online",Zs=function(e){return Math.min(1e3*Math.pow(2,e),3e5)},Ks=function(e,t,n){return Vs(Vs({},n),{},{value:function(){var e;this.checkConnectionAvailability(t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=n.value).call.apply(e,[this].concat(i))}})},Xs=(Qo((bs=function(e){function t(t,n){var r;return(r=e.call(this)||this).init(),r._protocol=n,wr.resolve("function"==typeof t?t():t).then(js).then((function(e){return r._urls=e,r._open()})).then((function(){r.__postponeTimeoutTimer=r._postponeTimeoutTimer.bind(ji(r)),ls.addEventListener&&(r.__pause=function(){r.can("pause")&&r.pause()},r.__resume=function(){r.can("resume")&&r.resume()},ls.addEventListener("offline",r.__pause),ls.addEventListener("online",r.__resume)),r.open()})).catch(r.throw.bind(ji(r))),r}Fi(t,e),Ho(t,[{key:"urls",get:function(){return this._urls},set:function(e){this._urls=js(e)}}]);var n=t.prototype;return n._open=function(){var e=this;return this._createWs(this._urls,this._protocol).then((function(t){var n=Ko(e._urls),r=n[0],i=n.slice(1);return e._urls=[].concat(Pi(i),[r]),t}))},n._createWs=function(e,t){var n=this;return function e(t){var n=new wr(t[0]);return 1===t.length?n:n.catch((function(){return e(t.slice(1))}))}(e.map((function(e){return function(r,i){Ys("connect [".concat(e,"] ").concat(t));var o=ns("WebSocket"),s=t?new o(e,t):new o(e);s.binaryType=n.binaryType||"arraybuffer",s.onopen=function(){return r(s)},s.onclose=function(t){return t instanceof Error?i(t):i(new Error("Failed to connect [".concat(e,"]")))},s.onerror=s.onclose}}))).then((function(e){return n._ws=e,n._ws.onclose=n._handleClose.bind(n),n._ws.onmessage=n._handleMessage.bind(n),e}))},n._destroyWs=function(){var e=this._ws;e&&(e.onopen=null,e.onclose=null,e.onerror=null,e.onmessage=null,this._ws=null,e.close())},n.onbeforeevent=function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];Ys("".concat(e,": ").concat(t," -> ").concat(n," %o"),i)},n.onopen=function(){this.emit("open")},n.onconnected=function(){this._startConnectionKeeper()},n.onleaveconnected=function(e,t,n){this._stopConnectionKeeper(),this._destroyWs(),"offline"!==n&&"disconnected"!==n||this.emit(qs)},n.onpause=function(){this.emit($s)},n.onbeforeresume=function(){this.emit(Js)},n.onreconnect=function(){this.emit(zs)},n.ondisconnected=function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t===$s?0:Zs.call(null,i);Ys("schedule attempt=".concat(i," delay=").concat(o)),this.emit(Gs,i,o),this.__scheduledRetry&&clearTimeout(this.__scheduledRetry),this.__scheduledRetry=setTimeout((function(){r.is("disconnected")&&r.retry(i)}),o)},n.onretry=function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.emit(Ws,i),this._open().then((function(){return r.can("reconnect")?r.reconnect():r._destroyWs()}),(function(){return r.can("fail")&&r.fail(i+1)}))},n.onerror=function(e,t,n,r){this.emit("error",r)},n.onclose=function(){ls.removeEventListener&&(this.__pause&&ls.removeEventListener("offline",this.__pause),this.__resume&&ls.removeEventListener("online",this.__resume))},n.checkConnectionAvailability=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"API";if(!this.is("connected")){var t=this.current;throw console.warn("".concat(e," should not be called when the connection is ").concat(t)),(this.is("disconnected")||this.is("reconnecting"))&&console.warn("disconnect and reconnect event should be handled to avoid such calls."),new Error("Connection unavailable")}},n._ping=function(){Ys("ping");try{this.ping()}catch(e){console.warn("websocket ping error: ".concat(e.message))}},n.ping=function(){this._ws.ping?this._ws.ping():console.warn("The WebSocket implement does not support sending ping frame.\n        Override ping method to use application defined ping/pong mechanism.")},n._postponeTimeoutTimer=function(){var e=this;Ys("_postponeTimeoutTimer"),this._clearTimeoutTimers(),this._timeoutTimer=setTimeout((function(){Ys("timeout"),e.disconnect()}),38e4)},n._clearTimeoutTimers=function(){this._timeoutTimer&&clearTimeout(this._timeoutTimer)},n._startConnectionKeeper=function(){Ys("start connection keeper"),this._heartbeatTimer=setInterval(this._ping.bind(this),18e4);var e=this._ws.addListener||this._ws.addEventListener;e?(e.call(this._ws,"message",this.__postponeTimeoutTimer),e.call(this._ws,"pong",this.__postponeTimeoutTimer),this._postponeTimeoutTimer()):Ys("connection keeper disabled due to the lack of #addEventListener.")},n._stopConnectionKeeper=function(){Ys("stop connection keeper");var e=this._ws.removeListener||this._ws.removeEventListener;e&&(e.call(this._ws,"message",this.__postponeTimeoutTimer),e.call(this._ws,"pong",this.__postponeTimeoutTimer),this._clearTimeoutTimers()),this._heartbeatTimer&&clearInterval(this._heartbeatTimer)},n._handleClose=function(e){Ys("ws closed [".concat(e.code,"] ").concat(e.reason)),this.isFinished()||this.handleClose(e)},n.handleClose=function(){this.disconnect()},n.send=function(e){Ys("send",e),this._ws.send(e)},n._handleMessage=function(e){Ys("message",e.data),this.handleMessage(e.data)},n.handleMessage=function(e){this.emit("message",e)},t}(yi)).prototype,"_ping",[Ks],an(bs.prototype,"_ping"),bs.prototype),Qo(bs.prototype,"send",[Ks],an(bs.prototype,"send"),bs.prototype),bs);es.create({target:Xs.prototype,initial:{state:"initialized",event:"init",defer:!0},terminal:"closed",events:[{name:"open",from:"initialized",to:"connected"},{name:"disconnect",from:"connected",to:"disconnected"},{name:"retry",from:"disconnected",to:"reconnecting"},{name:"fail",from:"reconnecting",to:"disconnected"},{name:"reconnect",from:"reconnecting",to:"connected"},{name:"pause",from:["connected","disconnected","reconnecting"],to:"offline"},{},{name:"resume",from:"offline",to:"disconnected"},{name:"close",from:["connected","disconnected","reconnecting","offline"],to:"closed"},{name:"throw",from:"*",to:"error"}]});var Hs=$e.onFreeze;nn("freeze",(function(e){return function(t){return e&&l(t)?e(Hs(t)):t}}));var Qs=u.Object.freeze,ea=Qs({1e3:{name:"CLOSE_NORMAL"},1006:{name:"CLOSE_ABNORMAL"},4100:{name:"APP_NOT_AVAILABLE",message:"App not exists or realtime message service is disabled."},4102:{name:"SIGNATURE_FAILED",message:"Login signature mismatch."},4103:{name:"INVALID_LOGIN",message:"Malformed clientId."},4105:{name:"SESSION_REQUIRED",message:"Message sent before session opened."},4107:{name:"READ_TIMEOUT"},4108:{name:"LOGIN_TIMEOUT"},4109:{name:"FRAME_TOO_LONG"},4110:{name:"INVALID_ORIGIN",message:"Access denied by domain whitelist."},4111:{name:"SESSION_CONFLICT"},4112:{name:"SESSION_TOKEN_EXPIRED"},4113:{name:"APP_QUOTA_EXCEEDED",message:"The daily active users limit exceeded."},4116:{name:"MESSAGE_SENT_QUOTA_EXCEEDED",message:"Command sent too fast."},4200:{name:"INTERNAL_ERROR",message:"Internal error, please contact LeanCloud for support."},4301:{name:"CONVERSATION_API_FAILED",message:"Upstream Conversatoin API failed, see error.detail for details."},4302:{name:"CONVERSATION_SIGNATURE_FAILED",message:"Conversation action signature mismatch."},4303:{name:"CONVERSATION_NOT_FOUND"},4304:{name:"CONVERSATION_FULL"},4305:{name:"CONVERSATION_REJECTED_BY_APP",message:"Conversation action rejected by hook."},4306:{name:"CONVERSATION_UPDATE_FAILED"},4307:{name:"CONVERSATION_READ_ONLY"},4308:{name:"CONVERSATION_NOT_ALLOWED"},4309:{name:"CONVERSATION_UPDATE_REJECTED",message:"Conversation update rejected because the client is not a member."},4310:{name:"CONVERSATION_QUERY_FAILED",message:"Conversation query failed because it is too expansive."},4311:{name:"CONVERSATION_LOG_FAILED"},4312:{name:"CONVERSATION_LOG_REJECTED",message:"Message query rejected because the client is not a member of the conversation."},4313:{name:"SYSTEM_CONVERSATION_REQUIRED"},4314:{name:"NORMAL_CONVERSATION_REQUIRED"},4315:{name:"CONVERSATION_BLACKLISTED",message:"Blacklisted in the conversation."},4316:{name:"TRANSIENT_CONVERSATION_REQUIRED"},4317:{name:"CONVERSATION_MEMBERSHIP_REQUIRED"},4318:{name:"CONVERSATION_API_QUOTA_EXCEEDED",message:"LeanCloud API quota exceeded. You may upgrade your plan."},4323:{name:"TEMPORARY_CONVERSATION_EXPIRED",message:"Temporary conversation expired or does not exist."},4401:{name:"INVALID_MESSAGING_TARGET",message:"Conversation does not exist or client is not a member."},4402:{name:"MESSAGE_REJECTED_BY_APP",message:"Message rejected by hook."},4403:{name:"MESSAGE_OWNERSHIP_REQUIRED"},4404:{name:"MESSAGE_NOT_FOUND"},4405:{name:"MESSAGE_UPDATE_REJECTED_BY_APP",message:"Message update rejected by hook."},4406:{name:"MESSAGE_EDIT_DISABLED"},4407:{name:"MESSAGE_RECALL_DISABLED"},5130:{name:"OWNER_PROMOTION_NOT_ALLOWED",message:"Updating a member's role to owner is not allowed."}}),ta=Qs(un(ea).reduce((function(e,t){return Er(e,Ur({},ea[t].name,Number(t)))}),{})),na=function(e){var t=e.code,n=e.reason,r=e.appCode,i=e.detail,o=e.error,s=n||i||o,a=n;!s&&ea[t]&&(a=ea[t].name,s=ea[t].message||a),s||(s="Unknow Error: ".concat(t));var u=new Error(s);return Er(u,{code:t,appCode:r,detail:i,name:a})},ra=Wi("LC:Connection"),ia=en("expire"),oa=function(e){function t(t,n){var r,i=n.format,o=n.version;ra("initializing Connection");var s="lc.".concat(i,".").concat(o);return(r=e.call(this,t,s)||this)._protocolFormat=i,r._commands={},r._serialId=0,r}Fi(t,e);var n=t.prototype;return n.send=function(){var t=Ti(_i.mark((function t(n){var r,i,o,s=this,a=arguments;return _i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=!(a.length>1&&void 0!==a[1])||a[1])&&(this._serialId+=1,i=this._serialId,n.i=i),ra.enabled&&ra("â %O sent",Ls(n)),"proto2base64"===this._protocolFormat?o=n.toBase64():n.toArrayBuffer&&(o=n.toArrayBuffer()),o){t.next=6;break}throw new TypeError("".concat(n," is not a GenericCommand"));case 6:if(e.prototype.send.call(this,o),r){t.next=9;break}return t.abrupt("return",void 0);case 9:return t.abrupt("return",new wr((function(e,t){s._commands[i]={resolve:e,reject:t,timeout:setTimeout((function(){s._commands[i]&&(ra.enabled&&ra("â %O timeout",Ls(n)),t(na({error:"Command Timeout [cmd:".concat(n.cmd," op:").concat(n.op,"]"),name:"COMMAND_TIMEOUT"})),delete s._commands[i])}),2e4)}})));case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),n.handleMessage=function(e){var t;try{t=ci.decode(e),ra.enabled&&ra("â %O received",Ls(t))}catch(t){return void console.warn("Decode message failed:",t.message,e)}var n=t.i;if(n)this._commands[n]?(clearTimeout(this._commands[n].timeout),t.cmd===di.error?this._commands[n].reject(na(t.errorMessage)):this._commands[n].resolve(t),delete this._commands[n]):console.warn("Unexpected command received with serialId [".concat(n,"],\n         which have timed out or never been requested."));else switch(t.cmd){case di.error:return void this.emit("error",na(t.errorMessage));case di.goaway:return void this.emit(ia);default:this.emit("message",t)}},n.ping=function(){return this.send(new ci({cmd:di.echo})).catch((function(e){return ra("ping failed:",e)}))},t}(Xs),sa=i((function(e){var t;e.exports.timeout=function(e,n){var r,i=new t;return wr.race([e,new wr((function(e,t){r=setTimeout((function(){t(i)}),n)}))]).then((function(e){return clearTimeout(r),e}),(function(e){throw clearTimeout(r),e}))};(t=e.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"}).prototype=Sr(Error.prototype),t.prototype.name="TimeoutError"})),aa=sa.timeout,ua=(sa.TimeoutError,Wi("LC:request")),ca=function(e){var t=e.method,n=void 0===t?"GET":t,r=e.url,i=e.query,o=e.headers,s=e.data,a=e.timeout,u=r;if(i){var c=un(i).map((function(e){var t=i[e];if(void 0!==t){var n=fs(t)?wi(t):t;return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(n))}})).filter((function(e){return e})).join("&");u="".concat(u,"?").concat(c)}ua("Req: %O %O %O",n,u,{headers:o,data:s});var f=ns("request")(u,{method:n,headers:o,data:s}).then((function(e){if(!1===e.ok){var t=na(e.data);throw t.response=e,t}return ua("Res: %O %O %O",u,e.status,e.data),e.data})).catch((function(e){throw e.response&&ua("Error: %O %O %O",u,e.response.status,e.response.data),e}));return a?aa(f,a):f},fa=function(e,t){e&&e.forEach((function(e){try{e(t)}catch(t){throw e._pluginName&&(t.message+="[".concat(e._pluginName,"]")),t}}))},la=function(e){return function(t){return js(e).reduce((function(e,t){return e.then(function(e){return function(t){var n=t.constructor;return wr.resolve(t).then(e).then(_s((function(r){return null==r?console.warn("Middleware[".concat(e._pluginName||"anonymous plugin",":").concat(e.name||"anonymous middleware","] param/return types not match. It returns ").concat(r," while a ").concat(t.constructor.name," expected.")):r instanceof n?0:console.warn("Middleware[".concat(e._pluginName||"anonymous plugin",":").concat(e.name||"anonymous middleware","] param/return types not match. It returns a ").concat(r.constructor.name," while a ").concat(t.constructor.name," expected."))})))}}(t)).catch((function(e){throw t._pluginName&&(e.message+="[".concat(t._pluginName,"]")),e}))}),wr.resolve(t))}},ha=function(e,t){return js(e).reduce((function(e,n){return e.then((function(e){return!1!==e&&n.apply(void 0,Pi(t))})).catch((function(e){throw n._pluginName&&(e.message+="[".concat(n._pluginName,"]")),e}))}),wr.resolve(!0))};function pa(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function da(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):pa(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}for(var ma=Wi("LC:Realtime"),va=new vs("push-router"),ga={},ya=function(e){function n(r){var i,o=r.plugins,s=Li(r,["plugins"]);ma("initializing Realtime %s %O","5.0.0-rc.3",s),i=e.call(this)||this;var a=s.appId;if("string"!=typeof a)throw new TypeError("appId [".concat(a,"] is not a string"));if(ga[a])throw new Error("App [".concat(a,"] is aleady initialized."));if(ga[a]=!0,"string"!=typeof s.appKey)throw new TypeError("appKey [".concat(s.appKey,"] is not a string"));if(function(e){return"-MdYXbMMI"!==e.slice(-9)}(a)&&!s.server)throw new TypeError("server option is required for apps from CN region");i._options=da({appId:void 0,appKey:void 0,pushOfflineMessages:!1,noBinary:!1,ssl:!0,RTMServerName:void 0!==t?t.env.RTM_SERVER_NAME:void 0},s),i._cache=new vs("endpoints");var u=Rs(ji(i));u.clients=new Ri,u.pendingClients=new Ri;var c=[].concat(Pi(js(n.__preRegisteredPlugins)),Pi(js(o)));return ma("Using plugins %o",c.map((function(e){return e.name}))),i._plugins=c.reduce((function(e,t){return un(t).forEach((function(n){({}).hasOwnProperty.call(t,n)&&"name"!==n&&(t.name&&js(t[n]).forEach((function(e){e._pluginName=t.name})),e[n]=js(e[n]).concat(t[n]))})),e}),{}),fa(i._plugins.onRealtimeCreate,ji(i)),i}Fi(n,e);var r=n.prototype;return r._request=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a,u,c,f,l,h,p,d,m;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.method,r=t.url,i=t.version,o=void 0===i?"1.1":i,s=t.path,a=t.query,u=t.headers,c=t.data,f=r){e.next=9;break}return l=this._options,h=l.appId,p=l.server,e.next=6,this.constructor._getServerUrls({appId:h,server:p});case 6:d=e.sent,m=d.api,f="".concat(m,"/").concat(o).concat(s);case 9:return e.abrupt("return",ca({url:f,method:n,query:a,headers:da({"X-LC-Id":this._options.appId,"X-LC-Key":this._options.appKey},u),data:c}));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r._open=function(){var e=this;if(this._openPromise)return this._openPromise;var t="protobuf2";this._options.noBinary&&(t="proto2base64");var n=3;this._options.pushOfflineMessages&&(n=1);var r={format:t,version:n};return this._openPromise=new wr((function(t,n){ma("No connection established, create a new one.");var i=new oa((function(){return e._getRTMServers(e._options)}),r);i.on("open",(function(){return t(i)})).on("error",n).on(ia,Ti(_i.mark((function t(){return _i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ma("Connection expired. Refresh endpoints."),e._cache.set("endpoints",null,0),t.next=4,e._getRTMServers(e._options);case 4:i.urls=t.sent,i.disconnect();case 6:case"end":return t.stop()}}),t)})))).on("message",e._dispatchCommand.bind(e)),[qs,zs,Ws,Gs,$s,Js].forEach((function(t){return i.on(t,(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];ma("".concat(t," event emitted. %o"),r),e.emit.apply(e,[t].concat(r)),t!==zs&&Rs(e).clients.forEach((function(e){e.emit.apply(e,[t].concat(r))}))}))})),i.handleClose=function(e){[ta.APP_NOT_AVAILABLE,ta.INVALID_LOGIN,ta.INVALID_ORIGIN].some((function(t){return t===e.code}))?this.throw(na(e)):this.disconnect()},Rs(e).connection=i})),this._openPromise},r._getRTMServers=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.RTMServers){e.next=2;break}return e.abrupt("return",$o(js(t.RTMServers)));case 2:if(!(r=this._cache.get("endpoints"))){e.next=7;break}n=r,e.next=14;break;case 7:return e.next=9,this.constructor._fetchRTMServers(t);case 9:if(n=e.sent,o=(i=n).server,s=i.secondary,a=i.ttl,"string"==typeof o||"string"==typeof s||"number"==typeof a){e.next=13;break}throw new Error("malformed RTM route response: ".concat(wi(n)));case 13:this._cache.set("endpoints",n,1e3*n.ttl);case 14:return ma("endpoint info: %O",n),e.abrupt("return",[n.server,n.secondary]);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._getServerUrls=function(){var e=Ti(_i.mark((function e(t){var n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.appId,r=t.server,ma("fetch server urls"),!r){e.next=6;break}if("string"==typeof r){e.next=5;break}return e.abrupt("return",r);case 5:return e.abrupt("return",{RTMRouter:r,api:r});case 6:if(!(i=va.get(n))){e.next=9;break}return e.abrupt("return",i);case 9:return"https://",e.abrupt("return",ca({url:"https://app-router.com/2/route",query:{appId:n},timeout:2e4}).then(_s(ma)).then((function(e){var t=e.rtm_router_server,r=e.api_server,i=e.ttl,o=void 0===i?3600:i;if(!t)throw new Error("rtm router not exists");var s={RTMRouter:"".concat("https://").concat(t),api:"".concat("https://").concat(r)};return va.set(n,s,1e3*o),s})).catch((function(){var e=n.slice(0,8).toLowerCase();return{RTMRouter:"".concat("https://").concat(e,".rtm.").concat("lncldglobal.com"),api:"".concat("https://").concat(e,".api.").concat("lncldglobal.com")}})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n._fetchRTMServers=function(e){var t=e.appId,n=e.ssl,r=e.server,i=e.RTMServerName;return ma("fetch endpoint info"),this._getServerUrls({appId:t,server:r}).then(_s(ma)).then((function(e){var r=e.RTMRouter;return ca({url:"".concat(r,"/v1/route"),query:{appId:t,secure:n,features:Ds?"wechat":void 0,server:i,_t:cn()},timeout:2e4}).then(_s(ma))}))},r._close=function(){this._openPromise&&this._openPromise.then((function(e){return e.close()})),delete this._openPromise},r.retry=function(){var e=Rs(this).connection;if(!e)throw new Error("no connection established");if(e.cannot("retry"))throw new Error("retrying not allowed when not disconnected. the connection is now ".concat(e.current));return e.retry()},r.pause=function(){var e=Rs(this).connection;e&&e.can("pause")&&e.pause()},r.resume=function(){var e=Rs(this).connection;e&&e.can("resume")&&e.resume()},r._registerPending=function(e){Rs(this).pendingClients.add(e)},r._deregisterPending=function(e){Rs(this).pendingClients.delete(e)},r._register=function(e){Rs(this).clients.add(e)},r._deregister=function(e){var t=Rs(this);t.clients.delete(e),t.clients.size+t.pendingClients.size===0&&this._close()},r._dispatchCommand=function(e){return ha(this._plugins.beforeCommandDispatch,[e,this]).then((function(t){return!!t&&ma("[WARN] Unexpected message received: %O",Ls(e))}))},n}(yi),ba=wr,wa=i((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}})),_a=[],Ea=0;Ea<256;++Ea)_a[Ea]=(Ea+256).toString(16).substr(1);var Ta=function(e,t){var n=t||0,r=_a;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")};var Sa=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||wa)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||Ta(i)},Ia=u.getIterator=function(e){var t=qe(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return h(t.call(e))};var Aa=function(e,t){if(void 0!==en&&Ci(Object(e))){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=Ia(e);!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}};var Oa=function(e,t){return Jo(e)||Aa(e,t)||xi(e,t)||Zo()},Ca=i((function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,s,a=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var f=new ArrayBuffer(a),l=new Uint8Array(f);for(t=0;t<u;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],l[c++]=r<<2|i>>4,l[c++]=(15&i)<<4|o>>2,l[c++]=(3&o)<<6|63&s;return f}}()})),Ma=Ca.encode,xa=Ca.decode;var ka=function(){this.__data__=[],this.size=0};var Pa=function(e,t){return e===t||e!=e&&t!=t};var Ra=function(e,t){for(var n=e.length;n--;)if(Pa(e[n][0],t))return n;return-1},Na=Array.prototype.splice;var La=function(e){var t=this.__data__,n=Ra(t,e);return!(n<0)&&(n==t.length-1?t.pop():Na.call(t,n,1),--this.size,!0)};var ja=function(e){var t=this.__data__,n=Ra(t,e);return n<0?void 0:t[n][1]};var Fa=function(e){return Ra(this.__data__,e)>-1};var Da=function(e,t){var n=this.__data__,r=Ra(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function Ba(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ba.prototype.clear=ka,Ba.prototype.delete=La,Ba.prototype.get=ja,Ba.prototype.has=Fa,Ba.prototype.set=Da;var Ua=Ba;var Va=function(){this.__data__=new Ua,this.size=0};var Ya=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var qa=function(e){return this.__data__.get(e)};var za,Wa=function(e){return this.__data__.has(e)},Ga=ro["__core-js_shared__"],$a=(za=/[^.]+$/.exec(Ga&&Ga.keys&&Ga.keys.IE_PROTO||""))?"Symbol(src)_1."+za:"";var Ja=function(e){return!!$a&&$a in e},Za=n.prototype.toString;var Ka=function(e){if(null!=e){try{return Za.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Xa=/^\[object .+?Constructor\]$/,Ha=n.prototype,Qa=Object.prototype,eu=Ha.toString,tu=Qa.hasOwnProperty,nu=RegExp("^"+eu.call(tu).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ru=function(e){return!(!Vo(e)||Ja(e))&&(Yo(e)?nu:Xa).test(Ka(e))};var iu=function(e,t){return null==e?void 0:e[t]};var ou=function(e,t){var n=iu(e,t);return ru(n)?n:void 0},su=ou(ro,"Map"),au=ou(Object,"create");var uu=function(){this.__data__=au?au(null):{},this.size=0};var cu=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},fu=Object.prototype.hasOwnProperty;var lu=function(e){var t=this.__data__;if(au){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return fu.call(t,e)?t[e]:void 0},hu=Object.prototype.hasOwnProperty;var pu=function(e){var t=this.__data__;return au?void 0!==t[e]:hu.call(t,e)};var du=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=au&&void 0===t?"__lodash_hash_undefined__":t,this};function mu(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}mu.prototype.clear=uu,mu.prototype.delete=cu,mu.prototype.get=lu,mu.prototype.has=pu,mu.prototype.set=du;var vu=mu;var gu=function(){this.size=0,this.__data__={hash:new vu,map:new(su||Ua),string:new vu}};var yu=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var bu=function(e,t){var n=e.__data__;return yu(t)?n["string"==typeof t?"string":"hash"]:n.map};var wu=function(e){var t=bu(this,e).delete(e);return this.size-=t?1:0,t};var _u=function(e){return bu(this,e).get(e)};var Eu=function(e){return bu(this,e).has(e)};var Tu=function(e,t){var n=bu(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function Su(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Su.prototype.clear=gu,Su.prototype.delete=wu,Su.prototype.get=_u,Su.prototype.has=Eu,Su.prototype.set=Tu;var Iu=Su;var Au=function(e,t){var n=this.__data__;if(n instanceof Ua){var r=n.__data__;if(!su||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Iu(r)}return n.set(e,t),this.size=n.size,this};function Ou(e){var t=this.__data__=new Ua(e);this.size=t.size}Ou.prototype.clear=Va,Ou.prototype.delete=Ya,Ou.prototype.get=qa,Ou.prototype.has=Wa,Ou.prototype.set=Au;var Cu=Ou;var Mu=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var xu=function(e){return this.__data__.has(e)};function ku(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Iu;++t<n;)this.add(e[t])}ku.prototype.add=ku.prototype.push=Mu,ku.prototype.has=xu;var Pu=ku;var Ru=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};var Nu=function(e,t){return e.has(t)};var Lu=function(e,t,n,r,i,o){var s=1&n,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var f=-1,l=!0,h=2&n?new Pu:void 0;for(o.set(e,t),o.set(t,e);++f<a;){var p=e[f],d=t[f];if(r)var m=s?r(d,p,f,t,e,o):r(p,d,f,e,t,o);if(void 0!==m){if(m)continue;l=!1;break}if(h){if(!Ru(t,(function(e,t){if(!Nu(h,t)&&(p===e||i(p,e,n,r,o)))return h.push(t)}))){l=!1;break}}else if(p!==d&&!i(p,d,n,r,o)){l=!1;break}}return o.delete(e),o.delete(t),l},ju=ro.Uint8Array;var Fu=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n};var Du=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},Bu=io?io.prototype:void 0,Uu=Bu?Bu.valueOf:void 0;var Vu=function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new ju(e),new ju(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Pa(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=Fu;case"[object Set]":var u=1&r;if(a||(a=Du),e.size!=t.size&&!u)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var f=Lu(a(e),a(t),r,i,o,s);return s.delete(e),f;case"[object Symbol]":if(Uu)return Uu.call(e)==Uu.call(t)}return!1};var Yu=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e};var qu=function(e,t,n){var r=t(e);return _o(e)?r:Yu(r,n(e))};var zu=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o};var Wu=function(){return[]},Gu=Object.prototype.propertyIsEnumerable,$u=Object.getOwnPropertySymbols,Ju=$u?function(e){return null==e?[]:(e=Object(e),zu($u(e),(function(t){return Gu.call(e,t)})))}:Wu;var Zu=function(e){return qu(e,zo,Ju)},Ku=Object.prototype.hasOwnProperty;var Xu=function(e,t,n,r,i,o){var s=1&n,a=Zu(e),u=a.length;if(u!=Zu(t).length&&!s)return!1;for(var c=u;c--;){var f=a[c];if(!(s?f in t:Ku.call(t,f)))return!1}var l=o.get(e);if(l&&o.get(t))return l==t;var h=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<u;){var d=e[f=a[c]],m=t[f];if(r)var v=s?r(m,d,f,t,e,o):r(d,m,f,e,t,o);if(!(void 0===v?d===m||i(d,m,n,r,o):v)){h=!1;break}p||(p="constructor"==f)}if(h&&!p){var g=e.constructor,y=t.constructor;g==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y||(h=!1)}return o.delete(e),o.delete(t),h},Hu=ou(ro,"DataView"),Qu=ou(ro,"Promise"),ec=ou(ro,"Set"),tc=ou(ro,"WeakMap"),nc=Ka(Hu),rc=Ka(su),ic=Ka(Qu),oc=Ka(ec),sc=Ka(tc),ac=po;(Hu&&"[object DataView]"!=ac(new Hu(new ArrayBuffer(1)))||su&&"[object Map]"!=ac(new su)||Qu&&"[object Promise]"!=ac(Qu.resolve())||ec&&"[object Set]"!=ac(new ec)||tc&&"[object WeakMap]"!=ac(new tc))&&(ac=function(e){var t=po(e),n="[object Object]"==t?e.constructor:void 0,r=n?Ka(n):"";if(r)switch(r){case nc:return"[object DataView]";case rc:return"[object Map]";case ic:return"[object Promise]";case oc:return"[object Set]";case sc:return"[object WeakMap]"}return t});var uc=ac,cc=Object.prototype.hasOwnProperty;var fc=function(e,t,n,r,i,o){var s=_o(e),a=_o(t),u=s?"[object Array]":uc(e),c=a?"[object Array]":uc(t),f="[object Object]"==(u="[object Arguments]"==u?"[object Object]":u),l="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),h=u==c;if(h&&To(e)){if(!To(t))return!1;s=!0,f=!1}if(h&&!f)return o||(o=new Cu),s||Po(e)?Lu(e,t,n,r,i,o):Vu(e,t,u,n,r,i,o);if(!(1&n)){var p=f&&cc.call(e,"__wrapped__"),d=l&&cc.call(t,"__wrapped__");if(p||d){var m=p?e.value():e,v=d?t.value():t;return o||(o=new Cu),i(m,v,n,r,o)}}return!!h&&(o||(o=new Cu),Xu(e,t,n,r,i,o))};var lc=function e(t,n,r,i,o){return t===n||(null==t||null==n||!mo(t)&&!mo(n)?t!=t&&n!=n:fc(t,n,r,i,e,o))};var hc=function(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=Object(e);i--;){var a=n[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var u=(a=n[i])[0],c=e[u],f=a[1];if(s&&a[2]){if(void 0===c&&!(u in e))return!1}else{var l=new Cu;if(r)var h=r(c,f,u,e,t,l);if(!(void 0===h?lc(f,c,3,r,l):h))return!1}}return!0};var pc=function(e){return e==e&&!Vo(e)};var dc=function(e){for(var t=zo(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,pc(i)]}return t};var mc=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};var vc=function(e){var t=dc(e);return 1==t.length&&t[0][2]?mc(t[0][0],t[0][1]):function(n){return n===e||hc(n,e,t)}};var gc=function(e){return"symbol"==typeof e||mo(e)&&"[object Symbol]"==po(e)},yc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bc=/^\w*$/;var wc=function(e,t){if(_o(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!gc(e))||(bc.test(e)||!yc.test(e)||null!=t&&e in Object(t))};function _c(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(_c.Cache||Iu),n}_c.Cache=Iu;var Ec=_c;var Tc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sc=/\\(\\)?/g,Ic=function(e){var t=Ec(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Tc,(function(e,n,r,i){t.push(r?i.replace(Sc,"$1"):n||e)})),t})),Ac=io?io.prototype:void 0,Oc=Ac?Ac.toString:void 0;var Cc=function e(t){if("string"==typeof t)return t;if(_o(t))return Hi(t,e)+"";if(gc(t))return Oc?Oc.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var Mc=function(e){return null==e?"":Cc(e)};var xc=function(e,t){return _o(e)?e:wc(e,t)?[e]:Ic(Mc(e))};var kc=function(e){if("string"==typeof e||gc(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var Pc=function(e,t){for(var n=0,r=(t=xc(t,e)).length;null!=e&&n<r;)e=e[kc(t[n++])];return n&&n==r?e:void 0};var Rc=function(e,t,n){var r=null==e?void 0:Pc(e,t);return void 0===r?n:r};var Nc=function(e,t){return null!=e&&t in Object(e)};var Lc=function(e,t,n){for(var r=-1,i=(t=xc(t,e)).length,o=!1;++r<i;){var s=kc(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Ao(i)&&Io(s,i)&&(_o(e)||wo(e))};var jc=function(e,t){return null!=e&&Lc(e,t,Nc)};var Fc=function(e,t){return wc(e)&&pc(t)?mc(kc(e),t):function(n){var r=Rc(n,e);return void 0===r&&r===t?jc(n,e):lc(t,r,3)}};var Dc=function(e){return e};var Bc=function(e){return function(t){return null==t?void 0:t[e]}};var Uc=function(e){return function(t){return Pc(t,e)}};var Vc=function(e){return wc(e)?Bc(kc(e)):Uc(e)};var Yc=function(e){return"function"==typeof e?e:null==e?Dc:"object"==typeof e?_o(e)?Fc(e[0],e[1]):vc(e):Vc(e)};var qc=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var zc=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o};var Wc=function(e,t){return t.length<2?e:Pc(e,zc(t,0,-1))};var Gc=function(e,t){return t=xc(t,e),null==(e=Wc(e,t))||delete e[kc(qc(t))]},$c=Array.prototype.splice;var Jc=function(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;Io(i)?$c.call(e,i,1):Gc(e,i)}}return e};var Zc=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=Yc(t);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Jc(e,i),n},Kc=Object.prototype.hasOwnProperty;var Xc=function(e){if(null==e)return!0;if(qo(e)&&(_o(e)||"string"==typeof e||"function"==typeof e.splice||To(e)||Po(e)||wo(e)))return!e.length;var t=uc(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(jo(e))return!Uo(e).length;for(var n in e)if(Kc.call(e,n))return!1;return!0};var Hc=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e},Qc=function(){try{var e=ou(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var ef=function(e,t,n){"__proto__"==t&&Qc?Qc(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},tf=Object.prototype.hasOwnProperty;var nf=function(e,t,n){var r=e[t];tf.call(e,t)&&Pa(r,n)&&(void 0!==n||t in e)||ef(e,t,n)};var rf=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],u=r?r(n[a],e[a],a,n,e):void 0;void 0===u&&(u=e[a]),i?ef(n,a,u):nf(n,a,u)}return n};var of=function(e,t){return e&&rf(t,zo(t),e)};var sf=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},af=Object.prototype.hasOwnProperty;var uf=function(e){if(!Vo(e))return sf(e);var t=jo(e),n=[];for(var r in e)("constructor"!=r||!t&&af.call(e,r))&&n.push(r);return n};var cf=function(e){return qo(e)?No(e,!0):uf(e)};var ff=function(e,t){return e&&rf(t,cf(t),e)},lf=i((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?ro.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=o?o(n):new e.constructor(n);return e.copy(r),r}}));var hf=function(e,t){return rf(e,Ju(e),t)},pf=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Yu(t,Ju(e)),e=is(e);return t}:Wu;var df=function(e,t){return rf(e,pf(e),t)};var mf=function(e){return qu(e,cf,pf)},vf=Object.prototype.hasOwnProperty;var gf=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&vf.call(e,"index")&&(n.index=e.index,n.input=e.input),n};var yf=function(e){var t=new e.constructor(e.byteLength);return new ju(t).set(new ju(e)),t};var bf=function(e,t){var n=t?yf(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},wf=/\w*$/;var _f=function(e){var t=new e.constructor(e.source,wf.exec(e));return t.lastIndex=e.lastIndex,t},Ef=io?io.prototype:void 0,Tf=Ef?Ef.valueOf:void 0;var Sf=function(e){return Tf?Object(Tf.call(e)):{}};var If=function(e,t){var n=t?yf(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Af=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return yf(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return bf(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return If(e,n);case"[object Map]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return _f(e);case"[object Set]":return new r;case"[object Symbol]":return Sf(e)}},Of=Object.create,Cf=function(){function e(){}return function(t){if(!Vo(t))return{};if(Of)return Of(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var Mf=function(e){return"function"!=typeof e.constructor||jo(e)?{}:Cf(is(e))};var xf=function(e){return mo(e)&&"[object Map]"==uc(e)},kf=xo&&xo.isMap,Pf=kf?Mo(kf):xf;var Rf=function(e){return mo(e)&&"[object Set]"==uc(e)},Nf=xo&&xo.isSet,Lf=Nf?Mo(Nf):Rf,jf={};jf["[object Arguments]"]=jf["[object Array]"]=jf["[object ArrayBuffer]"]=jf["[object DataView]"]=jf["[object Boolean]"]=jf["[object Date]"]=jf["[object Float32Array]"]=jf["[object Float64Array]"]=jf["[object Int8Array]"]=jf["[object Int16Array]"]=jf["[object Int32Array]"]=jf["[object Map]"]=jf["[object Number]"]=jf["[object Object]"]=jf["[object RegExp]"]=jf["[object Set]"]=jf["[object String]"]=jf["[object Symbol]"]=jf["[object Uint8Array]"]=jf["[object Uint8ClampedArray]"]=jf["[object Uint16Array]"]=jf["[object Uint32Array]"]=!0,jf["[object Error]"]=jf["[object Function]"]=jf["[object WeakMap]"]=!1;var Ff=function e(t,n,r,i,o,s){var a,u=1&n,c=2&n,f=4&n;if(r&&(a=o?r(t,i,o,s):r(t)),void 0!==a)return a;if(!Vo(t))return t;var l=_o(t);if(l){if(a=gf(t),!u)return Gi(t,a)}else{var h=uc(t),p="[object Function]"==h||"[object GeneratorFunction]"==h;if(To(t))return lf(t,u);if("[object Object]"==h||"[object Arguments]"==h||p&&!o){if(a=c||p?{}:Mf(t),!u)return c?df(t,ff(a,t)):hf(t,of(a,t))}else{if(!jf[h])return o?t:{};a=Af(t,h,u)}}s||(s=new Cu);var d=s.get(t);if(d)return d;if(s.set(t,a),Lf(t))return t.forEach((function(i){a.add(e(i,n,r,i,t,s))})),a;if(Pf(t))return t.forEach((function(i,o){a.set(o,e(i,n,r,o,t,s))})),a;var m=f?c?mf:Zu:c?keysIn:zo,v=l?void 0:m(t);return Hc(v||t,(function(i,o){v&&(i=t[o=i]),nf(a,o,e(i,n,r,o,t,s))})),a};var Df=function(e){return Ff(e,5)};var Bf=function(e){return function(t,n,r){var i=Object(t);if(!qo(t)){var o=Yc(n);t=zo(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:void 0}};var Uf=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1},Vf=/^\s+|\s+$/g,Yf=/^[-+]0x[0-9a-f]+$/i,qf=/^0b[01]+$/i,zf=/^0o[0-7]+$/i,Wf=parseInt;var Gf=function(e){if("number"==typeof e)return e;if(gc(e))return NaN;if(Vo(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Vo(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Vf,"");var n=qf.test(e);return n||zf.test(e)?Wf(e.slice(2),n?2:8):Yf.test(e)?NaN:+e};var $f=function(e){return e?(e=Gf(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var Jf=function(e){var t=$f(e),n=t%1;return t==t?n?t-n:t:0},Zf=Math.max;var Kf,Xf=Bf((function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Jf(n);return i<0&&(i=Zf(r+i,0)),Uf(e,Yc(t),i)})),Hf=Object.freeze({__proto__:null,UNREAD_MESSAGES_COUNT_UPDATE:"unreadmessagescountupdate",CLOSE:"close",CONFLICT:"conflict",CONVERSATION_INFO_UPDATED:"conversationinfoupdated",UNHANDLED_MESSAGE:"unhandledmessage",INVITED:"invited",KICKED:"kicked",MEMBERS_JOINED:"membersjoined",MEMBERS_LEFT:"membersleft",MEMBER_INFO_UPDATED:"memberinfoupdated",BLOCKED:"blocked",UNBLOCKED:"unblocked",MEMBERS_BLOCKED:"membersblocked",MEMBERS_UNBLOCKED:"membersunblocked",MUTED:"muted",UNMUTED:"unmuted",MEMBERS_MUTED:"membersmuted",MEMBERS_UNMUTED:"membersunmuted",MESSAGE:"message",MESSAGE_RECALL:"messagerecall",MESSAGE_UPDATE:"messageupdate",LAST_DELIVERED_AT_UPDATE:"lastdeliveredatupdate",LAST_READ_AT_UPDATE:"lastreadatupdate",INFO_UPDATED:"infoupdated"});function Qf(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function el(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qf(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):Qf(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var tl={NONE:en("none"),SENDING:en("sending"),SENT:en("sent"),DELIVERED:en("delivered"),FAILED:en("failed")};Qs(tl);var nl,rl=(Ur(Kf={},tl.NONE,!0),Ur(Kf,tl.SENDING,!0),Ur(Kf,tl.SENT,!0),Ur(Kf,tl.DELIVERED,!0),Ur(Kf,tl.READ,!0),Ur(Kf,tl.FAILED,!0),Kf),il=function(){function e(e){Er(this,{content:e},{id:Sa(),cid:null,timestamp:new Date,from:void 0,mentionList:[],mentionedAll:!1,_mentioned:!1}),this._setStatus(tl.NONE)}var t=e.prototype;return t.getPayload=function(){return this.content},t._toJSON=function(){return{id:this.id,cid:this.cid,from:this.from,timestamp:this.timestamp,deliveredAt:this.deliveredAt,updatedAt:this.updatedAt,mentionList:this.mentionList,mentionedAll:this.mentionedAll,mentioned:this.mentioned}},t.toJSON=function(){return el(el({},this._toJSON()),{},{data:this.content})},t.toFullJSON=function(){var e=this.content,t=this.id,n=this.cid,r=this.from,i=this.timestamp,o=this.deliveredAt,s=this._updatedAt,a=this.mentionList,u=this.mentionedAll;return{data:e,id:t,cid:n,from:r,timestamp:Ss(i),deliveredAt:Ss(o),updatedAt:Ss(s),mentionList:a,mentionedAll:u}},t._setStatus=function(e){if(!rl[e])throw new Error("Invalid message status");this._status=e},t._updateMentioned=function(e){this._mentioned=this.from!==e&&(this.mentionedAll||this.mentionList.indexOf(e)>-1)},t.getMentionList=function(){return this.mentionList},t.setMentionList=function(e){return this.mentionList=js(e),this},t.mentionAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.mentionedAll=Boolean(e),this},e.validate=function(){return!0},e.parse=function(e,t){return t||new this(e)},Ho(e,[{key:"status",get:function(){return this._status}},{key:"timestamp",get:function(){return this._timestamp},set:function(e){this._timestamp=Ts(e)}},{key:"deliveredAt",get:function(){return this._deliveredAt},set:function(e){this._deliveredAt=Ts(e)}},{key:"updatedAt",get:function(){return this._updatedAt||this.timestamp},set:function(e){this._updatedAt=Ts(e)}},{key:"mentioned",get:function(){return this._mentioned}}]),e}(),ol=function(e){if("number"!=typeof e)throw new TypeError("".concat(e," is not a Number"));return function(t){t.TYPE=e,t.validate=function(t){return t._lctype===e},t.prototype._getType=function(){return{_lctype:e}}}},sl=function(e){if("string"!=typeof e){if(!P(e))throw new TypeError("".concat(e," is not an Array"));if(e.some((function(e){return"string"!=typeof e})))throw new TypeError("fields contains non-string typed member")}return function(t){var n=Cs?Ms(t,"_customFields"):t._customFields;n=P(n)?n:[],t._customFields=n.concat(e)}},al=function(e){Cs&&(e.parse=Ms(e,"parse"))};function ul(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function cl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ul(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):ul(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var fl,ll=sl(["_lctext","_lcattrs"])(nl=function(e){function t(){return e.apply(this,arguments)||this}Fi(t,e);var n=t.prototype;return n.setText=function(e){return this._lctext=e,this},n.getText=function(){return this._lctext},n.setAttributes=function(e){return this._lcattrs=e,this},n.getAttributes=function(){return this._lcattrs},n._getCustomFields=function(){var e=this;return(P(this.constructor._customFields)?this.constructor._customFields:[]).reduce((function(t,n){return"string"!=typeof n||(t[n]=e[n]),t}),{})},n._getType=function(){throw new Error("not implemented")},n.getPayload=function(){return Ns(cl(cl({_lctext:this.getText(),_lcattrs:this.getAttributes()},this._getCustomFields()),this._getType()))},n.toJSON=function(){var t=this.type,n=this.text,r=this.attributes,i=this.summary;return cl(cl({},e.prototype._toJSON.call(this)),{},{type:t,text:n,attributes:r,summary:i})},n.toFullJSON=function(){return cl(cl({},e.prototype.toFullJSON.call(this)),{},{data:this.getPayload()})},t.parse=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new this;n.content=t;var r=Cs?Ms(n.constructor,"_customFields"):n.constructor._customFields,i=P(r)?r:[];return i=i.reduce((function(e,n){return"string"!=typeof n||(e[n]=t[n]),e}),{}),Er(n,i),e.parse.call(this,t,n)},Ho(t,[{key:"type",get:function(){return this.constructor.TYPE}},{key:"text",set:function(e){return this.setText(e)},get:function(){return this.getText()}},{key:"attributes",set:function(e){return this.setAttributes(e)},get:function(){return this.getAttributes()}},{key:"summary",get:function(){return this.text}}]),t}(il))||nl,hl=ol(-127)(fl=al(fl=function(e){function t(){return e.apply(this,arguments)||this}return Fi(t,e),Ho(t,[{key:"summary",get:function(){return"[è¯¥æ¶æ¯å·²æ¤å]"}}]),t}(ll))||fl)||fl;function pl(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function dl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pl(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):pl(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var ml=Wi("LC:Conversation"),vl=function(e){var t,n,r=e.getPayload();return r instanceof ArrayBuffer?n=r:t="string"!=typeof r?wi(r):r,{msg:t,binaryMsg:n}},gl=ni.QueryDirection,yl=gl.NEW,bl={NEW_TO_OLD:gl.OLD,OLD_TO_NEW:yl};Qs(bl);var wl=function(e){function t(t,n){var r,i=t.id,o=t.lastMessageAt,s=t.lastMessage,a=t.lastDeliveredAt,u=t.lastReadAt,c=t.unreadMessagesCount,f=void 0===c?0:c,l=t.members,h=void 0===l?[]:l,p=t.mentioned,d=void 0!==p&&p,m=Li(t,["id","lastMessageAt","lastMessage","lastDeliveredAt","lastReadAt","unreadMessagesCount","members","mentioned"]);return r=e.call(this)||this,Er(ji(r),dl({id:i,lastMessageAt:o,lastMessage:s,members:h},m)),r.members=Ai(new Ri(r.members)),Er(Rs(ji(r)),{messagesWaitingForReceipt:{},lastDeliveredAt:a,lastReadAt:u,unreadMessagesCount:f,mentioned:d}),r._client=n,ml.enabled&&Wo(Hf).forEach((function(e){return r.on(e,(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r._debug("".concat(e," event emitted. %o"),n)}))})),fa(r._client._plugins.onConversationCreate,ji(r)),r}Fi(t,e);var n=t.prototype;return n._setUnreadMessagesMentioned=function(e){Rs(this).unreadMessagesMentioned=Boolean(e)},n._setLastDeliveredAt=function(e){var t=Ts(e);t<Rs(this).lastDeliveredAt||(Rs(this).lastDeliveredAt=t,this.emit("lastdeliveredatupdate"))},n._setLastReadAt=function(e){var t=Ts(e);t<Rs(this).lastReadAt||(Rs(this).lastReadAt=t,this.emit("lastreadatupdate"))},n.toFullJSON=function(){var e=this.id,t=this.members,n=this.lastMessageAt,r=this.lastDeliveredAt,i=this.lastReadAt,o=this.lastMessage,s=this.unreadMessagesCount;return{id:e,members:t,lastMessageAt:Ss(n),lastDeliveredAt:Ss(r),lastReadAt:Ss(i),lastMessage:o?o.toFullJSON():void 0,unreadMessagesCount:s}},n.toJSON=function(){var e=this.id,t=this.members,n=this.lastMessageAt,r=this.lastDeliveredAt,i=this.lastReadAt,o=this.lastMessage,s=this.unreadMessagesCount,a=this.unreadMessagesMentioned;return{id:e,members:t,lastMessageAt:n,lastDeliveredAt:r,lastReadAt:i,lastMessage:o?o.toJSON():void 0,unreadMessagesCount:s,unreadMessagesMentioned:a}},n._debug=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];ml.apply(void 0,t.concat(["[".concat(this.id,"]")]))},n._send=function(e){var t;null===e.cmd&&(e.cmd="conv"),"conv"===e.cmd&&null===e.convMessage&&(e.convMessage=new ei),e.convMessage&&null===e.convMessage.cid&&(e.convMessage.cid=this.id);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this._client)._send.apply(t,[e].concat(r))},n.send=function(){var e=Ti(_i.mark((function e(t,n){var r,i,o,s,a,u,c,f,l,h,p,d,m,v,g,y,b;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._debug(t,"send"),t instanceof il){e.next=3;break}throw new TypeError("".concat(t," is not a Message"));case 3:return r=dl(dl(dl({},t.constructor.sendOptions),"function"==typeof t.constructor.getSendOptions?t.constructor.getSendOptions(t):{}),n),i=r.transient,o=r.receipt,s=r.priority,a=r.pushData,u=r.will,o&&(this.transient?console.warn("receipt option is ignored as the conversation is transient."):i?console.warn("receipt option is ignored as the message is sent transiently."):this.members.length>2&&console.warn("receipt option is recommended to be used in one-on-one conversation.")),s&&!this.transient&&console.warn("priority option is ignored as the conversation is not transient."),Er(t,{cid:this.id,from:this._client.id}),t._setStatus(tl.SENDING),c=vl(t),f=c.msg,l=c.binaryMsg,h=new ci({cmd:"direct",directMessage:new Xr({msg:f,binaryMsg:l,cid:this.id,r:o,transient:i,dt:t.id,pushData:wi(a),will:u,mentionPids:t.mentionList,mentionAll:t.mentionedAll}),priority:s}),e.prev=10,e.next=13,this._send(h);case 13:if(p=e.sent,d=p.ackMessage,m=d.uid,v=d.t,g=d.code,y=d.reason,b=d.appCode,null===g){e.next=17;break}throw na({code:g,reason:y,appCode:b});case 17:return Er(t,{id:m,timestamp:v}),i||(this.lastMessage=t,this.lastMessageAt=t.timestamp),t._setStatus(tl.SENT),o&&(Rs(this).messagesWaitingForReceipt[t.id]=t),e.abrupt("return",t);case 24:throw e.prev=24,e.t0=e.catch(10),t._setStatus(tl.FAILED),e.t0;case 28:case"end":return e.stop()}}),e,this,[[10,24]])})));return function(t,n){return e.apply(this,arguments)}}(),n._update=function(){var e=Ti(_i.mark((function e(t,n,r){var i,o,s,a,u,c,f,l;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._debug("patch %O %O %O",t,n,r),!(t instanceof il)){e.next=8;break}if(t.from===this._client.id){e.next=4;break}throw new Error("Updating message from others is not allowed");case 4:if(t.status===tl.SENT||t.status===tl.DELIVERED){e.next=6;break}throw new Error("Message is not sent");case 6:e.next=10;break;case 8:if(t.id&&t.timestamp){e.next=10;break}throw new TypeError("".concat(t," is not a Message"));case 10:return r||(s=vl(n),i=s.msg,o=s.binaryMsg),e.next=13,this._send(new ci({cmd:di.patch,op:mi.modify,patchMessage:new li({patches:[new hi({cid:this.id,mid:t.id,timestamp:Number(t.timestamp),recall:r,data:i,binaryMsg:o,mentionPids:n.mentionList,mentionAll:n.mentionedAll})],lastPatchTime:this._client._lastPatchTime})}));case 13:return a=t.id,u=t.cid,c=t.timestamp,f=t.from,l=t._status,Er(n,{id:a,cid:u,timestamp:c,from:f,_status:l}),this.lastMessage.id===n.id&&(this.lastMessage=n),e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),n.count=function(){var e=Ti(_i.mark((function e(){var t;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("count"),e.next=3,this._send(new ci({op:"count"}));case 3:return t=e.sent,e.abrupt("return",t.convMessage.count);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._addMembers=function(){},n._removeMembers=function(){},n.update=function(){var e=Ti(_i.mark((function e(t,n){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n instanceof il){e.next=2;break}throw new TypeError("".concat(n," is not a Message"));case 2:return e.abrupt("return",this._update(t,n,!1));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),n.recall=function(){var e=Ti(_i.mark((function e(t){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._update(t,new hl,!0));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.queryMessages=function(){var e=Ti(_i.mark((function e(){var t,n,r,i,o,s,a,u,c,f,l,h,p,d,m,v,g=this,y=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y.length>0&&void 0!==y[0]?y[0]:{},this._debug("query messages %O",t),n=t.beforeTime,r=t.beforeMessageId,i=t.afterTime,o=t.afterMessageId,s=t.limit,a=t.direction,u=t.type,c=t.startTime,f=t.startMessageId,l=t.startClosed,h=t.endTime,p=t.endMessageId,d=t.endClosed,!(r||n||o||i)){e.next=6;break}return console.warn("DEPRECATION: queryMessages options beforeTime, beforeMessageId, afterTime and afterMessageId are deprecated in favor of startTime, startMessageId, endTime and endMessageId."),e.abrupt("return",this.queryMessages({startTime:n,startMessageId:r,endTime:i,endMessageId:o,limit:s}));case 6:if(!f||c){e.next=8;break}throw new Error("query option startMessageId must be used with option startTime");case 8:if(!p||h){e.next=10;break}throw new Error("query option endMessageId must be used with option endTime");case 10:return(m={t:c,mid:f,tIncluded:l,tt:h,tmid:p,ttIncluded:d,l:s,lctype:u}).t instanceof Date&&(m.t=m.t.getTime()),m.tt instanceof Date&&(m.tt=m.tt.getTime()),void 0!==a?m.direction=a:m.tt>m.t&&(m.direction=bl.OLD_TO_NEW),e.next=16,this._send(new ci({cmd:"logs",logsMessage:new ni(Er(m,{cid:this.id}))}));case 16:return v=e.sent,e.abrupt("return",wr.all(v.logsMessage.logs.map(function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a,u,c,f,l,h,p,d;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.msgId,r=t.timestamp,i=t.patchTimestamp,o=t.from,s=t.ackAt,a=t.readAt,u=t.data,c=t.mentionAll,f=t.mentionPids,l=t.bin,h={data:u,bin:l,id:n,cid:g.id,timestamp:r,from:o,deliveredAt:s,updatedAt:i,mentionList:f,mentionedAll:c},e.next=4,g._client.parseMessage(h);case 4:return p=e.sent,d=tl.SENT,2===g.members.length&&(s&&(d=tl.DELIVERED),s&&g._setLastDeliveredAt(s),a&&g._setLastReadAt(a)),p._setStatus(d),e.abrupt("return",p);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createMessagesIterator=function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.beforeTime,i=n.beforeMessageId,o=n.limit;return{next:function(){return(e=void 0===e?t.queryMessages({limit:o,startTime:r,startMessageId:i}):e.then((function(e){return 0===e.length||e.length<o?[]:t.queryMessages({startTime:e[0].timestamp,startMessageId:e[0].id,limit:o})}))).then((function(e){return{value:Ai(e),done:0===e.length||e.length<o}}))}}},n.read=function(){var e=Ti(_i.mark((function e(){var t;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.unreadMessagesCount=0,this._setUnreadMessagesMentioned(!1),!this.transient){e.next=4;break}return e.abrupt("return",this);case 4:return t=this._client,Rs(t).readConversationsBuffer||(Rs(t).readConversationsBuffer=new Ri),Rs(t).readConversationsBuffer.add(this),t._doSendRead(),e.abrupt("return",this);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._handleReceipt=function(e){var t=e.messageId,n=e.timestamp;e.read?this._setLastReadAt(n):this._setLastDeliveredAt(n);var r=Rs(this).messagesWaitingForReceipt,i=r[t];i&&(i._setStatus(tl.DELIVERED),i.deliveredAt=n,delete r[t])},n.fetchReceiptTimestamps=function(){var e=Ti(_i.mark((function e(){var t,n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._send(new ci({op:"max_read"}));case 2:return t=e.sent,n=t.convMessage,r=n.maxReadTimestamp,i=n.maxAckTimestamp,this._setLastDeliveredAt(i),this._setLastReadAt(r),e.abrupt("return",this);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._fetchAllReceiptTimestamps=function(){var e=new ei({queryAllMembers:!0});return this._send(new ci({op:"max_read",convMessage:e})).then((function(e){return e.convMessage.maxReadTuples.filter((function(e){return e.maxAckTimestamp||e.maxReadTimestamp})).map((function(e){var t=e.pid,n=e.maxAckTimestamp,r=e.maxReadTimestamp;return{pid:t,lastDeliveredAt:Ts(n),lastReadAt:Ts(r)}}))}))},Ho(t,[{key:"unreadMessagesMentioned",get:function(){return Rs(this).unreadMessagesMentioned}},{key:"unreadMessagesCount",set:function(e){e!==this.unreadMessagesCount&&(Rs(this).unreadMessagesCount=e,this._client.emit("unreadmessagescountupdate",[this]))},get:function(){return Rs(this).unreadMessagesCount}},{key:"lastMessageAt",set:function(e){var t=Ts(e);t<=this._lastMessageAt||(this._lastMessageAt=t)},get:function(){return this._lastMessageAt}},{key:"lastDeliveredAt",get:function(){return 2!==this.members.length?null:Rs(this).lastDeliveredAt}},{key:"lastReadAt",get:function(){return 2!==this.members.length?null:Rs(this).lastReadAt}}]),t}(yi),_l=Wi("LC:SignatureFactoryRunner");function El(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.signature,n=e.timestamp,r=e.nonce;if("string"!=typeof t||"number"!=typeof n||"string"!=typeof r)throw new Error("malformed signature");return{signature:t,timestamp:n,nonce:r}}var Tl=function(e,t){return wr.resolve().then((function(){return _l("call signatureFactory with %O",t),e.apply(void 0,Pi(t))})).then(_s((function(e){return _l("sign result %O",e)})),(function(e){throw e.message="sign error: ".concat(e.message),_l(e),e})).then(El)};function Sl(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function Il(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sl(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):Sl(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var Al=function(e){return{successfulClientIds:e.allowedPids,failures:e.failedPids.map((function(e){var t=e.pids,n=Li(e,["pids"]);return Er(na(n),{clientIds:t})}))}},Ol=function(e){function t(t,n,r){var i,o=n.creator,s=n.createdAt,a=n.updatedAt,u=n.transient,c=void 0!==u&&u,f=n.system,l=void 0!==f&&f,h=n.muted,p=void 0!==h&&h,d=n.mutedMembers,m=void 0===d?[]:d,v=Li(n,["creator","createdAt","updatedAt","transient","system","muted","mutedMembers"]);return(i=e.call(this,Il(Il({},t),{},{creator:o,createdAt:s,updatedAt:a,mutedMembers:m,transient:c,system:l,muted:p,_attributes:v}),r)||this)._reset(),i}Fi(t,e);var n=t.prototype;return n.get=function(e){return Rs(this).currentAttributes[e]},n.set=function(e,t){this._debug("set [".concat(e,"]: ").concat(t));var n=Rs(this).pendingAttributes,r=un(n),i=new RegExp("^".concat(e)),o=r.filter(i.test.bind(i));if(o.forEach((function(e){delete n[e]})),o.length)n[e]=t;else{var s=Xf(r,(function(t){return 0===e.indexOf(t)}));s?Fs(n[s],e.slice(s.length+1),t):n[e]=t}return this._buildCurrentAttributes(),this},n._buildCurrentAttributes=function(){var e=Rs(this).pendingAttributes;Rs(this).currentAttributes=un(e).reduce((function(t,n){return Fs(t,n,e[n])}),Df(this._attributes))},n._updateServerAttributes=function(e){var t=this;un(e).forEach((function(n){return Fs(t._attributes,n,e[n])})),this._buildCurrentAttributes()},n._reset=function(){Er(Rs(this),{pendingAttributes:{},currentAttributes:this._attributes})},n.save=function(){var e=Ti(_i.mark((function e(){var t,n,r;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._debug("save"),t=Rs(this).pendingAttributes,!Xc(t)){e.next=5;break}return this._debug("nothing touched, resolve with self"),e.abrupt("return",this);case 5:return this._debug("attr: %O",t),n=new ei({attr:new Wr({data:wi(As(t))})}),e.next=9,this._send(new ci({op:"update",convMessage:n}));case 9:return r=e.sent,this.updatedAt=r.convMessage.udate,this._attributes=Rs(this).currentAttributes,Rs(this).pendingAttributes={},e.abrupt("return",this);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.fetch=function(){var e=Ti(_i.mark((function e(){var t;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._client.getQuery().equalTo("objectId",this.id),e.next=3,t.find();case 3:return e.abrupt("return",this);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.mute=function(){var e=Ti(_i.mark((function e(){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("mute"),e.next=3,this._send(new ci({op:"mute"}));case 3:return this.transient||(this.muted=!0,this.mutedMembers=xs(this.mutedMembers,[this._client.id])),e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.unmute=function(){var e=Ti(_i.mark((function e(){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("unmute"),e.next=3,this._send(new ci({op:"unmute"}));case 3:return this.transient||(this.muted=!1,this.mutedMembers=ks(this.mutedMembers,[this._client.id])),e.abrupt("return",this);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n._appendConversationSignature=function(){var e=Ti(_i.mark((function e(t,n,r){var i,o;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._client.options.conversationSignatureFactory){e.next=6;break}return i=[this.id,this._client.id,r.sort(),n],e.next=4,Tl(this._client.options.conversationSignatureFactory,i);case 4:o=e.sent,Er(t.convMessage,Os({signature:"s",timestamp:"t",nonce:"n"},o));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),n._appendBlacklistSignature=function(){var e=Ti(_i.mark((function e(t,n,r){var i,o;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._client.options.blacklistSignatureFactory){e.next=6;break}return i=[this._client.id,this.id,r.sort(),n],e.next=4,Tl(this._client.options.blacklistSignatureFactory,i);case 4:o=e.sent,Er(t.blacklistMessage,Os({signature:"s",timestamp:"t",nonce:"n"},o));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),n.add=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("add",t),"string"==typeof t&&(t=[t]),n=new ci({op:"add",convMessage:new ei({m:t})}),e.next=5,this._appendConversationSignature(n,"add",t);case 5:return e.next=7,this._send(n);case 7:return r=e.sent,i=r.convMessage,o=r.convMessage.allowedPids,this._addMembers(o),e.abrupt("return",Al(i));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.remove=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("remove",t),"string"==typeof t&&(t=[t]),n=new ci({op:"remove",convMessage:new ei({m:t})}),e.next=5,this._appendConversationSignature(n,"remove",t);case 5:return e.next=7,this._send(n);case 7:return r=e.sent,i=r.convMessage,o=r.convMessage.allowedPids,this._removeMembers(o),e.abrupt("return",Al(i));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.join=function(){var e=Ti(_i.mark((function e(){var t=this;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("join"),e.abrupt("return",this.add(this._client.id).then((function(e){var n=e.failures;if(n[0])throw n[0];return t})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.quit=function(){var e=Ti(_i.mark((function e(){var t=this;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("quit"),e.abrupt("return",this.remove(this._client.id).then((function(e){var n=e.failures;if(n[0])throw n[0];return t})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.muteMembers=function(){var e=Ti(_i.mark((function e(t){var n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("mute",t),t=js(t),n=new ci({op:mi.add_shutup,convMessage:new ei({m:t})}),e.next=5,this._send(n);case 5:return r=e.sent,i=r.convMessage,e.abrupt("return",Al(i));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.unmuteMembers=function(){var e=Ti(_i.mark((function e(t){var n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("unmute",t),t=js(t),n=new ci({op:mi.remove_shutup,convMessage:new ei({m:t})}),e.next=5,this._send(n);case 5:return r=e.sent,i=r.convMessage,e.abrupt("return",Al(i));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.queryMutedMembers=function(){var e=Ti(_i.mark((function e(){var t,n,r,i,o,s,a,u,c=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},n=t.limit,r=t.next,this._debug("query muted: limit %O, next: %O",n,r),i=new ci({op:mi.query_shutup,convMessage:new ei({limit:n,next:r})}),e.next=5,this._send(i);case 5:return o=e.sent,s=o.convMessage,a=s.m,u=s.next,e.abrupt("return",{results:a,next:u});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.blockMembers=function(){var e=Ti(_i.mark((function e(t){var n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("block",t),t=js(t),n=new ci({cmd:"blacklist",op:mi.block,blacklistMessage:new fi({srcCid:this.id,toPids:t})}),e.next=5,this._appendBlacklistSignature(n,"conversation-block-clients",t);case 5:return e.next=7,this._send(n);case 7:return r=e.sent,i=r.blacklistMessage,e.abrupt("return",Al(i));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.unblockMembers=function(){var e=Ti(_i.mark((function e(t){var n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._debug("unblock",t),t=js(t),n=new ci({cmd:"blacklist",op:mi.unblock,blacklistMessage:new fi({srcCid:this.id,toPids:t})}),e.next=5,this._appendBlacklistSignature(n,"conversation-unblock-clients",t);case 5:return e.next=7,this._send(n);case 7:return r=e.sent,i=r.blacklistMessage,e.abrupt("return",Al(i));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.queryBlockedMembers=function(){var e=Ti(_i.mark((function e(){var t,n,r,i,o,s,a,u,c=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},n=t.limit,r=t.next,this._debug("query blocked: limit %O, next: %O",n,r),i=new ci({cmd:"blacklist",op:mi.query,blacklistMessage:new fi({srcCid:this.id,limit:n,next:r})}),e.next=5,this._send(i);case 5:return o=e.sent,s=o.blacklistMessage,a=s.blockedPids,u=s.next,e.abrupt("return",{results:a,next:u});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.toFullJSON=function(){var t=this.creator,n=this.system,r=this.transient,i=this.createdAt,o=this.updatedAt,s=this._attributes;return Il(Il({},e.prototype.toFullJSON.call(this)),{},{creator:t,system:n,transient:r,createdAt:Ss(i),updatedAt:Ss(o)},s)},n.toJSON=function(){var t=this.creator,n=this.system,r=this.transient,i=this.muted,o=this.mutedMembers,s=this.createdAt,a=this.updatedAt,u=this._attributes;return Il(Il({},e.prototype.toJSON.call(this)),{},{creator:t,system:n,transient:r,muted:i,mutedMembers:o,createdAt:s,updatedAt:a},u)},Ho(t,[{key:"createdAt",set:function(e){this._createdAt=Ts(e)},get:function(){return this._createdAt}},{key:"updatedAt",set:function(e){this._updatedAt=Ts(e)},get:function(){return this._updatedAt}},{key:"name",get:function(){return this.get("name")},set:function(e){this.set("name",e)}}]),t}(wl),Cl={OWNER:"Owner",MANAGER:"Manager",MEMBER:"Member"};Qs(Cl);var Ml=function(){function e(e){var t=e.conversation,n=e.memberId,r=e.role;if(!t)throw new Error("conversation requried");if(!n)throw new Error("memberId requried");Er(Rs(this),{conversation:t,memberId:n,role:r})}return e.prototype.toJSON=function(){return{conversationId:this.conversationId,memberId:this.memberId,role:this.role,isOwner:this.isOwner}},Ho(e,[{key:"conversationId",get:function(){return Rs(this).conversation.id}},{key:"memberId",get:function(){return Rs(this).memberId}},{key:"role",get:function(){return this.isOwner?Cl.OWNER:Rs(this).role}},{key:"isOwner",get:function(){return this.memberId===Rs(this).conversation.creator}}]),e}(),xl=function(e){function t(){return e.apply(this,arguments)||this}Fi(t,e);var n=t.prototype;return n._addMembers=function(t){var n=this;e.prototype._addMembers.call(this,t),this.members=xs(this.members,t);var r=Rs(this).memberInfoMap;r&&t.forEach((function(e){r[e]=r[e]||new Ml({conversation:n,memberId:e,role:Cl.MEMBER})}))},n._removeMembers=function(t){e.prototype._removeMembers.call(this,t),this.members=ks(this.members,t);var n=Rs(this).memberInfoMap;n&&t.forEach((function(e){delete n[e]}))},n._fetchAllMemberInfo=function(){var e=Ti(_i.mark((function e(){var t,n,r,i=this;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._client._requestWithSessionToken({method:"GET",path:"/classes/_ConversationMemberInfo",query:{where:{cid:this.id}}});case 2:return t=e.sent,n=t.results.map((function(e){return new Ml({conversation:i,memberId:e.clientId,role:e.role})})),r={},n.forEach((function(e){r[e.memberId]=e})),this.members.forEach((function(e){r[e]=r[e]||new Ml({conversation:i,memberId:e,role:Cl.MEMBER})})),Rs(this).memberInfoMap=r,e.abrupt("return",r);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getAllMemberInfo=function(){var e=Ti(_i.mark((function e(){var t,n,r,i,o,s=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:{},n=t.noCache,r=void 0!==n&&n,i=Rs(this),(o=i.memberInfoMap)&&!r){e.next=6;break}return e.next=5,this._fetchAllMemberInfo();case 5:o=e.sent;case 6:return e.abrupt("return",this.members.map((function(e){return o[e]})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getMemberInfo=function(){var e=Ti(_i.mark((function e(t){var n,r;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==this.members.indexOf(t)){e.next=2;break}throw new Error("".concat(t," is not the mumber of conversation[").concat(this.id,"]"));case 2:if(n=Rs(this),(r=n.memberInfoMap)&&r[t]){e.next=6;break}return e.next=6,this.getAllMemberInfo();case 6:return e.abrupt("return",Rs(this).memberInfoMap[t]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.updateMemberRole=function(){var e=Ti(_i.mark((function e(t,n){var r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._debug("update member role"),n!==Cl.OWNER){e.next=3;break}throw na({code:ta.OWNER_PROMOTION_NOT_ALLOWED});case 3:return e.next=5,this._send(new ci({op:mi.member_info_update,convMessage:new ei({targetClientId:t,info:new pi({pid:t,role:n})})}));case 5:return r=Rs(this),(i=r.memberInfos)&&i[t]&&(Rs(i[t]).role=n),e.abrupt("return",this);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t}(Ol),kl=function(e){function t(){return e.apply(this,arguments)||this}return Fi(t,e),t}(Ol),Pl=function(e){function t(){return e.apply(this,arguments)||this}Fi(t,e);var n=t.prototype;return n.subscribe=function(){var e=Ti(_i.mark((function e(){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.join());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.unsubscribe=function(){var e=Ti(_i.mark((function e(){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.quit());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t}(Ol);function Rl(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rl(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):Rl(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var Ll,jl,Fl,Dl=function(e){return e.code===ta.CONVERSATION_NOT_FOUND?na({code:ta.TEMPORARY_CONVERSATION_EXPIRED}):e},Bl=function(e){function t(t,n,r){var i=n.expiredAt;return e.call(this,Nl(Nl({},t),{},{expiredAt:i}),r)||this}Fi(t,e);var n=t.prototype;return n._send=function(){var t=Ti(_i.mark((function t(){var n,r,i,o,s=arguments;return _i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.expired){t.next=2;break}throw na({code:ta.TEMPORARY_CONVERSATION_EXPIRED});case 2:for(t.prev=2,r=s.length,i=new Array(r),o=0;o<r;o++)i[o]=s[o];return t.next=6,(n=e.prototype._send).call.apply(n,[this].concat(i));case 6:return t.abrupt("return",t.sent);case 9:throw t.prev=9,t.t0=t.catch(2),Dl(t.t0);case 12:case"end":return t.stop()}}),t,this,[[2,9]])})));return function(){return t.apply(this,arguments)}}(),n.send=function(){var t=Ti(_i.mark((function t(){var n,r,i,o,s=arguments;return _i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(t.prev=0,r=s.length,i=new Array(r),o=0;o<r;o++)i[o]=s[o];return t.next=4,(n=e.prototype.send).call.apply(n,[this].concat(i));case 4:return t.abrupt("return",t.sent);case 7:throw t.prev=7,t.t0=t.catch(0),Dl(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));return function(){return t.apply(this,arguments)}}(),n.toFullJSON=function(){var t=this.expiredAt;return Nl(Nl({},e.prototype.toFullJSON.call(this)),{},{expiredAt:Ss(t)})},n.toJSON=function(){var t=this.expiredAt,n=this.expired;return Nl(Nl({},e.prototype.toJSON.call(this)),{},{expiredAt:t,expired:n})},Ho(t,[{key:"expiredAt",set:function(e){this._expiredAt=Ts(e)},get:function(){return this._expiredAt}},{key:"expired",get:function(){return this.expiredAt<new Date}}]),t}(wl),Ul=Wi("LC:ConversationQuery"),Vl=function(){function e(e){this._client=e,this._where={},this._extraOptions={}}e._encode=function(e){return e instanceof Date?{__type:"Date",iso:e.toJSON()}:e instanceof RegExp?e.source:e},e._quote=function(e){return"\\Q".concat(e.replace("\\E","\\E\\\\E\\Q"),"\\E")},e._calculateFlag=function(e){return["withLastMessagesRefreshed","compact"].reduce((function(t,n){return(t<<1)+Boolean(e[n])}),0)},e.and=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length<2)throw new Error("The queries must contain at least two elements");if(!n.every((function(t){return t instanceof e})))throw new Error("The element of queries must be an instance of ConversationQuery");var i=new e(n[0]._client);return i._where.$and=n.map((function(e){return e._where})),i},e.or=function(){var t=e.and.apply(e,arguments);return t._where.$or=t._where.$and,delete t._where.$and,t};var t=e.prototype;return t._addCondition=function(e,t,n){return this._where[e]||(this._where[e]={}),this._where[e][t]=this.constructor._encode(n),this},t.toJSON=function(){var e={where:this._where,flag:this.constructor._calculateFlag(this._extraOptions)};return void 0!==this._skip&&(e.skip=this._skip),void 0!==this._limit&&(e.limit=this._limit),void 0!==this._order&&(e.sort=this._order),Ul(e),e},t.containsMembers=function(e){return this.containsAll("m",e)},t.withMembers=function(e,t){var n=new Ri(e);return t&&n.add(this._client.id),this.sizeEqualTo("m",n.size),this.containsMembers(Ai(n))},t.equalTo=function(e,t){return this._where[e]=this.constructor._encode(t),this},t.lessThan=function(e,t){return this._addCondition(e,"$lt",t)},t.lessThanOrEqualTo=function(e,t){return this._addCondition(e,"$lte",t)},t.greaterThan=function(e,t){return this._addCondition(e,"$gt",t)},t.greaterThanOrEqualTo=function(e,t){return this._addCondition(e,"$gte",t)},t.notEqualTo=function(e,t){return this._addCondition(e,"$ne",t)},t.exists=function(e){return this._addCondition(e,"$exists",!0)},t.doesNotExist=function(e){return this._addCondition(e,"$exists",!1)},t.containedIn=function(e,t){return this._addCondition(e,"$in",t)},t.notContainsIn=function(e,t){return this._addCondition(e,"$nin",t)},t.containsAll=function(e,t){return this._addCondition(e,"$all",t)},t.contains=function(t,n){return this._addCondition(t,"$regex",e._quote(n))},t.startsWith=function(t,n){return this._addCondition(t,"$regex","^".concat(e._quote(n)))},t.endsWith=function(t,n){return this._addCondition(t,"$regex","".concat(e._quote(n),"$"))},t.matches=function(e,t){this._addCondition(e,"$regex",t);var n="";return t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),n&&n.length&&this._addCondition(e,"$options",n),this},t.sizeEqualTo=function(e,t){return this._addCondition(e,"$size",t)},t.limit=function(e){return this._limit=e,this},t.skip=function(e){return this._skip=e,this},t.ascending=function(e){return this._order=e,this},t.addAscending=function(e){return this._order?this._order+=",".concat(e):this._order=e,this},t.descending=function(e){return this._order="-".concat(e),this},t.addDescending=function(e){return this._order?this._order+=",-".concat(e):this._order="-".concat(e),this},t.withLastMessagesRefreshed=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._extraOptions.withLastMessagesRefreshed=e,this},t.compact=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._extraOptions.compact=e,this},t.find=function(){var e=Ti(_i.mark((function e(){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._client._executeQuery(this));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.first=function(){var e=Ti(_i.mark((function e(){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.limit(1).find();case 2:return e.abrupt("return",e.sent[0]);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}(),Yl=Wi("LC:SessionManager"),ql=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refresh,n=e.onBeforeGetSessionToken;this.refresh=t,this._onBeforeGetSessionToken=n,this.setSessionToken(null,0)}var t=e.prototype;return t.setSessionToken=function(e,t){Yl("set session token",e,t);var n=new ds(e,1e3*t);return this._sessionToken=n,delete this._pendingSessionTokenPromise,n},t.setSessionTokenAsync=function(){var e=Ti(_i.mark((function e(t){var n,r=this;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._sessionToken,this._pendingSessionTokenPromise=t.catch((function(e){throw r._sessionToken=n,e})),e.t0=this.setSessionToken,e.t1=this,e.t2=Pi,e.next=7,this._pendingSessionTokenPromise;case 7:return e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.abrupt("return",e.t0.apply.call(e.t0,e.t1,e.t4));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getSessionToken=function(){var e=Ti(_i.mark((function e(){var t,n,r,i,o,s,a,u,c=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:{},n=t.autoRefresh,r=void 0===n||n,Yl("get session token"),this._onBeforeGetSessionToken&&this._onBeforeGetSessionToken(this),e.t0=this._sessionToken,e.t0){e.next=8;break}return e.next=7,this._pendingSessionTokenPromise;case 7:e.t0=e.sent;case 8:if(i=e.t0,o=i.value,s=i.originalValue,o!==ds.EXPIRED||!r||!this.refresh){e.next=19;break}return Yl("refresh expired session token"),e.next=15,this.setSessionTokenAsync(this.refresh(this,s));case 15:return a=e.sent,u=a.value,Yl("session token",u),e.abrupt("return",u);case 19:return Yl("session token",o),e.abrupt("return",o);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.revoke=function(){this._sessionToken&&(this._sessionToken.expiredAt=-1)},e}();function zl(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zl(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):zl(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var Gl,$l=Wi("LC:IMClient"),Jl=function(e){return/^_tmp:/.test(e)},Zl=(Ll=Bs(1e3),jl=Bs(1e3),Qo((Fl=function(e){function t(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if(void 0!==t&&"string"!=typeof t)throw new TypeError("Client id [".concat(t,"] is not a String"));if(n=e.call(this)||this,Er(ji(n),{id:t,options:r},i),!n._messageParser)throw new Error("IMClient must be initialized with a MessageParser");return n._conversationCache=new vs("client:".concat(n.id)),n._ackMessageBuffer={},Rs(ji(n)).lastPatchTime=cn(),Rs(ji(n)).lastNotificationTime=void 0,Rs(ji(n))._eventemitter=new yi,$l.enabled&&Wo(Hf).forEach((function(e){return n.on(e,(function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n._debug("".concat(e," event emitted. %o"),r)}))})),fa(n._plugins.onIMClientCreate,ji(n)),n}Fi(t,e);var n=t.prototype;return n._debug=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];$l.apply(void 0,t.concat(["[".concat(this.id,"]")]))},n._dispatchCommand=function(){var e=Ti(_i.mark((function e(t){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._debug(Ls(t),"received"),t.serverTs&&1===t.notificationType&&(Rs(this).lastNotificationTime=Ss(Ts(t.serverTs))),e.t0=t.cmd,e.next=e.t0===di.conv?5:e.t0===di.direct?6:e.t0===di.session?7:e.t0===di.unread?8:e.t0===di.rcp?9:e.t0===di.patch?10:11;break;case 5:return e.abrupt("return",this._dispatchConvMessage(t));case 6:return e.abrupt("return",this._dispatchDirectMessage(t));case 7:return e.abrupt("return",this._dispatchSessionMessage(t));case 8:return e.abrupt("return",this._dispatchUnreadMessage(t));case 9:return e.abrupt("return",this._dispatchRcpMessage(t));case 10:return e.abrupt("return",this._dispatchPatchMessage(t));case 11:return e.abrupt("return",this.emit("unhandledmessage",t));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._dispatchSessionMessage=function(){var e=Ti(_i.mark((function e(t){var n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.sessionMessage,r=n.code,i=n.reason,e.t0=t.op,e.next=e.t0===mi.closed?4:8;break;case 4:if(Rs(this)._eventemitter.emit("close"),r!==ta.SESSION_CONFLICT){e.next=7;break}return e.abrupt("return",this.emit("conflict",{reason:i}));case 7:return e.abrupt("return",this.emit("close",{code:r,reason:i}));case 8:throw this.emit("unhandledmessage",t),new Error("Unrecognized session command");case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._dispatchUnreadMessage=function(e){var t=this,n=e.unreadMessage,r=n.convs,i=n.notifTime;return Rs(this).lastUnreadNotifTime=i,this.getConversations(r.map((function(e){return e.cid}))).then((function(){return wr.all(r.map((function(e){var n,r=e.cid,i=e.unread,o=e.mid,s=e.timestamp,a=e.from,u=e.data,c=e.binaryMsg,f=e.patchTimestamp,l=e.mentioned,h=t._conversationCache.get(r);return h?(s&&(n=Ts(s),h.lastMessageAt=n),(o?t._messageParser.parse(c||u).then((function(e){Er(e,{id:o,cid:r,timestamp:n,updatedAt:f,from:a}),h.lastMessage=e})):wr.resolve()).then((function(){return h._setUnreadMessagesMentioned(l),i===Rs(h).unreadMessagesCount?null:(Rs(h).unreadMessagesCount=i,h)}))):null}))).then((function(e){return e.filter((function(e){return e}))}))})).then((function(e){e.length&&t.emit("unreadmessagescountupdate",e)}))},n._dispatchRcpMessage=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.rcpMessage,r=t.rcpMessage.read,i=n.cid,o=n.id,s=Ts(n.t),a=this._conversationCache.get(i)){e.next=7;break}return e.abrupt("return");case 7:a._handleReceipt({messageId:o,timestamp:s,read:r});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._dispatchPatchMessage=function(e){var t=this,n=e.patchMessage.patches;return this.getConversations(n.map((function(e){return e.cid}))).then((function(){return wr.all(n.map((function(e){var n=e.cid,r=e.mid,i=e.timestamp,o=e.recall,s=e.data,a=e.patchTimestamp,u=e.from,c=e.binaryMsg,f=e.mentionAll,l=e.mentionPids,h=e.patchCode,p=e.patchReason,d=t._conversationCache.get(n);return d?t._messageParser.parse(c||s).then((function(e){var s,c=Ss(Ts(a));Er(e,{id:r,cid:n,timestamp:i,updatedAt:c,from:u,mentionList:l,mentionedAll:f}),e._setStatus(tl.SENT),e._updateMentioned(t.id),Rs(t).lastPatchTime<c&&(Rs(t).lastPatchTime=c),d.lastMessage&&d.lastMessage.id===r&&(d.lastMessage=e),h&&(s={code:h.toNumber(),detail:p}),o?(t.emit("messagerecall",e,d,s),d.emit("messagerecall",e,s)):(t.emit("messageupdate",e,d,s),d.emit("messageupdate",e,s))})):null})))}))},n._dispatchConvMessage=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a,u,c,f,l,h,p,d,m,v,g,y,b,w,_,E,T,S,I,A,O;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.convMessage,r=t.convMessage,i=r.initBy,o=r.m,s=r.info,a=r.attr,e.next=3,this.getConversation(n.cid);case 3:u=e.sent,e.t0=t.op,e.next=e.t0===mi.joined?7:e.t0===mi.left?12:e.t0===mi.members_joined?17:e.t0===mi.members_left?22:e.t0===mi.members_blocked?27:e.t0===mi.members_unblocked?31:e.t0===mi.blocked?35:e.t0===mi.unblocked?39:e.t0===mi.members_shutuped?43:e.t0===mi.members_unshutuped?47:e.t0===mi.shutuped?51:e.t0===mi.unshutuped?55:e.t0===mi.member_info_changed?59:e.t0===mi.updated?71:77;break;case 7:return u._addMembers([this.id]),c={invitedBy:i},this.emit("invited",c,u),u.emit("invited",c),e.abrupt("return");case 12:return u._removeMembers([this.id]),f={kickedBy:i},this.emit("kicked",f,u),u.emit("kicked",f),e.abrupt("return");case 17:return u._addMembers(o),l={invitedBy:i,members:o},this.emit("membersjoined",l,u),u.emit("membersjoined",l),e.abrupt("return");case 22:return u._removeMembers(o),h={kickedBy:i,members:o},this.emit("membersleft",h,u),u.emit("membersleft",h),e.abrupt("return");case 27:return p={blockedBy:i,members:o},this.emit("membersblocked",p,u),u.emit("membersblocked",p),e.abrupt("return");case 31:return d={unblockedBy:i,members:o},this.emit("membersunblocked",d,u),u.emit("membersunblocked",d),e.abrupt("return");case 35:return m={blockedBy:i},this.emit("blocked",m,u),u.emit("blocked",m),e.abrupt("return");case 39:return v={unblockedBy:i},this.emit("unblocked",v,u),u.emit("unblocked",v),e.abrupt("return");case 43:return g={mutedBy:i,members:o},this.emit("membersmuted",g,u),u.emit("membersmuted",g),e.abrupt("return");case 47:return y={unmutedBy:i,members:o},this.emit("membersunmuted",y,u),u.emit("membersunmuted",y),e.abrupt("return");case 51:return b={mutedBy:i},this.emit("muted",b,u),u.emit("muted",b),e.abrupt("return");case 55:return w={unmutedBy:i},this.emit("unmuted",w,u),u.emit("unmuted",w),e.abrupt("return");case 59:if(_=s.pid,E=s.role,T=Rs(u),T.memberInfoMap||E){e.next=63;break}return e.abrupt("return");case 63:return e.next=65,u.getMemberInfo(_);case 65:return S=e.sent,Rs(S).role=E,I={member:_,memberInfo:S,updatedBy:i},this.emit("memberinfoupdated",I,u),u.emit("memberinfoupdated",I),e.abrupt("return");case 71:return A=Is(JSON.parse(a.data)),u._updateServerAttributes(A),O={attributes:A,updatedBy:i},this.emit("conversationinfoupdated",O,u),u.emit("infoupdated",O),e.abrupt("return");case 77:throw this.emit("unhandledmessage",t),new Error("Unrecognized conversation command");case 79:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._dispatchDirectMessage=function(e){var t=this,n=e.directMessage,r=e.directMessage,i=r.id,o=r.cid,s=r.fromPeerId,a=r.timestamp,u=r.transient,c=r.patchTimestamp,f=r.mentionPids,l=r.mentionAll,h=r.binaryMsg,p=r.msg,d=h?h.toArrayBuffer():p;return wr.all([this.getConversation(n.cid),this._messageParser.parse(d)]).then((function(e){var n=Oa(e,2),r=n[0],h=n[1];if(r)return Er(h,{id:i,cid:o,timestamp:a,updatedAt:c,from:s,mentionList:f,mentionedAll:l}),h._updateMentioned(t.id),h._setStatus(tl.SENT),h.from!==t.id&&(u||r.transient||t._sendAck(h)),t._dispatchParsedMessage(h,r)}))},n._dispatchParsedMessage=function(e,t){var n=this;return ha(this._plugins.beforeMessageDispatch,[e,t]).then((function(r){!1!==r&&(t.lastMessage=e,t.lastMessageAt=e.timestamp,e.from!==n.id&&(t.unreadMessagesCount+=1,e.mentioned&&t._setUnreadMessagesMentioned(!0)),n.emit("message",e,t),t.emit("message",e))}))},n._sendAck=function(e){this._debug("send ack for %O",e);var t=e.cid;if(!t)throw new Error("missing cid");return this._ackMessageBuffer[t]||(this._ackMessageBuffer[t]=[]),this._ackMessageBuffer[t].push(e),this._doSendAck()},n._doSendAck=function(){var e=this;this._connection.is("connected")&&(this._debug("do send ack %O",this._ackMessageBuffer),wr.all(un(this._ackMessageBuffer).map((function(t){var n=e._ackMessageBuffer[t],r=n.map((function(e){return e.timestamp})),i=new ci({cmd:"ack",peerId:e.id,ackMessage:new Hr({cid:t,fromts:Math.min.apply(null,r),tots:Math.max.apply(null,r)})});return delete e._ackMessageBuffer[t],e._send(i,!1).catch((function(r){e._debug("send ack failed: %O",r),e._ackMessageBuffer[t]=n}))}))))},n._omitPeerId=function(e){Rs(this).peerIdOmittable=e},n._send=function(e){var t,n=e;!Rs(this).peerIdOmittable&&this.id&&(n.peerId=this.id);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return(t=this._connection).send.apply(t,[n].concat(i))},n._open=function(){var e=Ti(_i.mark((function e(t,n,r){var i,o,s,a,u,c,f,l,h,p,d,m,v,g,y,b,w,_,E=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=E.length>3&&void 0!==E[3]&&E[3],this._debug("open session"),o=Rs(this),s=o.lastUnreadNotifTime,a=o.lastPatchTime,u=o.lastNotificationTime,c=new ci({cmd:"session",op:"open",appId:t,peerId:this.id,sessionMessage:new Zr({ua:"js/".concat("5.0.0-rc.3"),r:i,lastUnreadNotifTime:s,lastPatchTime:a,configBitmap:59})}),i){e.next=13;break}if(Er(c.sessionMessage,Ls({tag:n,deviceId:r})),!this.options.signatureFactory){e.next=11;break}return e.next=9,Tl(this.options.signatureFactory,[this._identity]);case 9:f=e.sent,Er(c.sessionMessage,Os({signature:"s",timestamp:"t",nonce:"n"},f));case 11:e.next=17;break;case 13:return e.next=15,this._sessionManager.getSessionToken({autoRefresh:!1});case 15:(l=e.sent)&&l!==ds.EXPIRED&&Er(c.sessionMessage,{st:l});case 17:return e.prev=17,e.next=20,this._send(c);case 20:h=e.sent,e.next=32;break;case 23:if(e.prev=23,e.t0=e.catch(17),e.t0.code!==ta.SESSION_TOKEN_EXPIRED){e.next=31;break}if(this._sessionManager){e.next=28;break}throw new Error("Unexpected session expiration");case 28:return $l("Session token expired, reopening"),this._sessionManager.revoke(),e.abrupt("return",this._open(t,n,r,i));case 31:throw e.t0;case 32:if(d=(p=h).peerId,m=p.sessionMessage,v=p.sessionMessage,g=v.st,y=v.stTtl,b=v.code,w=p.serverTs,!b){e.next=35;break}throw na(m);case 35:return d?(this.id=d,this._identity||(this._identity=d),g&&(this._sessionManager=this._sessionManager||this._createSessionManager(),this._sessionManager.setSessionToken(g,y)),_=Ss(Ts(w)),w&&(Rs(this).lastPatchTime=_),u?this._syncNotifications(u).catch((function(e){return console.warn("Syncing notifications failed:",e)})):Rs(this).lastNotificationTime=_):console.warn("Unexpected session opened without peerId."),e.abrupt("return",void 0);case 37:case"end":return e.stop()}}),e,this,[[17,23]])})));return function(t,n,r){return e.apply(this,arguments)}}(),n._syncNotifications=function(){var e=Ti(_i.mark((function e(t){var n,r,i=this;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchNotifications(t);case 2:if(n=e.sent,r=n.hasMore,n.notifications.forEach((function(e){var t=e.cmd,n=e.op,r=e.serverTs,o=e.notificationType,s=Li(e,["cmd","op","serverTs","notificationType"]);i._dispatchCommand(Ur({cmd:di[t],op:mi[n],serverTs:r,notificationType:o},"".concat(t,"Message"),s))})),!r){e.next=8;break}return e.abrupt("return",this._syncNotifications(Rs(this).lastNotificationTime));case 8:return e.abrupt("return",void 0);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._fetchNotifications=function(){var e=Ti(_i.mark((function e(t){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._requestWithSessionToken({method:"GET",path:"/rtm/notifications",query:{start_ts:t,notification_type:"permanent"}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._createSessionManager=function(){var e=this;return $l("create SessionManager"),new ql({onBeforeGetSessionToken:this._connection.checkConnectionAvailability.bind(this._connection),refresh:function(t,n){return t.setSessionTokenAsync(wr.resolve(new ci({cmd:"session",op:"refresh",sessionMessage:new Zr({ua:"js/".concat("5.0.0-rc.3"),st:n})})).then(function(){var t=Ti(_i.mark((function t(n){var r;return _i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.options.signatureFactory){t.next=5;break}return t.next=3,Tl(e.options.signatureFactory,[e._identity]);case 3:r=t.sent,Er(n.sessionMessage,Os({signature:"s",timestamp:"t",nonce:"n"},r));case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).then(e._send.bind(e)).then((function(e){var t=e.sessionMessage;return[t.st,t.stTtl]})))}})},n._requestWithSessionToken=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.headers,r=t.query,i=Li(t,["headers","query"]),e.next=3,this._sessionManager.getSessionToken();case 3:return o=e.sent,e.abrupt("return",this._request(Wl({headers:Wl({"X-LC-IM-Session-Token":o},n),query:Wl({client_id:this.id},r)},i)));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.close=function(){var e=Ti(_i.mark((function e(){var t,n;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._debug("close session"),(t=Rs(this)._eventemitter).emit("beforeclose"),!this._connection.is("connected")){e.next=7;break}return n=new ci({cmd:"session",op:"close"}),e.next=7,this._send(n);case 7:t.emit("close"),this.emit("close",{code:0});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.ping=function(){var e=Ti(_i.mark((function e(t){var n,r;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._debug("ping"),t instanceof Array){e.next=3;break}throw new TypeError("clientIds ".concat(t," is not an Array"));case 3:if(t.length){e.next=5;break}return e.abrupt("return",wr.resolve([]));case 5:return n=new ci({cmd:"session",op:"query",sessionMessage:new Zr({sessionPeerIds:t})}),e.next=8,this._send(n);case 8:return r=e.sent,e.abrupt("return",r.sessionMessage.onlineSessionPeerIds);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getConversation=function(){var e=Ti(_i.mark((function e(t){var n,r,i=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]&&i[1],"string"==typeof t){e.next=3;break}throw new TypeError("".concat(t," is not a String"));case 3:if(n){e.next=7;break}if(!(r=this._conversationCache.get(t))){e.next=7;break}return e.abrupt("return",r);case 7:if(!Jl(t)){e.next=14;break}return e.next=10,this._getTemporaryConversations([t]);case 10:if(e.t0=e.sent[0],e.t0){e.next=13;break}e.t0=null;case 13:return e.abrupt("return",e.t0);case 14:return e.abrupt("return",this.getQuery().equalTo("objectId",t).find().then((function(e){return e[0]||null})));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getConversations=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a=this,u=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]&&u[1],!(r=n?t:t.filter((function(e){return null===a._conversationCache.get(e)}))).length){e.next=9;break}return i=Zc(r,Jl),o=[],r.length&&o.push(this.getQuery().containedIn("objectId",r).limit(999).find()),i.length&&(s=i.map(this._getTemporaryConversations.bind(this)),o.push.apply(o,Pi(s))),e.next=9,wr.all(o);case 9:return e.abrupt("return",t.map((function(e){return a._conversationCache.get(e)})));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._getTemporaryConversations=function(){var e=Ti(_i.mark((function e(t){var n,r;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ci({cmd:"conv",op:"query",convMessage:new ei({tempConvIds:t})}),e.next=3,this._send(n);case 3:return r=e.sent,e.abrupt("return",this._handleQueryResults(r));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getQuery=function(){return new Vl(this)},n.getChatRoomQuery=function(){return this.getQuery().equalTo("tr",!0)},n.getServiceConversationQuery=function(){return this.getQuery().equalTo("sys",!0)},n._executeQuery=function(){var e=Ti(_i.mark((function e(t){var n,r,i;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.toJSON()).where=new Wr({data:wi(As(n.where))}),r=new ci({cmd:"conv",op:"query",convMessage:new ei(n)}),e.next=5,this._send(r);case 5:return i=e.sent,e.abrupt("return",this._handleQueryResults(i));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._handleQueryResults=function(){var e=Ti(_i.mark((function e(t){var n,r;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=Is(JSON.parse(t.convMessage.results.data)),e.next=8;break;case 4:throw e.prev=4,e.t0=e.catch(0),r=wi(Ls(t)),new Error("Parse query result failed: ".concat(e.t0.message,". Command: ").concat(r));case 8:return e.next=10,wr.all(n.map(this._parseConversationFromRawData.bind(this)));case 10:return n=e.sent,e.abrupt("return",n.map(this._upsertConversationToCache.bind(this)));case 12:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(t){return e.apply(this,arguments)}}(),n._upsertConversationToCache=function(e){var t=this._conversationCache.get(e.id);return t?(this._debug("update cached conversation"),["creator","createdAt","updatedAt","lastMessageAt","lastMessage","mutedMembers","members","_attributes","transient","muted"].forEach((function(n){var r=e[n];void 0!==r&&(t[n]=r)})),t._reset&&t._reset()):(t=e,this._debug("no match, set cache"),this._conversationCache.set(e.id,e)),t},n.parseMessage=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.data,r=t.bin,i=void 0!==r&&r,o=Li(t,["data","bin"]),s=i?xa(n):n,e.next=4,this._messageParser.parse(s);case 4:return a=e.sent,Er(a,o),a._updateMentioned(this.id),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.parseConversation=function(){var e=Ti(_i.mark((function e(t){var n,r,i,o,s,a,u,c,f,l,h,p,d;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.lastMessageAt,i=t.lastMessage,o=t.lastDeliveredAt,s=t.lastReadAt,a=t.unreadMessagesCount,u=t.members,c=t.mentioned,f=Li(t,["id","lastMessageAt","lastMessage","lastDeliveredAt","lastReadAt","unreadMessagesCount","members","mentioned"]),l={id:n,lastMessageAt:r,lastMessage:i,lastDeliveredAt:o,lastReadAt:s,unreadMessagesCount:a,members:u,mentioned:c},!i){e.next=7;break}return e.next=5,this.parseMessage(i);case 5:l.lastMessage=e.sent,l.lastMessage._setStatus(tl.SENT);case 7:if(h=f.transient,p=f.system,d=f.expiredAt,!h){e.next=10;break}return e.abrupt("return",new kl(l,f,this));case 10:if(!p){e.next=12;break}return e.abrupt("return",new Pl(l,f,this));case 12:if(!d&&!Jl(n)){e.next=14;break}return e.abrupt("return",new Bl(l,{expiredAt:d},this));case 14:return e.abrupt("return",new xl(l,f,this));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._parseConversationFromRawData=function(){var e=Ti(_i.mark((function e(t){var n,r;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Os({objectId:"id",lm:"lastMessageAt",m:"members",tr:"transient",sys:"system",c:"creator",mu:"mutedMembers"},t)).msg&&(n.lastMessage={data:n.msg,bin:n.bin,from:n.msg_from,id:n.msg_mid,timestamp:n.msg_timestamp,updatedAt:n.patch_timestamp},delete n.lastMessageFrom,delete n.lastMessageId,delete n.lastMessageTimestamp,delete n.lastMessagePatchTimestamp),(r=n.ttl)&&(n.expiredAt=cn()+1e3*r),e.abrupt("return",this.parseConversation(n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createConversation=function(){var e=Ti(_i.mark((function e(){var t,n,r,i,o,s,a,u,c,f,l,h,p,d,m,v,g,y,b,w,_,E=arguments;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=E.length>0&&void 0!==E[0]?E[0]:{},n=t.members,r=t.name,i=t.transient,o=t.unique,s=void 0===o||o,a=t._tempConv,u=t._tempConvTTL,c=Li(t,["members","name","transient","unique","_tempConv","_tempConvTTL"]),i||P(n)){e.next=3;break}throw new TypeError("conversation members ".concat(n," is not an array"));case 3:if((f=new Ri(n)).add(this.id),f=Ai(f).sort(),l=c||{},!r){e.next=11;break}if("string"==typeof r){e.next=10;break}throw new TypeError("conversation name ".concat(r," is not a string"));case 10:l.name=r;case 11:if(l=new Wr({data:wi(As(l))}),h=new ci({cmd:"conv",op:"start",convMessage:new ei({m:f,attr:l,transient:i,unique:s,tempConv:a,tempConvTTL:u})}),!this.options.conversationSignatureFactory){e.next=20;break}return p=[null,this._identity,f,"create"],e.next=18,Tl(this.options.conversationSignatureFactory,p);case 18:d=e.sent,Er(h.convMessage,Os({signature:"s",timestamp:"t",nonce:"n"},d));case 20:return e.next=22,this._send(h);case 22:return m=e.sent,v=m.convMessage,g=v.cid,y=v.cdate,b=v.tempConvTTL,w=Wl({name:r,transient:i,unique:s,id:g,createdAt:y,updatedAt:y,lastMessageAt:null,creator:this.id,members:i?[]:f},c),b&&(w.expiredAt=cn()+1e3*b),e.next=31,this.parseConversation(w);case 31:return _=e.sent,e.abrupt("return",this._upsertConversationToCache(_));case 33:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.createChatRoom=function(){var e=Ti(_i.mark((function e(t){return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createConversation(Wl(Wl({},t),{},{transient:!0,members:null,unique:!1,_tempConv:!1})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createTemporaryConversation=function(){var e=Ti(_i.mark((function e(t){var n,r;return _i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ttl,r=Li(t,["ttl"]),e.abrupt("return",this.createConversation(Wl(Wl({},r),{},{transient:!1,unique:!1,_tempConv:!0,_tempConvTTL:n})));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._doSendRead=function(){var e=this;if(this._connection.is("connected")){var t=Rs(this).readConversationsBuffer,n=Ai(t);if(n.length){var r=n.map((function(e){if(!(e instanceof wl))throw new TypeError("".concat(e," is not a Conversation"));return e.id}));this._debug("mark [".concat(r,"] as read")),t.clear(),this._sendReadCommand(n).catch((function(r){e._debug("send read failed: %O",r),n.forEach(t.add.bind(t))}))}}},n._sendReadCommand=function(e){var t=this;return this._send(new ci({cmd:"read",readMessage:new si({convs:e.map((function(e){return new ii({cid:e.id,mid:e.lastMessage&&e.lastMessage.from!==t.id?e.lastMessage.id:void 0,timestamp:(e.lastMessageAt||new Date).getTime()})}))})}),!1)},t}(yi)).prototype,"_doSendAck",[Ll],an(Fl.prototype,"_doSendAck"),Fl.prototype),Qo(Fl.prototype,"_doSendRead",[jl],an(Fl.prototype,"_doSendRead"),Fl.prototype),Fl),Kl=Object.freeze({__proto__:null,RECONNECT_ERROR:"reconnecterror",DISCONNECT:qs,RECONNECT:zs,RETRY:Ws,SCHEDULE:Gs,OFFLINE:$s,ONLINE:Js});function Xl(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xl(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):Xl(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var Ql,eh,th=al(Gl=function(e){function t(t){if(!(t instanceof ArrayBuffer))throw new TypeError("".concat(t," is not an ArrayBuffer"));return e.call(this,t)||this}Fi(t,e),t.validate=function(e){return e instanceof ArrayBuffer};var n=t.prototype;return n.toJSON=function(){return Hl(Hl({},e.prototype._toJSON.call(this)),{},{data:Ma(this.content)})},n.toFullJSON=function(){return Hl(Hl({},e.prototype.toFullJSON.call(this)),{},{bin:!0,data:Ma(this.content)})},Ho(t,[{key:"buffer",get:function(){return this.content},set:function(e){this.content=e}}]),t}(il))||Gl,nh=ol(-1)(Ql=al(Ql=function(e){function t(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("string"!=typeof n)throw new TypeError("".concat(n," is not a string"));return(t=e.call(this)||this).setText(n),t}return Fi(t,e),t}(ll))||Ql)||Ql;function rh(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function ih(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rh(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):rh(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}function oh(e,t){var n;if(void 0===en||null==e[lt]){if(P(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return sh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Ai(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sh(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=Ia(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function sh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ah=Wi("LC:MessageParser"),uh=(Qo((eh=function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._plugins=e,this._messageClasses=[],this.register(e.messageClasses)}var t=e.prototype;return t.register=function(e){var t=this;js(e).map((function(e){return t._register(e)}))},t._register=function(e){if(!(e&&e.parse&&e.prototype&&e.prototype.getPayload))throw new TypeError("Invalid messageClass");this._messageClasses.unshift(e)},t.parse=function(e){ah("parsing message: %O",e);var t,n=oh(this._messageClasses);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=fs(e)?ih({},e):e,o=void 0,s=void 0;try{o=r.validate(i)}catch(e){}if(o){try{s=r.parse(i)}catch(e){console.warn("parsing a valid message content error",{error:e,Klass:r,content:i})}if(void 0!==s)return ah("parse result: %O",s),s}}}catch(e){n.e(e)}finally{n.f()}throw new Error("No Message Class matched")},e}()).prototype,"parse",[function(e,t,n){var r=n.value;n.value=function(e){var t;if("string"!=typeof e)t=e;else try{t=JSON.parse(e)}catch(n){t=e}return r.call(this,t)}},function(e,t,n){var r=n.value;n.value=function(e){var t=this;return wr.resolve(e).then(la(this._plugins.beforeMessageParse)).then((function(e){return r.call(t,e)})).then(la(this._plugins.afterMessageParse))}}],an(eh.prototype,"parse"),eh.prototype),eh);function ch(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function fh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ch(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):ch(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}var lh=Wi("LC:IMPlugin"),hh={HIGH:1,NORMAL:2,LOW:3};Qs(hh);var ph=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{get:function(){return this.get(e)},set:function(t){this.set(e,t)}};xr(xl.prototype,e,t)},dh={name:"leancloud-realtime-plugin-im",onRealtimeCreate:function(e){var t=Sa();e._IMClients={},e._IMClientsCreationCount=0;var n=new uh(e._plugins);e._messageParser=n;var r=function(){var t=Ti(_i.mark((function t(n){return _i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._request({method:"POST",path:"/rtm/sign",data:{session_token:n.getSessionToken()}}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i=n.register.bind(n),o=function(){var i=Ti(_i.mark((function i(o){var s,a,u,c,f,l,h,p,d,m,v=arguments;return _i.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=v.length>1&&void 0!==v[1]?v[1]:{},u=a.tag,c=a.isReconnect,f=Li(a,["tag","isReconnect"]),l=v.length>2?v[2]:void 0,p={},!o){i.next=19;break}if("string"!=typeof o){i.next=8;break}h=o,i.next=17;break;case 8:if(!o.id||!o.getSessionToken){i.next=16;break}if(h=o.id,o.getSessionToken()){i.next=13;break}throw new Error("User must be authenticated");case 13:p.signatureFactory=r,i.next=17;break;case 16:throw new TypeError("Identity must be a String or an AV.User");case 17:if(void 0===e._IMClients[h]){i.next=19;break}return i.abrupt("return",e._IMClients[h]);case 19:return l&&console.warn("DEPRECATION createIMClient tag param: Use options.tag instead."),d=u||l,m=(s=e._open().then((function(r){var i=new Zl(h,fh(fh({},p),f),{_connection:r,_request:e._request.bind(e),_messageParser:n,_plugins:e._plugins,_identity:o});return r.on(zs,(function(){return i._open(e._options.appId,d,t,!0).then((function(){return i.emit(zs)}),(function(e){return i.emit("reconnecterror",e)}))})),Rs(i)._eventemitter.on("beforeclose",(function(){delete e._IMClients[i.id],e._firstIMClient===i&&delete e._firstIMClient}),e),Rs(i)._eventemitter.on("close",(function(){e._deregister(i)}),e),i._open(e._options.appId,d,t,c).then((function(){return e._IMClients[i.id]=i,e._IMClientsCreationCount+=1,1===e._IMClientsCreationCount?(i._omitPeerId(!0),e._firstIMClient=i):e._IMClientsCreationCount>1&&e._firstIMClient&&e._firstIMClient._omitPeerId(!1),e._register(i),i})).catch((function(t){throw delete e._IMClients[i.id],t}))}))).then.apply(s,Pi(Es((function(){e._deregisterPending(m)})))),o&&(e._IMClients[h]=m),e._registerPending(m),i.abrupt("return",m);case 25:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}();Er(e,{register:i,createIMClient:o})},beforeCommandDispatch:function(e,t){if(!(null===e.service||2===e.service))return!0;var n=e.peerId?t._IMClients[e.peerId]:t._firstIMClient;return n?wr.resolve(n).then((function(t){return t._dispatchCommand(e)})).catch(lh):lh("[WARN] Unexpected message received without any live client match: %O",Ls(e)),!1},messageClasses:[il,th,hl,nh]};function mh(e,t){var n=un(e);if(_r){var r=_r(e);t&&(r=r.filter((function(t){return an(e,t).enumerable}))),n.push.apply(n,r)}return n}function vh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mh(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Br?Lr(e,Br(n)):mh(Object(n)).forEach((function(t){xr(e,t,an(n,t))}))}return e}ya.defineConversationProperty=ph,ya.__preRegisteredPlugins=[dh];var gh=vh(vh({},Kl),Hf);rs({WebSocket:Pr,request:Rr}),e.BinaryMessage=th,e.ChatRoom=kl,e.Conversation=xl,e.ConversationMemberRole=Cl,e.ConversationQuery=Vl,e.ErrorCode=ta,e.Event=gh,e.EventEmitter=yi,e.IE10Compatible=al,e.IMPlugin=dh,e.Message=il,e.MessageParser=uh,e.MessagePriority=hh,e.MessageQueryDirection=bl,e.MessageStatus=tl,e.Promise=ba,e.Protocals=gi,e.Protocols=gi,e.Realtime=ya,e.RecalledMessage=hl,e.ServiceConversation=Pl,e.TemporaryConversation=Bl,e.TextMessage=nh,e.TypedMessage=ll,e.debug=ws,e.defineConversationProperty=ph,e.getAdapter=ns,e.messageField=sl,e.messageType=ol,e.setAdapters=rs,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=im-weapp.min.js.map
