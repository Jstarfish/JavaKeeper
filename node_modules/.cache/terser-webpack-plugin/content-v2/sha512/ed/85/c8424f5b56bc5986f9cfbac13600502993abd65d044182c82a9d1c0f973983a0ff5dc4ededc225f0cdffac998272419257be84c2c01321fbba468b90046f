{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{550:function(n,e,t){n.exports=t.p+\"assets/img/nginx-index.2f334ee5.png\"},551:function(n,e,t){n.exports=t.p+\"assets/img/forward-proxy.da80da62.png\"},552:function(n,e,t){n.exports=t.p+\"assets/img/reverse-proxy.8237c4f6.png\"},553:function(n,e,t){n.exports=t.p+\"assets/img/nginx-t.32a9727a.png\"},554:function(n,e,t){n.exports=t.p+\"assets/img/welcome-nginx.4ab06374.png\"},555:function(n,e,t){n.exports=t.p+\"assets/img/tomcat-index.2bf778ed.png\"},556:function(n,e,t){n.exports=t.p+\"assets/img/nginx-demo1.7e13f536.png\"},557:function(n,e,t){n.exports=t.p+\"assets/img/demo2.03c287f3.png\"},558:function(n,e,t){n.exports=t.p+\"assets/img/nginx-tomcat.79dca8df.png\"},559:function(n,e,t){n.exports=t.p+\"assets/img/nginx-separation.abf3e61e.png\"},560:function(n,e){n.exports=\"data:image/png;base64,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\"},561:function(n,e,t){n.exports=t.p+\"assets/img/nginx-static.1854c77b.png\"},562:function(n,e,t){n.exports=t.p+\"assets/img/nginx-rewrite.b590f228.jpg\"},563:function(n,e,t){n.exports=t.p+\"assets/img/nginx-availability.889ef81f.png\"},564:function(n,e,t){n.exports=t.p+\"assets/img/nginx-work.43492ec3.png\"},565:function(n,e,t){n.exports=t.p+\"assets/img/nginx-process.1c0e072b.png\"},566:function(n,e,t){n.exports=t.p+\"assets/img/nginx-module.384da8f4.png\"},793:function(n,e,t){\"use strict\";t.r(e);var r=t(6),a=Object(r.a)({},(function(){var n=this,e=n.$createElement,r=n._self._c||e;return r(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":n.$parent.slotKey}},[r(\"p\",[r(\"img\",{attrs:{src:t(550),alt:\"\"}})]),n._v(\" \"),r(\"h1\",{attrs:{id:\"nginx-学习一路向西\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nginx-学习一路向西\"}},[n._v(\"#\")]),n._v(\" Nginx 学习一路向西\")]),n._v(\" \"),r(\"blockquote\",[r(\"p\",[n._v(\"Java大猿帅成长手册，\"),r(\"strong\",[n._v(\"GitHub\")]),n._v(\" \"),r(\"a\",{attrs:{href:\"https://github.com/Jstarfish/JavaEgg\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"JavaEgg\"),r(\"OutboundLink\")],1),n._v(\" ，N线互联网开发必备技能兵器谱\")])]),n._v(\" \"),r(\"h2\",{attrs:{id:\"_1-nginx简介\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-nginx简介\"}},[n._v(\"#\")]),n._v(\" 1. Nginx简介\")]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_1-1-nginx-概述\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-1-nginx-概述\"}},[n._v(\"#\")]),n._v(\" 1.1 Nginx 概述\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[r(\"p\",[n._v(\"NGINX是一个免费、开源、高性能、轻量级的HTTP和反向代理服务器，也是一个电子邮件（IMAP/POP3）代理服务器，其特点是占有内存少，并发能力强。 Nginx 因为它的稳定性、丰富的模块库、灵活的配置和较低的资源消耗而闻名 。目前应该是几乎所有项目建设必备。\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"Nginx由内核和一系列模块组成，内核提供web服务的基本功能，如启用网络协议，创建运行环境，接收和分配客户端请求，处理模块之间的交互。Nginx的各种功能和操作都由模块来实现。Nginx的模块从结构上分为核心模块、基础模块和第三方模块。\")]),n._v(\" \"),r(\"p\",[n._v(\"核心模块： HTTP模块、EVENT模块和MAIL模块\")]),n._v(\" \"),r(\"p\",[n._v(\"基础模块： HTTP Access模块、HTTP FastCGI模块、HTTP Proxy模块和HTTP Rewrite模块\")]),n._v(\" \"),r(\"p\",[n._v(\"第三方模块： HTTP Upstream Request Hash模块、Notice模块和HTTP Access Key模块及用户自己开发的模块\")]),n._v(\" \"),r(\"p\",[n._v(\"这样的设计使Nginx方便开发和扩展，也正因此才使得Nginx功能如此强大。Nginx的模块默认编译进nginx中，如果需要增加或删除模块，需要重新编译Nginx,这一点不如Apache的动态加载模块方便。如果有需要动态加载模块，可以使用由淘宝网发起的web服务器Tengine，在nginx的基础上增加了很多高级特性，完全兼容Nginx，已被国内很多网站采用。\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"Nginx有很多扩展版本\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"开源版  \"),r(\"a\",{attrs:{href:\"http://nginx.org/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"nginx.org\"),r(\"OutboundLink\")],1)]),n._v(\" \"),r(\"li\",[n._v(\"商业版 \"),r(\"a\",{attrs:{href:\"https://www.nginx.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"NGINX Plus\"),r(\"OutboundLink\")],1)]),n._v(\" \"),r(\"li\",[n._v(\"淘宝网发起的Web服务器 \"),r(\"a\",{attrs:{href:\"http://tengine.taobao.org/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"Tengine\"),r(\"OutboundLink\")],1)]),n._v(\" \"),r(\"li\",[n._v(\"基于Nginx和Lua的Web平台 \"),r(\"a\",{attrs:{href:\"http://openresty.org/cn/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"OpenResty\"),r(\"OutboundLink\")],1)])])])]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_1-2-nginx-作为-web-服务器\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-2-nginx-作为-web-服务器\"}},[n._v(\"#\")]),n._v(\" 1.2 Nginx 作为 web 服务器\")]),n._v(\" \"),r(\"p\",[n._v(\"Web服务器也称为WWW(WORLD WIDE WEB)服务器，主要功能是提供网上信息浏览服务，常常以B/S（Browser/Server）方式提供服务。\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"应用层使用HTTP协议。\")]),n._v(\" \"),r(\"li\",[n._v(\"HTML文档格式。\")]),n._v(\" \"),r(\"li\",[n._v(\"浏览器统一资源定位器(URL)。\")])]),n._v(\" \"),r(\"p\",[n._v(\"Nginx 可以作为静态页面的 web 服务器，同时还支持 CGI 协议的动态语言，比如 perl、php 等，但是不支持 java。Java 程序一般都通过与 Tomcat 配合完成。\")]),n._v(\" \"),r(\"p\",[n._v(\"作为一名Java猿帅，肯定要理解下Nginx和Tomcat的区别了：\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"Nginx、Apache和Tomcat\")])]),n._v(\" \"),r(\"ul\",[r(\"li\",[r(\"p\",[n._v(\"Nginx—— 由俄罗斯程序员Igor Sysoev所开发的轻量级、高并发HTTP服务器；\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[r(\"RouterLink\",{attrs:{to:\"/nginx/httpd.apache.org/\"}},[n._v(\"Apache HTTP Server Project\")]),n._v(\"，一个Apache基金会下的HTTP服务项目，和Nginx功能类似；\")],1)]),n._v(\" \"),r(\"li\",[r(\"p\",[r(\"a\",{attrs:{href:\"http://tomcat.apache.org/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"Apache Tomcat\"),r(\"OutboundLink\")],1),n._v(\" ，则是Apache基金会下的另外一个项目，是一个\"),r(\"strong\",[n._v(\"Application Server\")]),n._v(\"，更准确的说是一个\")]),n._v(\" \"),r(\"p\",[n._v(\"servlet应用容器，与Apache HTTP Server和Nginx相比，Tomcat能够\"),r(\"strong\",[n._v(\"动态\")]),n._v(\"的生成资源并返回到客户端；\")])])]),n._v(\" \"),r(\"p\",[n._v(\"Apache HTTP Server和Nginx本身不支持生成动态页面，但它们可以通过其他模块来支持（例如通过Shell、PHP、Python脚本程序来动态生成内容）；\")]),n._v(\" \"),r(\"p\",[n._v(\"一个 HTTP Server 关心的是 HTTP 协议层面的传输和访问控制，所以在 Apache/Nginx 上你可以看到代理、负载均衡等功能。客户端通过 HTTP Server 访问服务器上存储的资源（HTML 文件、图片文件等等）。通过 CGI 技术，也可以将处理过的内容通过 HTTP Server 分发，但是一个 HTTP Server 始终只是把服务器上的文件如实的通过 HTTP 协议传输给客户端。\")]),n._v(\" \"),r(\"p\",[n._v(\"而应用服务器，则是一个应用执行的容器。它首先需要支持开发语言的运行（对于 Tomcat 来说，就是 Java），保证应用能够在应用服务器上正常运行。其次，需要支持应用相关的规范，例如类库、安全方面的特性。对于 Tomcat 来说，就是需要提供 JSP/Sevlet 运行需要的标准类库、Interface 等。为了方便，应用服务器往往也会集成 HTTP Server 的功能，但是不如专业的 HTTP Server 那么强大，所以应用服务器往往是运行在 HTTP Server 的背后，执行应用，将动态的内容转化为静态的内容之后，通过 HTTP Server 分发到客户端。\")]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_1-3-正向代理\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-3-正向代理\"}},[n._v(\"#\")]),n._v(\" 1.3 正向代理\")]),n._v(\" \"),r(\"p\",[n._v(\"正向代理：如果把局域网外的 Internet 想象成一个巨大的资源库，则局域网中的客户端要访 问 Internet，则需要通过代理服务器来访问，这种代理服务就称为正向代理。\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"正向代理“代理”的是客户端\")]),n._v(\"。\")]),n._v(\" \"),r(\"p\",[n._v(\"比如你想去google看个“动作片”，可国内不允许呀，就需要找翻墙代理，这个就是所谓的”正向代理“。\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(551),alt:\"forward-proxy\"}})]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_1-4-反向代理-与-负载均衡\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-4-反向代理-与-负载均衡\"}},[n._v(\"#\")]),n._v(\" 1.4 反向代理 与 负载均衡\")]),n._v(\" \"),r(\"p\",[n._v(\"反向代理正好与正向代理相反，反向代理是指以代理服务器来接收Internet上的连接请求，然后将请求转发到内部网络上的服务器，并将服务器上得到的结果返回给客户端，此时代理服务器对外表现就是一个服务器，客户端对代理是无感知的。\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"反向代理“代理”的是服务端\")]),n._v(\"。\")]),n._v(\" \"),r(\"p\",[n._v(\"再比如，你想本本分分的在“优酷”上看个“爱情片”，youku.com会把你的请求分发到存放片片的那台机器上，这个就是所谓的”反向代理“。\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(552),alt:\"reverse-proxy\"}})]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"为什么使用反向代理\")])]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"保护和隐藏原始资源服务器\")]),n._v(\" \"),r(\"li\",[n._v(\"加密和SSL加速\")]),n._v(\" \"),r(\"li\",[n._v(\"通过缓存静态资源，加速Web请求\")]),n._v(\" \"),r(\"li\",[n._v(\"实现负载均衡\")])]),n._v(\" \"),r(\"h4\",{attrs:{id:\"负载均衡\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#负载均衡\"}},[n._v(\"#\")]),n._v(\" \"),r(\"strong\",[n._v(\"负载均衡\")])]),n._v(\" \"),r(\"p\",[n._v(\"TODO: 留一个负载均衡详细介绍传送门\")]),n._v(\" \"),r(\"h4\",{attrs:{id:\"地址重定向\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#地址重定向\"}},[n._v(\"#\")]),n._v(\" 地址重定向\")]),n._v(\" \"),r(\"p\",[n._v(\"Nginx 的Rewrite主要的功能就是实现URL重写\")]),n._v(\" \"),r(\"p\",[n._v(\"比如输入360.com  跳转到了360.cn，baidu.cn跳转到了baidu.com\")]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_1-5-动静分离\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-5-动静分离\"}},[n._v(\"#\")]),n._v(\" 1.5 动静分离\")]),n._v(\" \"),r(\"p\",[n._v(\"为了加快网站的解析速度，可以把动态页面和静态页面由不同的服务器来解析，加快解析速度，降低原来单个服务器的压力。 这里指的就是让动态程序（Java、PHP）去访问应用服务器，让缓存、图片、JS、CSS等去访问Nginx。\")]),n._v(\" \"),r(\"hr\"),n._v(\" \"),r(\"h2\",{attrs:{id:\"_2-nginx-安装\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-nginx-安装\"}},[n._v(\"#\")]),n._v(\" 2. Nginx 安装\")]),n._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[r(\"a\",{attrs:{href:\"http://nginx.org/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"下载Nginx\"),r(\"OutboundLink\")],1)]),n._v(\" \"),r(\"div\",{staticClass:\"language-sh extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[r(\"code\",[r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"wget\")]),n._v(\" http://nginx.org/download/nginx-1.16.1.tar.gz \\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"安装需要编译的插件\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[r(\"p\",[n._v(\"用于编译c、c++代码的GCC；\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"用c语言编写的正则表达式函数库Pcre(使用rewrite模块)；\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"用于数据压缩的函式库的Zlib；\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"安全套接字层密码库OpenSSL（启用SSL支持）\")])])]),n._v(\" \"),r(\"div\",{staticClass:\"language-sh extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[r(\"code\",[n._v(\"yum \"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"install\")]),n._v(\" gcc c++                                          \\nyum \"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"install\")]),n._v(\" -y pcre pcre-devel                          \\nyum \"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"install\")]),n._v(\" -y zlib zlib-devel                           \\nyum \"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"install\")]),n._v(\" -y openssl openssl-devel   \\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"解压、配置（Nginx支持各种配置选项,文末一一列出 \"),r(\"a\",{attrs:{href:\"#Nginx%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9\"}},[n._v(\"Nginx配置选项\")]),n._v(\" ）、编译、安装nginx\")]),n._v(\" \"),r(\"div\",{staticClass:\"language-sh extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[r(\"code\",[r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"tar\")]),n._v(\" -zxvf nginx-1.15.tar.gz \"),r(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[n._v(\"cd\")]),n._v(\" nginx-1.16.1\\n\"),r(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[n._v(\"cd\")]),n._v(\" nginx-1.16.1\\n./configure\\n\"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"make\")]),n._v(\" \"),r(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[n._v(\"&&\")]),n._v(\" \"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"sudo\")]),n._v(\" \"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"make\")]),n._v(\" \"),r(\"span\",{pre:!0,attrs:{class:\"token function\"}},[n._v(\"install\")]),n._v(\" \\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"启动、重启、关闭\")]),n._v(\" \"),r(\"div\",{staticClass:\"language-sh extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[r(\"code\",[r(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[n._v(\"cd\")]),n._v(\" /usr/local/nginx/ \\n\"),r(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[n._v(\"cd\")]),n._v(\" sbin\\n./nginx\\n\"),r(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[n._v(\"#关闭命令 \")]),n._v(\"\\n./nginx -s stop\\n\"),r(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[n._v(\"#重启，热部署\")]),n._v(\"\\n./nginx -s reload\\n\"),r(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[n._v(\"#修改配置文件后也别嘚瑟，反正我会动不动就写错，检查修改的nginx.conf配置是否正确\")]),n._v(\"\\n./nginx -t\\n\")])])]),r(\"p\",[r(\"img\",{attrs:{src:t(553),alt:\"nginx-t\"}})])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"验证（浏览器输入ip）\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(554),alt:\"welcome-nginx\"}})])])]),n._v(\" \"),r(\"hr\"),n._v(\" \"),r(\"h2\",{attrs:{id:\"_3-配置文件\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-配置文件\"}},[n._v(\"#\")]),n._v(\" 3. 配置文件\")]),n._v(\" \"),r(\"p\",[n._v(\"nginx.conf 配置文件主要分为三部分：全局块、events块、https块。\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"Nginx配置语法：\")])]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"配置文件由指令和指令块构成\")]),n._v(\" \"),r(\"li\",[n._v(\"每条指令以分号（;）结尾，指令和参数间以空格符分隔\")]),n._v(\" \"),r(\"li\",[n._v(\"指令块以大括号{}将多条指令组织在一起\")]),n._v(\" \"),r(\"li\",[n._v(\"include语句允许组合多个配置文件以提高可维护性\")]),n._v(\" \"),r(\"li\",[n._v(\"使用 # 添加注释\")]),n._v(\" \"),r(\"li\",[n._v(\"使用 $ 定义变量\")]),n._v(\" \"),r(\"li\",[n._v(\"部分指令的参数支持正则表达式\")])]),n._v(\" \"),r(\"h4\",{attrs:{id:\"_3-1-全局块\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-1-全局块\"}},[n._v(\"#\")]),n._v(\" 3.1 全局块\")]),n._v(\" \"),r(\"p\",[n._v(\"全局配置部分用来配置对整个server都有效的参数。主要会设置一些影响 nginx 服务器整体运行的配置指令，主要包括配置运行 Nginx 服务器的用户（组）、允许生成的 worker process 数，进程 PID 存放路径、日志存放路径和类型以 及配置文件的引入等。 示例：\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"user nobody;\\nworker_processes  4;\\nerror_log  /data/nginx/logs/error.log  notice; \\n\")])])]),r(\"h4\",{attrs:{id:\"_3-2-events-块\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-2-events-块\"}},[n._v(\"#\")]),n._v(\" 3.2 events 块\")]),n._v(\" \"),r(\"p\",[n._v(\"events 块涉及的指令主要影响 Nginx 服务器与用户的网络连接，常用的设置包括是否开启对多 work process 下的网络连接进行序列化，是否允许同时接收多个网络连接，选取哪种事件驱动模型来处理连接请求，每个 word process 可以同时支持的最大连接数等。\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"events {\\n\\t#每个 work process 支持的最大连接数为 1024.\\n    worker_connections  1024;\\n}\\n\")])])]),r(\"h4\",{attrs:{id:\"_3-3-http-块\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-3-http-块\"}},[n._v(\"#\")]),n._v(\" 3.3 http 块\")]),n._v(\" \"),r(\"p\",[n._v(\"这算是 Nginx 服务器配置中最频繁的部分，代理、缓存和日志定义等绝大多数功能和第三方模块的配置都在这里。 需要注意的是：http 块也可以包括 http 全局块、server 块。\")]),n._v(\" \"),r(\"h5\",{attrs:{id:\"_3-3-1-http-全局块\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-3-1-http-全局块\"}},[n._v(\"#\")]),n._v(\" 3.3.1 http 全局块\")]),n._v(\" \"),r(\"p\",[n._v(\"http 全局块配置的指令包括文件引入、MIME-TYPE 定义、日志自定义、连接超时时间、单链接请求数上限等。\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",[r(\"code\",[n._v(\"http {\\n    include       mime.types;\\n    default_type  application/octet-stream;\\n\\tsendfile        on;\\n\\tkeepalive_timeout  65;\\n\")])])]),r(\"h5\",{attrs:{id:\"_3-3-2-server-块\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-3-2-server-块\"}},[n._v(\"#\")]),n._v(\" 3.3.2 server 块\")]),n._v(\" \"),r(\"p\",[n._v(\"这块和虚拟主机有密切关系，虚拟主机从用户角度看，和一台独立的硬件主机是完全一样的，该技术的产生是为了 节省互联网服务器硬件成本。\")]),n._v(\" \"),r(\"p\",[n._v(\"每个 http 块可以包括多个 server 块，而每个 server 块就相当于一个虚拟主机。\")]),n._v(\" \"),r(\"p\",[n._v(\"而每个 server 块也分为全局 server 块，以及可以同时包含多个 locaton 块。\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[r(\"p\",[r(\"strong\",[n._v(\"全局 server 块\")])]),n._v(\" \"),r(\"p\",[n._v(\"也被叫做“虚拟服务器”部分，它描述的是一组根据不同server_name指令逻辑分割的资源，这些虚拟服务器响应HTTP请求，因此都包含在http部分。最常见的配置是本虚拟机主机的监听配置和本虚拟主机的名称或 IP 配置。\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",[r(\"code\",[n._v(\"server {\\n  listen       80;\\n  #server_name也支持通配符，*.example.com、www.example.*、.example.com\\n  server_name  localhost;\\n  #charset koi8-r;\\n  #access_log  logs/host.access.log  main;\\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[r(\"strong\",[n._v(\"location 块\")])]),n._v(\" \"),r(\"p\",[n._v(\"一个 server 块可以配置多个 location 块。\")]),n._v(\" \"),r(\"p\",[n._v(\"这块的主要作用是基于 Nginx 服务器接收到的请求字符串（例如 server_name/uri-string），对虚拟主机名称 （也可以是 IP 别名）之外的字符串（例如 前面的 /uri-string）进行匹配，对特定的请求进行处理。地址定向、数据缓存和应答控制等功能，还有许多第三方模块的配置也在这里进行。\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"location 指令说明\")])]),n._v(\" \"),r(\"p\",[n._v(\"该指令用于匹配 URL。\")]),n._v(\" \"),r(\"p\",[n._v(\"语法如下：\"),r(\"code\",[n._v(\"location [ = | ~ | ~* | ^~] uri{}\")])]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"= ：该修饰符使用精确匹配并且终止搜索。\")]),n._v(\" \"),r(\"li\",[n._v(\"~：该修饰符使用区分大小写的正则表达式匹配。\")]),n._v(\" \"),r(\"li\",[n._v(\"~*：该修饰符使用不区分大小写的正则表达式匹配。\")]),n._v(\" \"),r(\"li\",[n._v(\"^~：用于不含正则表达式的 uri 前，要求 Nginx 服务器找到标识 uri 和请求字 符串匹配度最高的 location 后，立即使用此 location 处理请求，而不再使用 location 块中的正则 uri 和请求字符串做匹配。\")])]),n._v(\" \"),r(\"p\",[n._v(\"?> \"),r(\"strong\",[n._v(\"Tip\")]),n._v(\"  注意：如果 uri 包含正则表达式，则必须要有 ~ 或者 ~* 标识。\")]),n._v(\" \"),r(\"p\",[n._v(\"当一个请求进入时，URI将会被检测匹配一个最佳的location。\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"没有正则表达式的location被作为最佳的匹配，独立于含有正则表达式的location顺序；\")]),n._v(\" \"),r(\"li\",[r(\"strong\",[n._v(\"在配置文件中按照查找顺序进行正则表达式匹配\")]),n._v(\"。在查找到第一个正则表达式匹配之后结束查找。由这个最佳的location提供请求处理。\")])]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\" location / {\\n \\troot   html;\\n    index  index.html index.htm;\\n    }\\n  \\n  #error_page  404              /404.html;\\n  \\n  # redirect server error pages to the static page /50x.html\\n  #\\n  error_page   500 502 503 504  /50x.html;\\n  location = /50x.html {\\n  \\troot   html;\\n  }\\n  location / {\\n      #try_files指令将会按照给定的参数顺序进行匹配尝试\\n      try_files $uri $uri/ /index.html;\\n  }\\n\")])])])])]),n._v(\" \"),r(\"h4\",{attrs:{id:\"nginx-conf-详细配置\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nginx-conf-详细配置\"}},[n._v(\"#\")]),n._v(\" nginx.conf 详细配置\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",[r(\"code\",[n._v('#定义Nginx运行的用户和用户组\\nuser www www; \\n\\n#nginx进程数，通常设置成和cpu的数量相等\\nworker_processes 4; \\n\\n#全局错误日志定义类型，[debug | info | notice | warn | error | crit]\\n#error_log  /data/nginx/logs/error.log;\\n#error_log  /data/nginx/logs/error.log  notice;\\n\\n#日志文件存放路径 access_log path [format [buffer=size | off]]\\naccess_log /data/nginx/logs/lazyegg.com/web/access.log combinedio;\\n\\n#进程pid文件\\n#pid        logs/nginx.pid;\\n\\n#指定进程可以打开的最大描述符：数目\\n#工作模式与连接数上限\\n##这个指令是指当一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（ulimit -n）与nginx进程数相除，但是nginx分配请求并不是那么均匀，所以最好与ulimit -n 的值保持一致。\\n#这是因为nginx调度时分配请求到进程并不是那么的均衡，所以假如填写10240，总并发量达到3-4万时就有进程可能超过10240了，这时会返回502错误。\\nworker_rlimit_nofile 65535;\\n\\n#################################  events  ###############################\\nevents {\\n    #参考事件模型，use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll模型\\n    use epoll\\n    #单个进程最大连接数（最大连接数=连接数+进程数）\\n    worker_connections  1024;\\n    \\n    #keepalive 超时时间\\n    keepalive_timeout 60;\\n    \\n    #客户端请求头部的缓冲区大小。\\n    client_header_buffer_size 4k;\\n    \\n    #这个将为打开文件指定缓存，默认是没有启用的，max指定缓存数量，建议和打开文件数一致，inactive是指经过多长时间文件没被请求后删除缓存。\\n    open_file_cache max=65535 inactive=60s;\\n    #这个是指多长时间检查一次缓存的有效信息。\\n    open_file_cache_valid 80s;\\n    #open_file_cache指令中的inactive参数时间内文件的最少使用次数，如果超过这个数字，文件描述符一直是在缓存中打开的，如上例，如果有一个文件在inactive时间内一次没被使用，它将被移除。\\n    open_file_cache_min_uses 1;\\n    \\n    #语法:open_file_cache_errors on | off 默认值:open_file_cache_errors off 使用字段:http, server, location 这个指令指定是否在搜索一个文件是记录cache错误.\\n    open_file_cache_errors on;\\n}\\n\\n##############################   http    ##################################\\n\\n#设定http服务器，利用它的反向代理功能提供负载均衡支持\\nhttp{\\n    #文件扩展名与文件类型映射表\\n    include mime.types;\\n    \\n    #默认文件类型\\n    default_type application/octet-stream;\\n    \\n    #默认编码\\n    charset utf-8;\\n    \\n    #服务器名字的hash表大小\\n    server_names_hash_bucket_size 128;\\n    \\n    #客户端请求头部的缓冲区大小。\\n    client_header_buffer_size 32k;\\n    \\n    #客户请求头缓冲大小。\\n    large_client_header_buffers 4 64k;\\n    \\n    #允许客户端请求的最大单个文件字节数\\n    client_max_body_size 8m;\\n    \\n    #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。\\n    sendfile on;\\n    \\n    #开启目录列表访问，适合下载服务器，默认关闭。\\n    autoindex on;\\n    \\n    #此选项允许或禁止使用socke的TCP_CORK的选项，此选项仅在使用sendfile的时候使用\\n    tcp_nopush on;\\n     \\n    tcp_nodelay on;\\n    \\n    #长连接超时时间，单位是秒\\n    keepalive_timeout 120;\\n    \\n    #FastCGI相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。\\n    fastcgi_connect_timeout 300;\\n    fastcgi_send_timeout 300;\\n    fastcgi_read_timeout 300;\\n    fastcgi_buffer_size 64k;\\n    fastcgi_buffers 4 64k;\\n    fastcgi_busy_buffers_size 128k;\\n    fastcgi_temp_file_write_size 128k;\\n    \\n    #gzip模块设置\\n    gzip on; #开启gzip压缩输出\\n    gzip_min_length 1k;    #最小压缩文件大小\\n    gzip_buffers 4 16k;    #压缩缓冲区\\n    gzip_http_version 1.0; #压缩版本（默认1.1，前端如果是squid2.5请使用1.0）\\n    gzip_comp_level 2;     #压缩等级\\n    gzip_types text/plain application/x-javascript text/css application/xml;    #压缩类型，默认就已经包含textml，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。\\n    gzip_vary on;\\n\\n    #开启限制IP连接数的时候需要使用\\n    #limit_zone crawler $binary_remote_addr 10m;\\n    \\n    #负载均衡配置\\n    upstream lazyegg.net {\\n  \\n        #upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。\\n        server 192.168.80.121:80 weight=3;\\n        server 192.168.80.122:80 weight=2;\\n        server 192.168.80.123:80 weight=3;\\n\\n        #nginx的upstream目前支持4种方式的分配\\n        #1、轮询（默认）\\n        #每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。\\n        #2、weight\\n        #指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。\\n        #例如：\\n        #upstream bakend {\\n        #    server 192.168.0.14 weight=10;\\n        #    server 192.168.0.15 weight=10;\\n        #}\\n        #2、ip_hash\\n        #每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，可以解决session的问题。\\n        #例如：\\n        #upstream bakend {\\n        #    ip_hash;\\n        #    server 192.168.0.14:88;\\n        #    server 192.168.0.15:80;\\n        #}\\n        #3、fair（第三方）\\n        #按后端服务器的响应时间来分配请求，响应时间短的优先分配。\\n        #upstream backend {\\n        #    server server1;\\n        #    server server2;\\n        #    fair;\\n        #}\\n        #4、url_hash（第三方）\\n        #按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，后端服务器为缓存时比较有效。\\n        #例：在upstream中加入hash语句，server语句中不能写入weight等其他的参数，hash_method是使用的hash算法\\n        #upstream backend {\\n        #    server squid1:3128;\\n        #    server squid2:3128;\\n        #    hash $request_uri;\\n        #    hash_method crc32;\\n        #}\\n\\n        #tips:\\n        #upstream bakend{#定义负载均衡设备的Ip及设备状态}{\\n        #    ip_hash;\\n        #    server 127.0.0.1:9090 down;\\n        #    server 127.0.0.1:8080 weight=2;\\n        #    server 127.0.0.1:6060;\\n        #    server 127.0.0.1:7070 backup;\\n        #}\\n        #在需要使用负载均衡的server中增加 proxy_pass http://bakend/;\\n\\n        #每个设备的状态设置为:\\n        #1.down表示单前的server暂时不参与负载\\n        #2.weight为weight越大，负载的权重就越大。\\n        #3.max_fails：允许请求失败的次数默认为1.当超过最大次数时，返回proxy_next_upstream模块定义的错误\\n        #4.fail_timeout:max_fails次失败后，暂停的时间。\\n        #5.backup： 其它所有的非backup机器down或者忙的时候，请求backup机器。所以这台机器压力会最轻。\\n\\n        #nginx支持同时设置多组的负载均衡，用来给不用的server来使用。\\n        #client_body_in_file_only设置为On 可以讲client post过来的数据记录到文件中用来做debug\\n        #client_body_temp_path设置记录文件的目录 可以设置最多3层目录\\n        #location对URL进行匹配.可以进行重定向或者进行新的代理 负载均衡\\n    }\\n    \\n     #虚拟主机的配置\\n    server {\\n        #监听端口\\n        listen 80;\\n\\n        #域名可以有多个，用空格隔开\\n        server_name lazyegg.net;\\n        #默认入口文件名称\\n        index index.html index.htm index.php;\\n        root /data/www/lazyegg;\\n\\n        #对******进行负载均衡\\n        location ~ .*.(php|php5)?$\\n        {\\n            fastcgi_pass 127.0.0.1:9000;\\n            fastcgi_index index.php;\\n            include fastcgi.conf;\\n        }\\n         \\n        #图片缓存时间设置\\n        location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$\\n        {\\n            expires 10d;\\n        }\\n         \\n        #JS和CSS缓存时间设置\\n        location ~ .*.(js|css)?$\\n        {\\n            expires 1h;\\n        }\\n         \\n        #日志格式设定\\n        #$remote_addr与$http_x_forwarded_for用以记录客户端的ip地址；\\n        #$remote_user：用来记录客户端用户名称；\\n        #$time_local： 用来记录访问时间与时区；\\n        #$request： 用来记录请求的url与http协议；\\n        #$status： 用来记录请求状态；成功是200，\\n        #$body_bytes_sent ：记录发送给客户端文件主体内容大小；\\n        #$http_referer：用来记录从那个页面链接访问过来的；\\n        #$http_user_agent：记录客户浏览器的相关信息；\\n        #通常web服务器放在反向代理的后面，这样就不能获取到客户的IP地址了，通过$remote_add拿到的IP地址是反向代理服务器的iP地址。反向代理服务器在转发请求的http头信息中，可以增加x_forwarded_for信息，用以记录原有客户端的IP地址和原来客户端的请求的服务器地址。\\n        log_format access \\'$remote_addr - $remote_user [$time_local] \"$request\" \\'\\n        \\'$status $body_bytes_sent \"$http_referer\" \\'\\n        \\'\"$http_user_agent\" $http_x_forwarded_for\\';\\n         \\n        #定义本虚拟主机的访问日志\\n        access_log  /usr/local/nginx/logs/host.access.log  main;\\n        access_log  /usr/local/nginx/logs/host.access.404.log  log404;\\n         \\n        #对 \"/connect-controller\" 启用反向代理\\n        location /connect-controller {\\n            proxy_pass http://127.0.0.1:88; #请注意此处端口号不能与虚拟主机监听的端口号一样（也就是server监听的端口）\\n            proxy_redirect off;\\n            proxy_set_header X-Real-IP $remote_addr;\\n             \\n            #后端的Web服务器可以通过X-Forwarded-For获取用户真实IP\\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\\n             \\n            #以下是一些反向代理的配置，可选。\\n            proxy_set_header Host $host;\\n\\n            #允许客户端请求的最大单文件字节数\\n            client_max_body_size 10m;\\n\\n            #缓冲区代理缓冲用户端请求的最大字节数，\\n            #如果把它设置为比较大的数值，例如256k，那么，无论使用firefox还是IE浏览器，来提交任意小于256k的图片，都很正常。如果注释该指令，使用默认的client_body_buffer_size设置，也就是操作系统页面大小的两倍，8k或者16k，问题就出现了。\\n            #无论使用firefox4.0还是IE8.0，提交一个比较大，200k左右的图片，都返回500 Internal Server Error错误\\n            client_body_buffer_size 128k;\\n\\n            #表示使nginx阻止HTTP应答代码为400或者更高的应答。\\n            proxy_intercept_errors on;\\n\\n            #后端服务器连接的超时时间_发起握手等候响应超时时间\\n            #nginx跟后端服务器连接超时时间(代理连接超时)\\n            proxy_connect_timeout 90;\\n\\n            #后端服务器数据回传时间(代理发送超时)\\n            #后端服务器数据回传时间_就是在规定时间之内后端服务器必须传完所有的数据\\n            proxy_send_timeout 90;\\n\\n            #连接成功后，后端服务器响应时间(代理接收超时)\\n            #连接成功后_等候后端服务器响应时间_其实已经进入后端的排队之中等候处理（也可以说是后端服务器处理请求的时间）\\n            proxy_read_timeout 90;\\n\\n            #设置代理服务器（nginx）保存用户头信息的缓冲区大小\\n            #设置从被代理服务器读取的第一部分应答的缓冲区大小，通常情况下这部分应答中包含一个小的应答头，默认情况下这个值的大小为指令proxy_buffers中指定的一个缓冲区的大小，不过可以将其设置为更小\\n            proxy_buffer_size 4k;\\n\\n            #proxy_buffers缓冲区，网页平均在32k以下的设置\\n            #设置用于读取应答（来自被代理服务器）的缓冲区数目和大小，默认情况也为分页大小，根据操作系统的不同可能是4k或者8k\\n            proxy_buffers 4 32k;\\n\\n            #高负荷下缓冲大小（proxy_buffers*2）\\n            proxy_busy_buffers_size 64k;\\n\\n            #设置在写入proxy_temp_path时数据的大小，预防一个工作进程在传递文件时阻塞太长\\n            #设定缓存文件夹大小，大于这个值，将从upstream服务器传\\n            proxy_temp_file_write_size 64k;\\n        }\\n        \\n        #本地动静分离反向代理配置\\n        #所有jsp的页面均交由tomcat或resin处理\\n        location ~ .(jsp|jspx|do)?$ {\\n            proxy_set_header Host $host;\\n            proxy_set_header X-Real-IP $remote_addr;\\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\\n            proxy_pass http://127.0.0.1:8080;\\n        }\\n    }\\n}\\n')])])]),r(\"hr\"),n._v(\" \"),r(\"h2\",{attrs:{id:\"_4-nginx-配置实例\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-nginx-配置实例\"}},[n._v(\"#\")]),n._v(\" 4. Nginx 配置实例\")]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_4-1-反向代理demo1\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-1-反向代理demo1\"}},[n._v(\"#\")]),n._v(\" 4.1 反向代理demo1\")]),n._v(\" \"),r(\"p\",[n._v(\"实现效果：使用 nginx 反向代理，访问 test.com 直接跳转到自己的机器 127.0.0.1:8080\")]),n._v(\" \"),r(\"ol\",[r(\"li\",[n._v(\"启动一个 tomcat，浏览器地址栏输入 127.0.0.1:8080，出现如下界面\")])]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(555),alt:\"tomcat-index\"}})]),n._v(\" \"),r(\"ol\",{attrs:{start:\"2\"}},[r(\"li\",[r(\"p\",[n._v(\"通过修改本地 host 文件（C:\\\\Windows\\\\System32\\\\drivers\\\\etc），添加\"),r(\"code\",[n._v(\"127.0.0.1 www.12345.com\")]),n._v(\"将 www.12345.com 映射到自己的机器ip上\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"配置完成之后，我们便可以通过 www.test.com:8080 访问到第一步出现的 Tomcat 初始界面。那么如何只需要输入 www.12345.com 便可以跳转到 Tomcat 初始界面呢？便用到 nginx 的反向代理。\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"修改nginx.conf 配置文件，增加如下配置 \"),r(\"code\",[n._v(\"proxy_pass\")])])])]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"    server {\\n        listen       80;\\n        server_name  localhost;\\n        #charset koi8-r;\\n        #access_log  logs/host.access.log  main;\\n        location / {\\n               proxy_pass http://127.0.0.1:8080;\\n        }\\n\\n\")])])]),r(\"ol\",{attrs:{start:\"5\"}},[r(\"li\",[n._v(\"如上配置，我们监听 80 端口，访问域名为 www.12345.com，不加端口号时默认为 80 端口，故访问该域名时会跳转到 127.0.0.1:8080 路径上。在浏览器端输入 www.12345.com 结果如下：\")])]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(556),alt:\"nginx-demo1\"}})]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_4-2-反向代理demo2\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-2-反向代理demo2\"}},[n._v(\"#\")]),n._v(\" 4.2 反向代理demo2\")]),n._v(\" \"),r(\"p\",[n._v(\"实现效果：使用 nginx 反向代理，根据访问的路径跳转到不同端口的服务中\")]),n._v(\" \"),r(\"p\",[n._v(\"访问 http://127.0.0.1/java/ 直接跳转到 127.0.0.1:8080\")]),n._v(\" \"),r(\"p\",[n._v(\"访问 http://127.0.0.1/egg/ 直接跳转到 127.0.0.1:8081\")]),n._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[n._v(\"在服务器上起两个tomcat，修改其中一个端口号为8081； 在tomcat/webapps/目录下的各加两个文件夹，并随便写个html页面），我建的是java/index.html和egg/index.html\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"修改nginx.conf，在http块中添加serve{}\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"server {\\n        listen       80;\\n        server_name  localhost;\\n\\n        location ~ /java/ {\\n            proxy_pass http://127.0.0.1:8080;\\n        }\\n\\n        location /egg/ {\\n            proxy_pass http://127.0.0.1:8081;\\n        }\\n}\\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"重启nginx，验证效果\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(557),alt:\"\"}})])])]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_4-3-nginx-配置-负载均衡\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-3-nginx-配置-负载均衡\"}},[n._v(\"#\")]),n._v(\" 4.3 Nginx 配置-负载均衡\")]),n._v(\" \"),r(\"p\",[n._v(\"随着互联网信息的爆炸性增长，负载均衡（load balance）已经不再是一个很陌生的话题， 顾名思义，负载均衡即是将负载分摊到不同的服务单元，既保证服务的可用性，又保证响应足够快，给用户很好的体验。快速增长的访问量和数据流量催生了各式各样的负载均衡产品， 很多专业的负载均衡硬件提供了很好的功能，但却价格不菲，这使得负载均衡软件大受欢迎， nginx 就是其中的一个，在 linux 下有 Nginx、LVS、Haproxy 等等服务可以提供负载均衡服务。\")]),n._v(\" \"),r(\"p\",[n._v(\"Nginx的负载均衡是proxy模块和upstream模块搭配实现的。upstream模块将会启用一个新的配置区段，在该区段定义了一组上游服务器。\")]),n._v(\" \"),r(\"p\",[n._v(\"实现效果：配置负载均衡\")]),n._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[n._v(\"同时启动两个Tomcat（为了方便验证效果，修改tomcat端口号的同时，顺便将Tomcat默认欢迎页面apache-tomcat-9.0.29/webapps/ROOR目录下的index.jsp修改下，看下8081欢迎页的“蛋蛋”没）\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(558),alt:\"nginx-tomcat\"}})])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"修改nginx.conf\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"http {\\n    upstream myserver {\\n        server localhost:8080;\\n        server localhost:8081;\\n    }\\n    server {\\n        listen 80;\\n        location / {\\n            proxy_pass http://myserver;\\n        }\\n    }\\n}\\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"重启nginx，验证效果（默认轮询的方式，每次打开新窗口，8080和8081会交替出现，同一个窗口的话需要关闭浏览器缓存)\")])])]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"Nginx 分配策略：\")])]),n._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[n._v(\"轮询（默认） 每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器 down 掉，能自动剔除\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"weight weight 代表权,重默认为 1,权重越高被分配的客户端越多 指定轮询几率，weight 和访问比率成正比，用于后端服务器性能不均的情况。 例如：\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\" upstream server_pool{ \\n\\tserver 192.168.5.21 weight=10; \\n\\tserver 192.168.5.22 weight=10; } \\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"ip_hash 每个请求按访问 ip 的 hash 结果分配，这样每个访客固定访问一个后端服务器，可以解决 session 的问题。 例如：\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"upstream server_pool{\\n\\tip_hash; server 192.168.5.21:80; \\n\\tserver 192.168.5.22:80; \\n} \\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"fair（第三方） 按后端服务器的响应时间来分配请求，响应时间短的优先分配。\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"upstream server_pool{ \\n\\tserver 192.168.5.21:80;\\n    server 192.168.5.22:80; fair;\\n } \\n\")])])])])]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_4-4-nginx-配置-动静分离\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-4-nginx-配置-动静分离\"}},[n._v(\"#\")]),n._v(\" 4.4 Nginx 配置-动静分离\")]),n._v(\" \"),r(\"p\",[n._v(\"Nginx 动静分离简单来说就是把动态跟静态请求分开，不能理解成只是单纯的把动态页面和静态页面物理分离。严格意义上说应该是动态请求跟静态请求分开，可以理解成使用 Nginx 处理静态页面，Tomcat 处理动态页面。动静分离从目前实现角度来讲大致分为两种， 一种是纯粹把静态文件独立成单独的域名，放在独立的服务器上，也是目前主流推崇的方案； 另外一种方法就是动态跟静态文件混合在一起发布，通过 nginx 来分开。 通过 location 指定不同的后缀名实现不同的请求转发。通过 expires 参数设置，可以使浏览器缓存过期时间，减少与服务器之前的请求和流量。具体 Expires 定义：是给一个资 源设定一个过期时间，也就是说无需去服务端验证，直接通过浏览器自身确认是否过期即可， 所以不会产生额外的流量。此种方法非常适合不经常变动的资源。（如果经常更新的文件， 不建议使用 Expires 来缓存），我这里设置 3d，表示在这 3 天之内访问这个 URL，发送 一个请求，比对服务器该文件最后更新时间没有变化，则不会从服务器抓取，返回状态码 304，如果有修改，则直接从服务器重新下载，返回状态码 200。\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(559),alt:\"nginx-separation.png\"}})]),n._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[n._v(\"服务器找个目录存放自己的静态文件\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(560),alt:\"\"}})])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"修改nginx.conf\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"    server {\\n        listen       80;\\n        server_name  localhost;\\n        location /static/ {\\n            root   /usr/data/www;\\n        }\\n        location /image/ {\\n             root /usr/data/;\\n             autoindex on;\\n        }\\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[r(\"code\",[n._v(\"./nginx -s reload\")]),n._v(\"，验证效果\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(561),alt:\"image-20191211172217503\"}})])])]),n._v(\" \"),r(\"p\",[n._v(\"添加监听端口、访问名字 重点是添加 location， 最后检查 Nginx 配置是否正确即可，然后测试动静分离是否成功，之需要删除后端 tomcat 服务器上的某个静态文件，查看是否能访问，如果可以访问说明静态资源 nginx 直接返回 了，不走后端 tomcat 服务器\")]),n._v(\" \"),r(\"h3\",{attrs:{id:\"_4-5-nginx的rewrite\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-5-nginx的rewrite\"}},[n._v(\"#\")]),n._v(\" 4.5  Nginx的Rewrite\")]),n._v(\" \"),r(\"p\",[n._v(\"Rewrite是Nginx服务器提供的一个重要的功能，它可以实现URL重写和重定向功能。\")]),n._v(\" \"),r(\"p\",[n._v(\"场景：\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"URL访问跳转，支持开发设计。 页面跳转、兼容性支持(新旧版本更迭)、展示效果(网址精简)等\")]),n._v(\" \"),r(\"li\",[n._v(\"SEO优化(Nginx伪静态的支持)\")]),n._v(\" \"),r(\"li\",[n._v(\"后台维护、流量转发等\")]),n._v(\" \"),r(\"li\",[n._v(\"安全(动态界面进行伪装)\")])]),n._v(\" \"),r(\"p\",[n._v(\"该指令是通过正则表达式的使用来改变URI。可以同时存在一个或多个指令。需要按照顺序依次对URL进行匹配和处理。\")]),n._v(\" \"),r(\"p\",[n._v(\"该指令可以在server块或location块中配置，其基本语法结构如下：\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"rewrite regex replacement [flag];\\n\")])])]),r(\"ol\",[r(\"li\",[r(\"p\",[n._v(\"采用反向代理demo2中的例子，修改nginx.conf(只多加了一行rewrite)\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"server {\\n        listen       80;\\n        server_name  localhost;\\n\\n        location /java/ {\\n            proxy_pass http://127.0.0.1:8080;\\n            rewrite ^/java /egg/ redirect;\\n        }\\n\\n        location /egg/ {\\n            proxy_pass http://127.0.0.1:8081;\\n        }\\n}\\n\\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[r(\"code\",[n._v(\"./nginx -s reload\")]),n._v(\"，验证效果（输入ip/java/被重定向到了egg）\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(562),alt:\"\"}})])])]),n._v(\" \"),r(\"p\",[n._v(\"rewrite指令可以在server块或location块中配置，其基本语法结构如下：\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"rewrite regex replacement [flag];\\n\")])])]),r(\"ul\",[r(\"li\",[r(\"strong\",[n._v(\"rewrite\")]),n._v(\"的含义：该指令是实现URL重写的指令。\")]),n._v(\" \"),r(\"li\",[r(\"strong\",[n._v(\"regex\")]),n._v(\"的含义：用于匹配URI的正则表达式。\")]),n._v(\" \"),r(\"li\",[r(\"strong\",[n._v(\"replacement\")]),n._v(\"：将regex正则匹配到的内容替换成 replacement。\")]),n._v(\" \"),r(\"li\",[r(\"strong\",[n._v(\"flag: flag\")]),n._v(\"标记，flag有如下值：\\n\"),r(\"ul\",[r(\"li\",[r(\"strong\",[n._v(\"last:\")]),n._v(\" 本条规则匹配完成后，继续向下匹配新的location URI 规则。(不常用)\")]),n._v(\" \"),r(\"li\",[r(\"strong\",[n._v(\"break:\")]),n._v(\" 本条规则匹配完成即终止，不再匹配后面的任何规则(不常用)。\")]),n._v(\" \"),r(\"li\",[r(\"strong\",[n._v(\"redirect:\")]),n._v(\" 返回302临时重定向，浏览器地址会显示跳转新的URL地址。\")]),n._v(\" \"),r(\"li\",[r(\"strong\",[n._v(\"permanent:\")]),n._v(\" 返回301永久重定向。浏览器地址会显示跳转新的URL地址。\")])])])]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"rewrite ^/(.*) http://www.360.cn/$1 permanent;\\n\")])])]),r(\"h3\",{attrs:{id:\"_4-6-nginx-高可用\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-6-nginx-高可用\"}},[n._v(\"#\")]),n._v(\" 4.6 Nginx 高可用\")]),n._v(\" \"),r(\"p\",[n._v(\"如果将Web服务器集群当做一个城池，那么负载均衡服务器就相当于城门。如果“城门”关闭了，与外界的通道就断了。如果只有一台Nginx负载服务器，当故障宕机的时候，就会导致整个网站无妨访问。所以我们需要两台以上Nginx来实现故障转移和高可用。\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(563),alt:\"nginx-availability\"}})]),n._v(\" \"),r(\"h4\",{attrs:{id:\"配置高可用\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#配置高可用\"}},[n._v(\"#\")]),n._v(\" 配置高可用\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"双机热备方案\")])]),n._v(\" \"),r(\"p\",[n._v(\"这种方案是国内企业中最为普遍的一种高可用方案，双机热备其实就是指一台服务器在提供服务，另一台为某服务的备用状态，当一台服务器不可用另外一台就会顶替上去。\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"keepalived是什么？\")])]),n._v(\" \"),r(\"p\",[r(\"code\",[n._v(\"Keepalived\")]),n._v(\"软件起初是专为\"),r(\"code\",[n._v(\"LVS\")]),n._v(\"负载均衡软件设计的，用来管理并监控LVS集群系统中各个服务节点的状态，后来又加入了可以实现高可用的\"),r(\"code\",[n._v(\"VRRP (Virtual Router Redundancy Protocol ,虚拟路由器冗余协议）\")]),n._v(\"功能。因此，\"),r(\"code\",[n._v(\"Keepalived\")]),n._v(\"除了能够管理LVS软件外，还可以作为其他服务\"),r(\"code\",[n._v(\"（例如：Nginx、Haproxy、MySQL等）\")]),n._v(\"的高可用解决方案软件\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"故障转移机制\")])]),n._v(\" \"),r(\"p\",[r(\"code\",[n._v(\"Keepalived\")]),n._v(\"高可用服务之间的故障切换转移，是通过\"),r(\"code\",[n._v(\"VRRP\")]),n._v(\" 来实现的。\\n在 \"),r(\"code\",[n._v(\"Keepalived\")]),n._v(\"服务正常工作时，主 \"),r(\"code\",[n._v(\"Master\")]),n._v(\"节点会不断地向备节点发送（多播的方式）心跳消息，用以告诉备\"),r(\"code\",[n._v(\"Backup\")]),n._v(\"节点自己还活着，当主 \"),r(\"code\",[n._v(\"Master\")]),n._v(\"节点发生故障时，就无法发送心跳消息，备节点也就因此无法继续检测到来自主 \"),r(\"code\",[n._v(\"Master\")]),n._v(\"节点的心跳了，于是调用自身的接管程序，接管主Master节点的 IP资源及服务。而当主 Master节点恢复时，备Backup节点又会释放主节点故障时自身接管的IP资源及服务，恢复到原来的备用角色。\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"实现\")])]),n._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[n._v(\"准备两台安装Nginx和keepaliver(\"),r(\"code\",[n._v(\"yum install keepalived -y\")]),n._v(\")的服务器\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"修改两台服务器上的/etc/keepalived/keepalived.conf\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v('#主机\\n#检测脚本\\nvrrp_script chk_http_port {\\n    script \"/usr/local/src/check_nginx.sh\" #心跳执行的脚本，检测nginx是否启动\\n    interval 2                          #（检测脚本执行的间隔，单位是秒）\\n    weight 2                            #权重\\n}\\n#vrrp 实例定义部分\\nvrrp_instance VI_1 {\\n    state MASTER            # 指定keepalived的角色，MASTER为主，BACKUP为备\\n    interface ens33         # 当前进行vrrp通讯的网络接口卡(当前centos的网卡) 用ifconfig查看你具体的网卡\\n    virtual_router_id 66    # 虚拟路由编号，主从要一直\\n    priority 100            # 优先级，数值越大，获取处理请求的优先级越高\\n    advert_int 1            # 检查间隔，默认为1s(vrrp组播周期秒数)\\n    #授权访问\\n    authentication {\\n        auth_type PASS #设置验证类型和密码，MASTER和BACKUP必须使用相同的密码才能正常通信\\n        auth_pass 1111\\n    }\\n    track_script {\\n        chk_http_port            #（调用检测脚本）\\n    }\\n    virtual_ipaddress {\\n        192.168.16.150            # 定义虚拟ip(VIP)，可多设，每行一个\\n    }\\n}\\n')])])]),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v('# 备机\\n#检测脚本\\nvrrp_script chk_http_port {\\n    script \"/usr/local/src/check_nginx.sh\" #心跳执行的脚本，检测nginx是否启动\\n    interval 2                          #（检测脚本执行的间隔）\\n    weight 2                            #权重\\n}\\n#vrrp 实例定义部分\\nvrrp_instance VI_1 {\\n    state BACKUP                        # 指定keepalived的角色，MASTER为主，BACKUP为备\\n    interface ens33                      # 当前进行vrrp通讯的网络接口卡(当前centos的网卡) 用ifconfig查看你具体的网卡\\n    virtual_router_id 66                # 虚拟路由编号，主从要一直\\n    priority 99                         # 优先级，数值越大，获取处理请求的优先级越高\\n    advert_int 1                        # 检查间隔，默认为1s(vrrp组播周期秒数)\\n    #授权访问\\n    authentication {\\n        auth_type PASS #设置验证类型和密码，MASTER和BACKUP必须使用相同的密码才能正常通信\\n        auth_pass 1111\\n    }\\n    track_script {\\n        chk_http_port                   #（调用检测脚本）\\n    }\\n    virtual_ipaddress {\\n        192.168.16.150                   # 定义虚拟ip(VIP)，可多设，每行一个\\n    }\\n}\\n')])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"新建检测脚本(\"),r(\"code\",[n._v(\"chmod 775 check_nginx.sh\")]),n._v(\")\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"#!/bin/bash\\n#检测nginx是否启动了\\nA=`ps -C nginx --no-header |wc -l`        \\nif [ $A -eq 0 ];then    #如果nginx没有启动就启动nginx                        \\n      systemctl start nginx                #重启nginx\\n      if [ `ps -C nginx --no-header |wc -l` -eq 0 ];then    #nginx重启失败，则停掉keepalived服务，进行VIP转移\\n              killall keepalived                    \\n      fi\\nfi\\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"启动Nginx和keepalived(\"),r(\"code\",[n._v(\"systemctl start keepalived.service\")]),n._v(\")\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"模拟Nginx故障（关闭主服务器Nginx），验证，仍可以通过配置的虚拟ip访问，ok\")])])]),n._v(\" \"),r(\"h2\",{attrs:{id:\"_5-nginx-原理与优化参数配置\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-nginx-原理与优化参数配置\"}},[n._v(\"#\")]),n._v(\" 5. Nginx 原理与优化参数配置\")]),n._v(\" \"),r(\"p\",[n._v(\"Nginx默认采用多进程工作方式，Nginx启动后，会运行一个master进程和多个worker进程。其中master充当整个进程组与用户的交互接口，同时对进程进行监护，管理worker进程来实现重启服务、平滑升级、更换日志文件、配置文件实时生效等功能。worker用来处理基本的网络事件，worker之间是平等的，他们共同竞争来处理来自客户端的请求\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(564),alt:\"nginx-work\"}})]),n._v(\" \"),r(\"h4\",{attrs:{id:\"master-workers-的机制的好处\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#master-workers-的机制的好处\"}},[n._v(\"#\")]),n._v(\" master-workers 的机制的好处\")]),n._v(\" \"),r(\"ol\",[r(\"li\",[n._v(\"可以使用nginx-s reload 热部署\")]),n._v(\" \"),r(\"li\",[n._v(\"每个worker是独立的进程，不需要加锁，省掉了锁带来的开销。采用独立的进程，可以让互相之间不会影响，一个进程退出后，其它进程还在工作，服务不会中断，master 进程则很快启动新的 worker 进程。\")])]),n._v(\" \"),r(\"h4\",{attrs:{id:\"需要设置多少个-worker\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#需要设置多少个-worker\"}},[n._v(\"#\")]),n._v(\" 需要设置多少个 worker\")]),n._v(\" \"),r(\"p\",[n._v(\"Nginx 同 redis 类似都采用了 io 多路复用机制，每个 worker 都是一个独立的进程，但每个进程里只有一个主线程，通过异步非阻塞的方式来处理请求，即使是千上万个请求也不在话下。每个 worker 的线程可以把一个 cpu 的性能发挥到极致。所以 \"),r(\"strong\",[n._v(\"worker 数和服务器的 cpu 数相等是最为适宜\")]),n._v(\"的。设少了会浪费 cpu，设多了会造成 cpu 频繁切换上下文带来的损耗。\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"#设置 worker 数量。\\n worker_processes 4 \\n#work 绑定 cpu(4 work 绑定 4cpu)。 \\n worker_cpu_affinity 0001 0010 0100 1000 \\n#work 绑定 cpu (4 work 绑定 8cpu 中的 4 个) 。 \\n worker_cpu_affinity 0000001 00000010 00000100 00001000\\n\")])])]),r(\"h4\",{attrs:{id:\"连接数-worker-connection\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#连接数-worker-connection\"}},[n._v(\"#\")]),n._v(\" 连接数 worker_connection\")]),n._v(\" \"),r(\"p\",[n._v(\"这个值是表示每个 worker 进程所能建立连接的最大值，所以，一个 nginx 能建立的最大连接数，应该是 worker_connections * worker_processes。当然，这里说的是最大连接数，对于 HTTP 请 求 本 地 资 源 来 说 ， 能 够 支 持 的 最 大 并 发 数 量 是 worker_connections * worker_processes，如果是支持 http1.1 的浏览器每次访问要占两个连接，所以普通的静态访 问最大并发数是： worker_connections * worker_processes /2，而如果是 HTTP 作 为反向代理来说，最大并发数量应该是 worker_connections * worker_processes/4。因为作为反向代理服务器，每个并发会建立与客户端的连接和与后端服 务的连接，会占用两个连接。\")]),n._v(\" \"),r(\"h4\",{attrs:{id:\"nginx请求处理流程\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nginx请求处理流程\"}},[n._v(\"#\")]),n._v(\" Nginx请求处理流程\")]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(565),alt:\"nginx-process\"}})]),n._v(\" \"),r(\"hr\"),n._v(\" \"),r(\"h2\",{attrs:{id:\"_6-nginx模块开发\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_6-nginx模块开发\"}},[n._v(\"#\")]),n._v(\" 6. Nginx模块开发\")]),n._v(\" \"),r(\"p\",[n._v(\"由于Nginx的模块化特性，所以可以支持模块配置，也可以自定义模块，Nginx的模块开发，程序员目前还不需要太深入\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"Nginx模块分类\")])]),n._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:t(566),alt:\"nginx-module\"}})]),n._v(\" \"),r(\"h4\",{attrs:{id:\"nginx配置选项\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#nginx配置选项\"}},[n._v(\"#\")]),n._v(\" Nginx配置选项\")]),n._v(\" \"),r(\"p\",[n._v(\"解压nginx后的配置操作示例\")]),n._v(\" \"),r(\"div\",{staticClass:\"language-sh extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-sh\"}},[r(\"code\",[n._v(\"./configure --prefix\"),r(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[n._v(\"=\")]),n._v(\"/usr/local/nginx --with-http_stub_status_module --with-pcre  --with-http_ssl_module\\n\")])])]),r(\"table\",[r(\"thead\",[r(\"tr\",[r(\"th\",[n._v(\"选项\")]),n._v(\" \"),r(\"th\",[n._v(\"解释\")])])]),n._v(\" \"),r(\"tbody\",[r(\"tr\",[r(\"td\",[n._v(\"--prefix=<path>\")]),n._v(\" \"),r(\"td\",[n._v(\"Nginx安装的根目录，所有其他安装路径都要依赖于该选项\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--sbin- path=<path>\")]),n._v(\" \"),r(\"td\",[n._v(\"指定Nginx二进制文件的路径\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--conf-path=<path>\")]),n._v(\" \"),r(\"td\",[n._v(\"指定nginx.conf配置文件的路径\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--error-log- path=<path>\")]),n._v(\" \"),r(\"td\",[n._v(\"指定错误文件的路径\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--user=name\")]),n._v(\" \"),r(\"td\",[n._v(\"worker进程运行的用户\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--group=<group>\")]),n._v(\" \"),r(\"td\",[n._v(\"worker进程运行的组\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--with-http_ssl_module\")]),n._v(\" \"),r(\"td\",[n._v(\"使用https协议模块。默认情况下该模块没有被构建。前提是openssl与openssl-devel已安装\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--with-http_image_filter_module\")]),n._v(\" \"),r(\"td\",[n._v(\"该模块被用作图像过滤器使用，将图像投递给客户前先进行过滤（需要libgd库）\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--with-http_stub_status_module\")]),n._v(\" \"),r(\"td\",[n._v(\"启用这个模块会收集Nginx自身状态信息，常用来做监控\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--with-mail\")]),n._v(\" \"),r(\"td\",[n._v(\"启用mail模块，默认没有被激活\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--without-http_autoindex_module\")]),n._v(\" \"),r(\"td\",[n._v(\"禁用：如果一个目录没有index文件，该模块能收集文件并列出\")])]),n._v(\" \"),r(\"tr\",[r(\"td\",[n._v(\"--add-module=<path>\")]),n._v(\" \"),r(\"td\",[n._v(\"添加第三方外部模块,每次添加新的模块都要重新编译\")])])])]),n._v(\" \"),r(\"h2\",{attrs:{id:\"_7-nginx-面试题\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-nginx-面试题\"}},[n._v(\"#\")]),n._v(\" 7. Nginx 面试题\")]),n._v(\" \"),r(\"p\",[n._v(\"恭喜你顺利来到大猿帅面试阶段，没有夹道欢迎\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[r(\"p\",[n._v(\"Nginx功能，你们项目中用到的Nginx？\")]),n._v(\" \"),r(\"p\",[n._v(\"反向代理服务器\")]),n._v(\" \"),r(\"p\",[n._v(\"实现负载均衡\")]),n._v(\" \"),r(\"p\",[n._v(\"做静态资源服务器\")]),n._v(\" \"),r(\"p\",[n._v(\"作为http server\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"Nginx常用命令有哪写？\")]),n._v(\" \"),r(\"p\",[n._v(\"启动nginx    ./sbin/nginx\\n停止nginx    ./sbin/nginx -s stop   ./sbin/nginx -s quit\\n重载配置      ./sbin/nginx -s reload(平滑重启) service nginx reload\\n重载指定配置文件    ./sbin/nginx -c  /usr/local/nginx/conf/nginx.conf\\n查看nginx版本  ./sbin/nginx -v\\n检查配置文件是否正确  ./sbin/nginx -t\\n显示帮助信息  ./sbin/nginx  -h\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"Nginx常用配置？\")]),n._v(\" \"),r(\"div\",{staticClass:\"language- extra-class\"},[r(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[r(\"code\",[n._v(\"worker_processes 4;   #工作进程数\\nwork_connections 65535; #每个进程的并发能力\\nerror_log  /data/nginx/logs/error.log;  #错误日志\\n\\n\")])])])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"Nginx是如何实现高并发的？\")]),n._v(\" \"),r(\"p\",[n._v(\"Nginx 采用的是多进程（单线程） & 多路IO复用模型,，异步，非阻塞.\")]),n._v(\" \"),r(\"p\",[n._v(\"一个主进程master，多个工作进程worker，每个工作进程可以处理多个请求\")]),n._v(\" \"),r(\"p\",[n._v(\"master进程主要负责收集、分发请求。每当一个请求过来时，master就拉起一个worker进程负责处理这个请求。同时master进程也负责监控woker的状态，保证高可靠性\")]),n._v(\" \"),r(\"p\",[n._v(\"在nginx中的work进程中，为了应对高并发场景，采取了Reactor模型（也就是I/O多路复用，NIO）：\")]),n._v(\" \"),r(\"ul\",[r(\"li\",[n._v(\"每一个worker进程通过I/O多路复用处理多个连接请求；\")]),n._v(\" \"),r(\"li\",[n._v(\"为了减少进程切换（需要系统调用）的性能损耗，一般设置worker进程数量和CPU数量一致。\")])]),n._v(\" \"),r(\"p\",[n._v(\"**I/O 多路复用模型：**在 I/O 多路复用模型中，最重要的系统调用函数就是 select（其他的还有epoll等），该方法的能够同时监控多个文件描述符的可读可写情况（每一个网络连接其实都对应一个文件描述符），当其中的某些文件描述符可读或者可写时，select 方法就会返回可读以及可写的文件描述符个数。\")]),n._v(\" \"),r(\"p\",[r(\"strong\",[n._v(\"nginx work进程\")]),n._v(\"使用 I/O 多路复用模块同时监听多个 FD（文件描述符），当 accept、read、write 和 close 事件产生时，操作系统就会回调 FD 绑定的事件处理器，这时候work进程再去处理相应事件，而不是阻塞在某个请求连接上等待。这样就可以实现一个进程同时处理多个连接。\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"nginx和apache的区别？\")]),n._v(\" \"),r(\"p\",[n._v(\"轻量级，同样起web 服务，比apache 占用更少的内存及资源\\n抗并发，nginx 处理请求是异步非阻塞的，而apache 则是阻塞型的，在高并发下nginx 能保持低资源低消耗高性能\\n高度模块化的设计，编写模块相对简单\\n最核心的区别在于apache是同步多进程模型，一个连接对应一个进程；nginx是异步的，多个连接（万级别）可以对应一个进程\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"nginx 的 upstream支持的负载均衡方式？\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"轮询（默认）\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"weight  ：指定权重\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"ip_hash ：每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"第三方： fair、url_hash\")])]),n._v(\" \"),r(\"li\",[r(\"p\",[n._v(\"Nginx常见的优化配置有哪些?\")])])]),n._v(\" \"),r(\"ol\",[r(\"li\",[n._v(\"调整worker_processes : 指Nginx要生成的worker数量,最佳实践是每个CPU运行1个工作进程\")]),n._v(\" \"),r(\"li\",[n._v(\"最大化worker_connections :\")]),n._v(\" \"),r(\"li\",[n._v(\"启用Gzip压缩 : 压缩文件大小，减少了客户端http的传输带宽，因此提高了页面加载速度\")]),n._v(\" \"),r(\"li\",[n._v(\"为静态文件启用缓存\")]),n._v(\" \"),r(\"li\",[n._v(\"禁用access_logs : 访问日志记录，它记录每个nginx请求，因此消耗了大量CPU资源，从而降低了nginx性能\")])]),n._v(\" \"),r(\"p\",[n._v(\"参考：\")]),n._v(\" \"),r(\"blockquote\",[r(\"p\",[n._v(\"《Nginx核心知识100讲》\")]),n._v(\" \"),r(\"p\",[n._v(\"《精通Nginx》\")]),n._v(\" \"),r(\"p\",[r(\"a\",{attrs:{href:\"https://juejin.im/post/5c1616186fb9a049a42ef21d\",target:\"_blank\",rel:\"noopener noreferrer\"}},[n._v(\"nginx.conf 配置文件详解\"),r(\"OutboundLink\")],1)]),n._v(\" \"),r(\"p\",[n._v(\"《尚硅谷Nginx》\")])])])}),[],!1,null,null,null);e.default=a.exports}}]);","extractedComments":[]}