{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{692:function(v,_,t){\"use strict\";t.r(_);var r=t(6),s=Object(r.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":v.$parent.slotKey}},[t(\"h1\",{attrs:{id:\"浅谈消息队列及常见的消息中间件\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#浅谈消息队列及常见的消息中间件\"}},[v._v(\"#\")]),v._v(\" 浅谈消息队列及常见的消息中间件\")]),v._v(\" \"),t(\"h2\",{attrs:{id:\"前言\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#前言\"}},[v._v(\"#\")]),v._v(\" 前言\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 已经逐渐成为企业应用系统 \"),t(\"strong\",[v._v(\"内部通信\")]),v._v(\" 的核心手段。它具有 \"),t(\"strong\",[v._v(\"低耦合\")]),v._v(\"、\"),t(\"strong\",[v._v(\"可靠投递\")]),v._v(\"、\"),t(\"strong\",[v._v(\"广播\")]),v._v(\"、\"),t(\"strong\",[v._v(\"流量控制\")]),v._v(\"、\"),t(\"strong\",[v._v(\"最终一致性\")]),v._v(\" 等一系列功能。\")]),v._v(\" \"),t(\"p\",[v._v(\"当前使用较多的 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 有 \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\"、\"),t(\"code\",[v._v(\"RocketMQ\")]),v._v(\"、\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\"、\"),t(\"code\",[v._v(\"Kafka\")]),v._v(\"、\"),t(\"code\",[v._v(\"ZeroMQ\")]),v._v(\"、\"),t(\"code\",[v._v(\"MetaMQ\")]),v._v(\" 等，而部分\"),t(\"strong\",[v._v(\"数据库\")]),v._v(\" 如 \"),t(\"code\",[v._v(\"Redis\")]),v._v(\"、\"),t(\"code\",[v._v(\"MySQL\")]),v._v(\" 以及 \"),t(\"code\",[v._v(\"phxsql\")]),v._v(\" 也可实现消息队列的功能。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/onjauh.png\",alt:\"img\"}})]),v._v(\" \"),t(\"h2\",{attrs:{id:\"_1-消息队列概述\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-消息队列概述\"}},[v._v(\"#\")]),v._v(\" 1. 消息队列概述\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 是指利用 \"),t(\"strong\",[v._v(\"高效可靠\")]),v._v(\" 的 \"),t(\"strong\",[v._v(\"消息传递机制\")]),v._v(\" 进行与平台无关的 \"),t(\"strong\",[v._v(\"数据交流\")]),v._v(\"，并基于\"),t(\"strong\",[v._v(\"数据通信\")]),v._v(\"来进行分布式系统的集成。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/ajmwms.png\",alt:\"img\"}})]),v._v(\" \"),t(\"p\",[v._v(\"通过提供 \"),t(\"strong\",[v._v(\"消息传递\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"消息排队\")]),v._v(\" 模型，它可以在 \"),t(\"strong\",[v._v(\"分布式环境\")]),v._v(\" 下提供 \"),t(\"strong\",[v._v(\"应用解耦\")]),v._v(\"、\"),t(\"strong\",[v._v(\"弹性伸缩\")]),v._v(\"、\"),t(\"strong\",[v._v(\"冗余存储\")]),v._v(\"、\"),t(\"strong\",[v._v(\"流量削峰\")]),v._v(\"、\"),t(\"strong\",[v._v(\"异步通信\")]),v._v(\"、\"),t(\"strong\",[v._v(\"数据同步\")]),v._v(\" 等等功能，其作为 \"),t(\"strong\",[v._v(\"分布式系统架构\")]),v._v(\" 中的一个重要组件，有着举足轻重的地位。\")]),v._v(\" \"),t(\"h2\",{attrs:{id:\"_2-消息队列的特点\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-消息队列的特点\"}},[v._v(\"#\")]),v._v(\" 2. 消息队列的特点\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_2-1-采用异步处理模式\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-1-采用异步处理模式\"}},[v._v(\"#\")]),v._v(\" 2.1. 采用异步处理模式\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"消息发送者\")]),v._v(\" 可以发送一个消息而无须等待响应。\"),t(\"strong\",[v._v(\"消息发送者\")]),v._v(\" 将消息发送到一条 \"),t(\"strong\",[v._v(\"虚拟的通道\")]),v._v(\"（\"),t(\"strong\",[v._v(\"主题\")]),v._v(\" 或 \"),t(\"strong\",[v._v(\"队列\")]),v._v(\"）上，\"),t(\"strong\",[v._v(\"消息接收者\")]),v._v(\" 则 \"),t(\"strong\",[v._v(\"订阅\")]),v._v(\" 或是 \"),t(\"strong\",[v._v(\"监听\")]),v._v(\" 该通道。一条信息可能最终转发给 \"),t(\"strong\",[v._v(\"一个或多个\")]),v._v(\" 消息接收者，这些接收者都无需对 \"),t(\"strong\",[v._v(\"消息发送者\")]),v._v(\" 做出 \"),t(\"strong\",[v._v(\"同步回应\")]),v._v(\"。整个过程都是 \"),t(\"strong\",[v._v(\"异步的\")]),v._v(\"。\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_2-2-应用系统之间解耦合\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-2-应用系统之间解耦合\"}},[v._v(\"#\")]),v._v(\" 2.2. 应用系统之间解耦合\")]),v._v(\" \"),t(\"p\",[v._v(\"主要体现在如下两点：\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"发送者和接受者不必了解对方、只需要 \"),t(\"strong\",[v._v(\"确认消息\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"发送者和接受者 \"),t(\"strong\",[v._v(\"不必同时在线\")]),v._v(\"。\")])]),v._v(\" \"),t(\"p\",[v._v(\"比如在线交易系统为了保证数据的 \"),t(\"strong\",[v._v(\"最终一致\")]),v._v(\"，在 \"),t(\"strong\",[v._v(\"支付系统\")]),v._v(\" 处理完成后会把 \"),t(\"strong\",[v._v(\"支付结果\")]),v._v(\" 放到 \"),t(\"strong\",[v._v(\"消息中间件\")]),v._v(\" 里，通知 \"),t(\"strong\",[v._v(\"订单系统\")]),v._v(\" 修改 \"),t(\"strong\",[v._v(\"订单支付状态\")]),v._v(\"。两个系统是通过消息中间件解耦的。\")]),v._v(\" \"),t(\"h2\",{attrs:{id:\"_3-消息队列的传递服务模型\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-消息队列的传递服务模型\"}},[v._v(\"#\")]),v._v(\" 3. 消息队列的传递服务模型\")]),v._v(\" \"),t(\"p\",[v._v(\"消息队列的 \"),t(\"strong\",[v._v(\"传递服务模型\")]),v._v(\" 如下图所示：\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/wzphkb.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"h2\",{attrs:{id:\"_4-消息队列的的传输模式\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-消息队列的的传输模式\"}},[v._v(\"#\")]),v._v(\" 4. 消息队列的的传输模式\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_4-1-点对点模型\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-1-点对点模型\"}},[v._v(\"#\")]),v._v(\" 4.1. 点对点模型\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"点对点模型\")]),v._v(\" 用于 \"),t(\"strong\",[v._v(\"消息生产者\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"消息消费者\")]),v._v(\" 之间 \"),t(\"strong\",[v._v(\"点到点\")]),v._v(\" 的通信。消息生产者将消息发送到由某个名字标识的特定消费者。这个名字实际上对应消费服务中的一个 \"),t(\"strong\",[v._v(\"队列\")]),v._v(\"（\"),t(\"code\",[v._v(\"Queue\")]),v._v(\"），在消息传递给消费者之前它被 \"),t(\"strong\",[v._v(\"存储\")]),v._v(\" 在这个队列中。\"),t(\"strong\",[v._v(\"队列消息\")]),v._v(\" 可以放在 \"),t(\"strong\",[v._v(\"内存\")]),v._v(\" 中也可以 \"),t(\"strong\",[v._v(\"持久化\")]),v._v(\"，以保证在消息服务出现故障时仍然能够传递消息。\")]),v._v(\" \"),t(\"p\",[v._v(\"传统的点对点消息中间件通常由 \"),t(\"strong\",[v._v(\"消息队列服务\")]),v._v(\"、\"),t(\"strong\",[v._v(\"消息传递服务\")]),v._v(\"、\"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"消息应用程序接口\")]),v._v(\" \"),t(\"code\",[v._v(\"API\")]),v._v(\" 组成，其典型的结构如下图所示。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/4ozrib.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"特点：\")])]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"每个消息只用一个消费者；\")]),v._v(\" \"),t(\"li\",[v._v(\"发送者和接受者没有时间依赖；\")]),v._v(\" \"),t(\"li\",[v._v(\"接受者确认消息接受和处理成功。\")])]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"示意图如下所示：\")])]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/1qz68s.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_4-2-发布-订阅模型-pub-sub\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-2-发布-订阅模型-pub-sub\"}},[v._v(\"#\")]),v._v(\" 4.2. 发布/订阅模型（Pub/Sub）\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"发布者/订阅者\")]),v._v(\" 模型支持向一个特定的 \"),t(\"strong\",[v._v(\"消息主题\")]),v._v(\" 生产消息。\"),t(\"code\",[v._v(\"0\")]),v._v(\" 或 \"),t(\"strong\",[v._v(\"多个订阅者\")]),v._v(\" 可能对接收来自 \"),t(\"strong\",[v._v(\"特定消息主题\")]),v._v(\" 的消息感兴趣。\")]),v._v(\" \"),t(\"p\",[v._v(\"在这种模型下，发布者和订阅者彼此不知道对方，就好比是匿名公告板。这种模式被概况为：多个消费者可以获得消息，在 \"),t(\"strong\",[v._v(\"发布者\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"订阅者\")]),v._v(\" 之间存在 \"),t(\"strong\",[v._v(\"时间依赖性\")]),v._v(\"。发布者需要建立一个 \"),t(\"strong\",[v._v(\"订阅\")]),v._v(\"（\"),t(\"code\",[v._v(\"subscription\")]),v._v(\"），以便能够消费者订阅。\"),t(\"strong\",[v._v(\"订阅者\")]),v._v(\" 必须保持 \"),t(\"strong\",[v._v(\"持续的活动状态\")]),v._v(\" 并 \"),t(\"strong\",[v._v(\"接收消息\")]),v._v(\"。\")]),v._v(\" \"),t(\"p\",[v._v(\"在这种情况下，在订阅者 \"),t(\"strong\",[v._v(\"未连接时\")]),v._v(\"，发布的消息将在订阅者 \"),t(\"strong\",[v._v(\"重新连接\")]),v._v(\" 时 \"),t(\"strong\",[v._v(\"重新发布\")]),v._v(\"，如下图所示：\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/u9dw6i.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"特性：\")])]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"每个消息可以有多个订阅者；\")]),v._v(\" \"),t(\"li\",[v._v(\"客户端只有订阅后才能接收到消息；\")]),v._v(\" \"),t(\"li\",[v._v(\"持久订阅和非持久订阅。\")])]),v._v(\" \"),t(\"blockquote\",[t(\"p\",[v._v(\"注意：\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"发布者和订阅者有时间依赖：接受者和发布者只有建立订阅关系才能收到消息；\")]),v._v(\" \"),t(\"li\",[v._v(\"持久订阅：订阅关系建立后，消息就不会消失，不管订阅者是否都在线；\")]),v._v(\" \"),t(\"li\",[v._v(\"非持久订阅：订阅者为了接受消息，必须一直在线。 当只有一个订阅者时约等于点对点模式\")])])]),v._v(\" \"),t(\"h2\",{attrs:{id:\"_5-消息队列应用场景\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-消息队列应用场景\"}},[v._v(\"#\")]),v._v(\" 5. 消息队列应用场景\")]),v._v(\" \"),t(\"p\",[v._v(\"当你需要使用 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 时，首先需要考虑它的必要性。可以使用消息队列的场景有很多，最常用的几种，是做 \"),t(\"strong\",[v._v(\"应用程序松耦合\")]),v._v(\"、\"),t(\"strong\",[v._v(\"异步处理模式\")]),v._v(\"、\"),t(\"strong\",[v._v(\"发布与订阅\")]),v._v(\"、\"),t(\"strong\",[v._v(\"最终一致性\")]),v._v(\"、\"),t(\"strong\",[v._v(\"错峰流控\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"日志缓冲\")]),v._v(\" 等。反之，如果需要 \"),t(\"strong\",[v._v(\"强一致性\")]),v._v(\"，关注业务逻辑的处理结果，则使用 \"),t(\"code\",[v._v(\"RPC\")]),v._v(\" 显得更为合适。\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_5-1-异步处理\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-1-异步处理\"}},[v._v(\"#\")]),v._v(\" 5.1. 异步处理\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"非核心\")]),v._v(\" 流程 \"),t(\"strong\",[v._v(\"异步化\")]),v._v(\"，减少系统 \"),t(\"strong\",[v._v(\"响应时间\")]),v._v(\"，提高 \"),t(\"strong\",[v._v(\"吞吐量\")]),v._v(\"。例如：\"),t(\"strong\",[v._v(\"短信通知\")]),v._v(\"、\"),t(\"strong\",[v._v(\"终端状态推送\")]),v._v(\"、\"),t(\"code\",[v._v(\"App\")]),v._v(\" \"),t(\"strong\",[v._v(\"推送\")]),v._v(\"、\"),t(\"strong\",[v._v(\"用户注册\")]),v._v(\" 等。\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 一般都内置了 \"),t(\"strong\",[v._v(\"高效的通信机制\")]),v._v(\"，因此也可以用于单纯的消息通讯，比如实现 \"),t(\"strong\",[v._v(\"点对点消息队列\")]),v._v(\" 或者 \"),t(\"strong\",[v._v(\"聊天室\")]),v._v(\" 等。\")]),v._v(\" \"),t(\"h5\",{attrs:{id:\"应用案例\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#应用案例\"}},[v._v(\"#\")]),v._v(\" 应用案例\")]),v._v(\" \"),t(\"p\",[v._v(\"网站用户注册，注册成功后会过一会发送邮件确认或者短息。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/8gm3u2.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_5-2-系统解耦\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-2-系统解耦\"}},[v._v(\"#\")]),v._v(\" 5.2. 系统解耦\")]),v._v(\" \"),t(\"ul\",[t(\"li\",[v._v(\"系统之间不是 \"),t(\"strong\",[v._v(\"强耦合的\")]),v._v(\"，\"),t(\"strong\",[v._v(\"消息接受者\")]),v._v(\" 可以随意增加，而不需要修改 \"),t(\"strong\",[v._v(\"消息发送者的代码\")]),v._v(\"。\"),t(\"strong\",[v._v(\"消息发送者\")]),v._v(\" 的成功不依赖 \"),t(\"strong\",[v._v(\"消息接受者\")]),v._v(\"（比如：有些银行接口不稳定，但调用方并不需要依赖这些接口）。\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"不强依赖\")]),v._v(\" 于非本系统的核心流程，对于 \"),t(\"strong\",[v._v(\"非核心流程\")]),v._v(\"，可以放到消息队列中让 \"),t(\"strong\",[v._v(\"消息消费者\")]),v._v(\" 去按需消费，而 \"),t(\"strong\",[v._v(\"不影响核心主流程\")]),v._v(\"。\")])]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_5-3-最终一致性\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-3-最终一致性\"}},[v._v(\"#\")]),v._v(\" 5.3. 最终一致性\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"最终一致性\")]),v._v(\" 不是 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 的必备特性，但确实可以依靠 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 来做 \"),t(\"strong\",[v._v(\"最终一致性\")]),v._v(\" 的事情。\")]),v._v(\" \"),t(\"ul\",[t(\"li\",[t(\"strong\",[v._v(\"先写消息再操作\")]),v._v(\"，确保操作完成后再修改消息状态。\"),t(\"strong\",[v._v(\"定时任务补偿机制\")]),v._v(\" 实现消息 \"),t(\"strong\",[v._v(\"可靠发送接收\")]),v._v(\"、业务操作的可靠执行，要注意 \"),t(\"strong\",[v._v(\"消息重复\")]),v._v(\" 与 \"),t(\"strong\",[v._v(\"幂等设计\")]),v._v(\"。\")]),v._v(\" \"),t(\"li\",[v._v(\"所有不保证 \"),t(\"code\",[v._v(\"100%\")]),v._v(\" \"),t(\"strong\",[v._v(\"不丢消息\")]),v._v(\" 的消息队列，理论上无法实现 \"),t(\"strong\",[v._v(\"最终一致性\")]),v._v(\"。\")])]),v._v(\" \"),t(\"blockquote\",[t(\"p\",[v._v(\"像 \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\" 一类的设计，在设计层面上就有 \"),t(\"strong\",[v._v(\"丢消息\")]),v._v(\" 的可能（比如 \"),t(\"strong\",[v._v(\"定时刷盘\")]),v._v(\"，如果掉电就会丢消息）。哪怕只丢千分之一的消息，业务也必须用其他的手段来保证结果正确。\")])]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_5-4-广播\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-4-广播\"}},[v._v(\"#\")]),v._v(\" 5.4. 广播\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"生产者/消费者\")]),v._v(\" 模式，只需要关心消息是否 \"),t(\"strong\",[v._v(\"送达队列\")]),v._v(\"，至于谁希望订阅和需要消费，是 \"),t(\"strong\",[v._v(\"下游\")]),v._v(\" 的事情，无疑极大地减少了开发和联调的工作量。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/0u4rsc.png\",alt:\"img\"}})]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_5-5-流量削峰和流控\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-5-流量削峰和流控\"}},[v._v(\"#\")]),v._v(\" 5.5. 流量削峰和流控\")]),v._v(\" \"),t(\"p\",[v._v(\"当 \"),t(\"strong\",[v._v(\"上下游系统\")]),v._v(\" 处理能力存在差距的时候，利用 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 做一个通用的 \"),t(\"strong\",[v._v(\"“漏斗”\")]),v._v(\"，进行 \"),t(\"strong\",[v._v(\"限流控制\")]),v._v(\"。在下游有能力处理的时候，再进行分发。\")]),v._v(\" \"),t(\"blockquote\",[t(\"p\",[v._v(\"举个例子：用户在支付系统成功结账后，订单系统会通过短信系统向用户推送扣费通知。 \"),t(\"strong\",[v._v(\"短信系统\")]),v._v(\" 可能由于 \"),t(\"strong\",[v._v(\"短板效应\")]),v._v(\"，速度卡在 \"),t(\"strong\",[v._v(\"网关\")]),v._v(\" 上（每秒几百次请求），跟 \"),t(\"strong\",[v._v(\"前端的并发量\")]),v._v(\" 不是一个数量级。 于是，就造成 \"),t(\"strong\",[v._v(\"支付系统\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"短信系统\")]),v._v(\" 的处理能力出现差异化。\")])]),v._v(\" \"),t(\"p\",[v._v(\"然而用户晚上个半分钟左右收到短信，一般是不会有太大问题的。如果没有消息队列，两个系统之间通过 \"),t(\"strong\",[v._v(\"协商\")]),v._v(\"、\"),t(\"strong\",[v._v(\"滑动窗口\")]),v._v(\" 等复杂的方案也不是说不能实现。但 \"),t(\"strong\",[v._v(\"系统复杂性\")]),v._v(\" 指数级增长，势必在 \"),t(\"strong\",[v._v(\"上游\")]),v._v(\" 或者 \"),t(\"strong\",[v._v(\"下游\")]),v._v(\" 做 \"),t(\"strong\",[v._v(\"存储\")]),v._v(\"，并且要处理 \"),t(\"strong\",[v._v(\"定时\")]),v._v(\"、\"),t(\"strong\",[v._v(\"拥塞\")]),v._v(\" 等一系列问题。而且每当有 \"),t(\"strong\",[v._v(\"处理能力有差距\")]),v._v(\" 的时候，都需要 \"),t(\"strong\",[v._v(\"单独\")]),v._v(\" 开发一套逻辑来维护这套逻辑。\")]),v._v(\" \"),t(\"p\",[v._v(\"所以，利用中间系统转储两个系统的通信内容，并在下游系统有能力处理这些消息的时候，再处理这些消息，是一套相对较通用的方式。\")]),v._v(\" \"),t(\"h4\",{attrs:{id:\"应用案例-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#应用案例-2\"}},[v._v(\"#\")]),v._v(\" 应用案例\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"把消息队列当成可靠的 \"),t(\"strong\",[v._v(\"消息暂存地\")]),v._v(\"，进行一定程度的 \"),t(\"strong\",[v._v(\"消息堆积\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"定时进行消息投递，比如模拟 \"),t(\"strong\",[v._v(\"用户秒杀\")]),v._v(\" 访问，进行 \"),t(\"strong\",[v._v(\"系统性能压测\")]),v._v(\"。\")])]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/l1jd43.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_5-6-日志处理\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-6-日志处理\"}},[v._v(\"#\")]),v._v(\" 5.6. 日志处理\")]),v._v(\" \"),t(\"p\",[v._v(\"将消息队列用在 \"),t(\"strong\",[v._v(\"日志处理\")]),v._v(\" 中，比如 \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\" 的应用，解决 \"),t(\"strong\",[v._v(\"海量日志\")]),v._v(\" 传输和缓冲的问题。\")]),v._v(\" \"),t(\"h4\",{attrs:{id:\"应用案例-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#应用案例-3\"}},[v._v(\"#\")]),v._v(\" 应用案例\")]),v._v(\" \"),t(\"p\",[v._v(\"把日志进行集中收集，用于计算 \"),t(\"code\",[v._v(\"PV\")]),v._v(\"、\"),t(\"strong\",[v._v(\"用户行为分析\")]),v._v(\" 等等。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/5zzqes.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_5-7-消息通讯\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-7-消息通讯\"}},[v._v(\"#\")]),v._v(\" 5.7. 消息通讯\")]),v._v(\" \"),t(\"p\",[v._v(\"消息队列一般都内置了 \"),t(\"strong\",[v._v(\"高效的通信机制\")]),v._v(\"，因此也可以用于单纯的 \"),t(\"strong\",[v._v(\"消息通讯\")]),v._v(\"，比如实现 \"),t(\"strong\",[v._v(\"点对点消息队列\")]),v._v(\" 或者 \"),t(\"strong\",[v._v(\"聊天室\")]),v._v(\" 等。\")]),v._v(\" \"),t(\"h2\",{attrs:{id:\"_6-消息队列的推拉模型\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_6-消息队列的推拉模型\"}},[v._v(\"#\")]),v._v(\" 6. 消息队列的推拉模型\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_6-1-push推消息模型\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_6-1-push推消息模型\"}},[v._v(\"#\")]),v._v(\" 6.1. Push推消息模型\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"消息生产者\")]),v._v(\" 将消息发送给 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\"，\"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 又将消息推给 \"),t(\"strong\",[v._v(\"消息消费者\")]),v._v(\"。\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_6-2-pull拉消息模型\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_6-2-pull拉消息模型\"}},[v._v(\"#\")]),v._v(\" 6.2. Pull拉消息模型\")]),v._v(\" \"),t(\"p\",[t(\"strong\",[v._v(\"消费者\")]),v._v(\" 请求 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 接受消息，\"),t(\"strong\",[v._v(\"消息生产者\")]),v._v(\" 从 \"),t(\"strong\",[v._v(\"消息队列\")]),v._v(\" 中拉该消息。\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_6-3-两种类型的区别\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_6-3-两种类型的区别\"}},[v._v(\"#\")]),v._v(\" 6.3. 两种类型的区别\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/o2vb3o.jpg\",alt:\"img\"}})]),v._v(\" \"),t(\"h2\",{attrs:{id:\"_7-消息队列技术对比\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-消息队列技术对比\"}},[v._v(\"#\")]),v._v(\" 7. 消息队列技术对比\")]),v._v(\" \"),t(\"p\",[v._v(\"本部分主要介绍四种常用的消息队列（\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" / \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" / \"),t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" / \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\"）的主要特性、优点、缺点。\")]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_7-1-activemq\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-1-activemq\"}},[v._v(\"#\")]),v._v(\" 7.1. ActiveMQ\")]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 是由 \"),t(\"code\",[v._v(\"Apache\")]),v._v(\" 出品，\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 是一个完全支持\"),t(\"code\",[v._v(\"JMS1.1\")]),v._v(\" 和 \"),t(\"code\",[v._v(\"J2EE 1.4\")]),v._v(\" 规范的 \"),t(\"code\",[v._v(\"JMS Provider\")]),v._v(\" 实现。它非常快速，支持 \"),t(\"strong\",[v._v(\"多种语言的客户端\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"协议\")]),v._v(\"，而且可以非常容易的嵌入到企业的应用环境中，并有许多高级功能。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/p4is7u.png\",alt:\"img\"}})]),v._v(\" \"),t(\"h4\",{attrs:{id:\"a-主要特性\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#a-主要特性\"}},[v._v(\"#\")]),v._v(\" (a) 主要特性\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[t(\"strong\",[v._v(\"服从JMS规范\")]),v._v(\"：\"),t(\"code\",[v._v(\"JMS\")]),v._v(\" 规范提供了良好的标准和保证，包括：\"),t(\"strong\",[v._v(\"同步\")]),v._v(\" 或 \"),t(\"strong\",[v._v(\"异步\")]),v._v(\" 的消息分发，一次和仅一次的消息分发，\"),t(\"strong\",[v._v(\"消息接收\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"订阅\")]),v._v(\" 等等。遵从 \"),t(\"code\",[v._v(\"JMS\")]),v._v(\" 规范的好处在于，不论使用什么 \"),t(\"code\",[v._v(\"JMS\")]),v._v(\" 实现提供者，这些基础特性都是可用的；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"连接灵活性\")]),v._v(\"：\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 提供了广泛的 \"),t(\"strong\",[v._v(\"连接协议\")]),v._v(\"，支持的协议有：\"),t(\"code\",[v._v(\"HTTP/S\")]),v._v(\"，\"),t(\"code\",[v._v(\"IP\")]),v._v(\" \"),t(\"strong\",[v._v(\"多播\")]),v._v(\"，\"),t(\"code\",[v._v(\"SSL\")]),v._v(\"，\"),t(\"code\",[v._v(\"TCP\")]),v._v(\"，\"),t(\"code\",[v._v(\"UDP\")]),v._v(\" 等等。对众多协议的支持让 \"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 拥有了很好的灵活性；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"支持的协议种类多\")]),v._v(\"：\"),t(\"code\",[v._v(\"OpenWire\")]),v._v(\"、\"),t(\"code\",[v._v(\"STOMP\")]),v._v(\"、\"),t(\"code\",[v._v(\"REST\")]),v._v(\"、\"),t(\"code\",[v._v(\"XMPP\")]),v._v(\"、\"),t(\"code\",[v._v(\"AMQP\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"持久化插件和安全插件\")]),v._v(\"：\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 提供了 \"),t(\"strong\",[v._v(\"多种持久化\")]),v._v(\" 选择。而且，\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 的安全性也可以完全依据用户需求进行 \"),t(\"strong\",[v._v(\"自定义鉴权\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"授权\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"支持的客户端语言种类多\")]),v._v(\"：除了 \"),t(\"code\",[v._v(\"Java\")]),v._v(\" 之外，还有：\"),t(\"code\",[v._v(\"C/C++\")]),v._v(\"，\"),t(\"code\",[v._v(\".NET\")]),v._v(\"，\"),t(\"code\",[v._v(\"Perl\")]),v._v(\"，\"),t(\"code\",[v._v(\"PHP\")]),v._v(\"，\"),t(\"code\",[v._v(\"Python\")]),v._v(\"，\"),t(\"code\",[v._v(\"Ruby\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"代理集群\")]),v._v(\"：多个 \"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" \"),t(\"strong\",[v._v(\"代理\")]),v._v(\" 可以组成一个 \"),t(\"strong\",[v._v(\"集群\")]),v._v(\" 来提供服务；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"异常简单的管理\")]),v._v(\"：\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 是以开发者思维被设计的。所以，它并不需要专门的管理员，因为它提供了简单又使用的管理特性。有很多中方法可以 \"),t(\"strong\",[v._v(\"监控\")]),v._v(\" \"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 不同层面的数据，包括使用在 \"),t(\"code\",[v._v(\"JConsole\")]),v._v(\" 或者在 \"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 的 \"),t(\"code\",[v._v(\"Web Console\")]),v._v(\" 中使用 \"),t(\"code\",[v._v(\"JMX\")]),v._v(\"。通过处理 \"),t(\"code\",[v._v(\"JMX\")]),v._v(\" 的告警消息，通过使用 \"),t(\"strong\",[v._v(\"命令行脚本\")]),v._v(\"，甚至可以通过监控各种类型的 \"),t(\"strong\",[v._v(\"日志\")]),v._v(\"。\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"b-部署环境\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#b-部署环境\"}},[v._v(\"#\")]),v._v(\" (b) 部署环境\")]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 可以运行在 \"),t(\"code\",[v._v(\"Java\")]),v._v(\" 语言所支持的平台之上。使用 \"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 需要：\")]),v._v(\" \"),t(\"ul\",[t(\"li\",[t(\"code\",[v._v(\"Java JDK\")])]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 安装包\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"c-优点\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#c-优点\"}},[v._v(\"#\")]),v._v(\" (c) 优点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[t(\"strong\",[v._v(\"跨平台\")]),v._v(\" (\"),t(\"code\",[v._v(\"JAVA\")]),v._v(\" 编写与平台无关，\"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 几乎可以运行在任何的 \"),t(\"code\",[v._v(\"JVM\")]),v._v(\" 上)；\")]),v._v(\" \"),t(\"li\",[v._v(\"可以用 \"),t(\"code\",[v._v(\"JDBC\")]),v._v(\"：可以将 \"),t(\"strong\",[v._v(\"数据持久化\")]),v._v(\" 到数据库。虽然使用 \"),t(\"code\",[v._v(\"JDBC\")]),v._v(\" 会降低 \"),t(\"code\",[v._v(\"ActiveMQ\")]),v._v(\" 的性能，但是数据库一直都是开发人员最熟悉的存储介质；\")]),v._v(\" \"),t(\"li\",[v._v(\"支持 \"),t(\"code\",[v._v(\"JMS\")]),v._v(\" 规范：支持 \"),t(\"code\",[v._v(\"JMS\")]),v._v(\" 规范提供的 \"),t(\"strong\",[v._v(\"统一接口\")]),v._v(\";\")]),v._v(\" \"),t(\"li\",[v._v(\"支持 \"),t(\"strong\",[v._v(\"自动重连\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"错误重试机制\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"有安全机制：支持基于 \"),t(\"code\",[v._v(\"shiro\")]),v._v(\"，\"),t(\"code\",[v._v(\"jaas\")]),v._v(\" 等多种 \"),t(\"strong\",[v._v(\"安全配置机制\")]),v._v(\"，可以对 \"),t(\"code\",[v._v(\"Queue/Topic\")]),v._v(\" 进行 \"),t(\"strong\",[v._v(\"认证和授权\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"监控完善：拥有完善的 \"),t(\"strong\",[v._v(\"监控\")]),v._v(\"，包括 \"),t(\"code\",[v._v(\"Web Console\")]),v._v(\"，\"),t(\"code\",[v._v(\"JMX\")]),v._v(\"，\"),t(\"code\",[v._v(\"Shell\")]),v._v(\" 命令行，\"),t(\"code\",[v._v(\"Jolokia\")]),v._v(\" 的 \"),t(\"code\",[v._v(\"RESTful API\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"界面友善：提供的 \"),t(\"code\",[v._v(\"Web Console\")]),v._v(\" 可以满足大部分情况，还有很多 \"),t(\"strong\",[v._v(\"第三方的组件\")]),v._v(\" 可以使用，比如 \"),t(\"code\",[v._v(\"hawtio\")]),v._v(\"；\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"d-缺点\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#d-缺点\"}},[v._v(\"#\")]),v._v(\" (d) 缺点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"社区活跃度不及 \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 高；\")]),v._v(\" \"),t(\"li\",[v._v(\"根据其他用户反馈，会出莫名其妙的问题，会 \"),t(\"strong\",[v._v(\"丢失消息\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"目前重心放到 \"),t(\"code\",[v._v(\"activemq 6.0\")]),v._v(\" 产品 \"),t(\"code\",[v._v(\"Apollo\")]),v._v(\"，对 \"),t(\"code\",[v._v(\"5.x\")]),v._v(\" 的维护较少；\")]),v._v(\" \"),t(\"li\",[v._v(\"不适合用于 \"),t(\"strong\",[v._v(\"上千个队列\")]),v._v(\" 的应用场景；\")])]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_7-2-rabbitmq\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-2-rabbitmq\"}},[v._v(\"#\")]),v._v(\" 7.2. RabbitMQ\")]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 于 \"),t(\"code\",[v._v(\"2007\")]),v._v(\" 年发布，是一个在 \"),t(\"code\",[v._v(\"AMQP\")]),v._v(\" (\"),t(\"strong\",[v._v(\"高级消息队列协议\")]),v._v(\")基础上完成的，可复用的企业消息系统，是当前最主流的消息中间件之一。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/djwqry.png\",alt:\"img\"}})]),v._v(\" \"),t(\"h4\",{attrs:{id:\"a-主要特性-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#a-主要特性-2\"}},[v._v(\"#\")]),v._v(\" (a) 主要特性\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[t(\"strong\",[v._v(\"可靠性\")]),v._v(\"：提供了多种技术可以让你在 \"),t(\"strong\",[v._v(\"性能\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"可靠性\")]),v._v(\" 之间进行 \"),t(\"strong\",[v._v(\"权衡\")]),v._v(\"。这些技术包括 \"),t(\"strong\",[v._v(\"持久性机制\")]),v._v(\"、\"),t(\"strong\",[v._v(\"投递确认\")]),v._v(\"、\"),t(\"strong\",[v._v(\"发布者证实\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"高可用性机制\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"灵活的路由\")]),v._v(\"：消息在到达队列前是通过 \"),t(\"strong\",[v._v(\"交换机\")]),v._v(\" 进行 \"),t(\"strong\",[v._v(\"路由\")]),v._v(\" 的。\"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 为典型的路由逻辑提供了 \"),t(\"strong\",[v._v(\"多种内置交换机\")]),v._v(\" 类型。如果你有更复杂的路由需求，可以将这些交换机组合起来使用，你甚至可以实现自己的交换机类型，并且当做 \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 的 \"),t(\"strong\",[v._v(\"插件\")]),v._v(\" 来使用；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"消息集群\")]),v._v(\"：在相同局域网中的多个 \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 服务器可以 \"),t(\"strong\",[v._v(\"聚合\")]),v._v(\" 在一起，作为一个独立的逻辑代理来使用；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"队列高可用\")]),v._v(\"：队列可以在集群中的机器上 \"),t(\"strong\",[v._v(\"进行镜像\")]),v._v(\"，以确保在硬件问题下还保证 \"),t(\"strong\",[v._v(\"消息安全\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"支持多种协议\")]),v._v(\"：支持 \"),t(\"strong\",[v._v(\"多种消息队列协议\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"支持多种语言\")]),v._v(\"：用 \"),t(\"code\",[v._v(\"Erlang\")]),v._v(\" 语言编写，支持只要是你能想到的 \"),t(\"strong\",[v._v(\"所有编程语言\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"管理界面\")]),v._v(\"： \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 有一个易用的 \"),t(\"strong\",[v._v(\"用户界面\")]),v._v(\"，使得用户可以 \"),t(\"strong\",[v._v(\"监控\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"管理\")]),v._v(\" 消息 \"),t(\"code\",[v._v(\"Broker\")]),v._v(\" 的许多方面；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"跟踪机制\")]),v._v(\"：如果 \"),t(\"strong\",[v._v(\"消息异常\")]),v._v(\"，\"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 提供消息跟踪机制，使用者可以找出发生了什么；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"插件机制\")]),v._v(\"：提供了许多 \"),t(\"strong\",[v._v(\"插件\")]),v._v(\"，来从多方面进行扩展，也可以编写自己的插件。\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"b-部署环境-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#b-部署环境-2\"}},[v._v(\"#\")]),v._v(\" (b) 部署环境\")]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 可以运行在 \"),t(\"code\",[v._v(\"Erlang\")]),v._v(\" 语言所支持的平台之上，包括 \"),t(\"code\",[v._v(\"Solaris\")]),v._v(\"，\"),t(\"code\",[v._v(\"BSD\")]),v._v(\"，\"),t(\"code\",[v._v(\"Linux\")]),v._v(\"，\"),t(\"code\",[v._v(\"MacOSX\")]),v._v(\"，\"),t(\"code\",[v._v(\"TRU64\")]),v._v(\"，\"),t(\"code\",[v._v(\"Windows\")]),v._v(\" 等。使用 \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 需要：\")]),v._v(\" \"),t(\"ul\",[t(\"li\",[t(\"code\",[v._v(\"ErLang\")]),v._v(\" 语言包\")]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 安装包\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"c-优点-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#c-优点-2\"}},[v._v(\"#\")]),v._v(\" (c) 优点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"由于 \"),t(\"code\",[v._v(\"Erlang\")]),v._v(\" 语言的特性，消息队列性能较好，支持 \"),t(\"strong\",[v._v(\"高并发\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"健壮、稳定、易用、\"),t(\"strong\",[v._v(\"跨平台\")]),v._v(\"、支持 \"),t(\"strong\",[v._v(\"多种语言\")]),v._v(\"、文档齐全；\")]),v._v(\" \"),t(\"li\",[v._v(\"有消息 \"),t(\"strong\",[v._v(\"确认机制\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"持久化机制\")]),v._v(\"，可靠性高；\")]),v._v(\" \"),t(\"li\",[v._v(\"高度可定制的 \"),t(\"strong\",[v._v(\"路由\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"管理界面\")]),v._v(\" 较丰富，在互联网公司也有较大规模的应用，社区活跃度高。\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"d-缺点-2\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#d-缺点-2\"}},[v._v(\"#\")]),v._v(\" (d) 缺点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"尽管结合 \"),t(\"code\",[v._v(\"Erlang\")]),v._v(\" 语言本身的并发优势，性能较好，但是不利于做 \"),t(\"strong\",[v._v(\"二次开发和维护\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"实现了 \"),t(\"strong\",[v._v(\"代理架构\")]),v._v(\"，意味着消息在发送到客户端之前可以在 \"),t(\"strong\",[v._v(\"中央节点\")]),v._v(\" 上排队。此特性使得 \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 易于使用和部署，但是使得其 \"),t(\"strong\",[v._v(\"运行速度较慢\")]),v._v(\"，因为中央节点 \"),t(\"strong\",[v._v(\"增加了延迟\")]),v._v(\"，\"),t(\"strong\",[v._v(\"消息封装后\")]),v._v(\" 也比较大；\")]),v._v(\" \"),t(\"li\",[v._v(\"需要学习 \"),t(\"strong\",[v._v(\"比较复杂\")]),v._v(\" 的 \"),t(\"strong\",[v._v(\"接口和协议\")]),v._v(\"，学习和维护成本较高。\")])]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_7-3-rocketmq\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-3-rocketmq\"}},[v._v(\"#\")]),v._v(\" 7.3. RocketMQ\")]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 出自 \"),t(\"strong\",[v._v(\"阿里\")]),v._v(\" 的开源产品，用 \"),t(\"code\",[v._v(\"Java\")]),v._v(\" 语言实现，在设计时参考了 \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\"，并做出了自己的一些改进，\"),t(\"strong\",[v._v(\"消息可靠性上\")]),v._v(\" 比 \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\" 更好。\"),t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 在阿里内部被广泛应用在 \"),t(\"strong\",[v._v(\"订单\")]),v._v(\"，\"),t(\"strong\",[v._v(\"交易\")]),v._v(\"，\"),t(\"strong\",[v._v(\"充值\")]),v._v(\"，\"),t(\"strong\",[v._v(\"流计算\")]),v._v(\"，\"),t(\"strong\",[v._v(\"消息推送\")]),v._v(\"，\"),t(\"strong\",[v._v(\"日志流式处理\")]),v._v(\"，\"),t(\"code\",[v._v(\"binglog\")]),v._v(\" \"),t(\"strong\",[v._v(\"分发\")]),v._v(\" 等场景。\")]),v._v(\" \"),t(\"h4\",{attrs:{id:\"a-主要特性-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#a-主要特性-3\"}},[v._v(\"#\")]),v._v(\" (a) 主要特性\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/9amnow.png\",alt:\"img\"}})]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"基于 \"),t(\"strong\",[v._v(\"队列模型\")]),v._v(\"：具有 \"),t(\"strong\",[v._v(\"高性能\")]),v._v(\"、\"),t(\"strong\",[v._v(\"高可靠\")]),v._v(\"、\"),t(\"strong\",[v._v(\"高实时\")]),v._v(\"、\"),t(\"strong\",[v._v(\"分布式\")]),v._v(\" 等特点；\")]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"Producer\")]),v._v(\"、\"),t(\"code\",[v._v(\"Consumer\")]),v._v(\"、\"),t(\"strong\",[v._v(\"队列\")]),v._v(\" 都支持 \"),t(\"strong\",[v._v(\"分布式\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"Producer\")]),v._v(\" 向一些队列轮流发送消息，\"),t(\"strong\",[v._v(\"队列集合\")]),v._v(\" 称为 \"),t(\"code\",[v._v(\"Topic\")]),v._v(\"。\"),t(\"code\",[v._v(\"Consumer\")]),v._v(\" 如果做 \"),t(\"strong\",[v._v(\"广播消费\")]),v._v(\"，则一个 \"),t(\"code\",[v._v(\"Consumer\")]),v._v(\" 实例消费这个 \"),t(\"code\",[v._v(\"Topic\")]),v._v(\" 对应的 \"),t(\"strong\",[v._v(\"所有队列\")]),v._v(\"；如果做 \"),t(\"strong\",[v._v(\"集群消费\")]),v._v(\"，则 \"),t(\"strong\",[v._v(\"多个\")]),v._v(\" \"),t(\"code\",[v._v(\"Consumer\")]),v._v(\" 实例 \"),t(\"strong\",[v._v(\"平均消费\")]),v._v(\" 这个 \"),t(\"code\",[v._v(\"Topic\")]),v._v(\" 对应的队列集合；\")]),v._v(\" \"),t(\"li\",[v._v(\"能够保证 \"),t(\"strong\",[v._v(\"严格的消息顺序\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"提供丰富的 \"),t(\"strong\",[v._v(\"消息拉取模式\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"高效的订阅者 \"),t(\"strong\",[v._v(\"水平扩展\")]),v._v(\"能力；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"实时\")]),v._v(\" 的 \"),t(\"strong\",[v._v(\"消息订阅机制\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"亿级 \"),t(\"strong\",[v._v(\"消息堆积\")]),v._v(\" 能力；\")]),v._v(\" \"),t(\"li\",[v._v(\"较少的外部依赖。\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"b-部署环境-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#b-部署环境-3\"}},[v._v(\"#\")]),v._v(\" (b) 部署环境\")]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 可以运行在 \"),t(\"code\",[v._v(\"Java\")]),v._v(\" 语言所支持的平台之上。使用 \"),t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 需要：\")]),v._v(\" \"),t(\"ul\",[t(\"li\",[t(\"code\",[v._v(\"Java JDK\")])]),v._v(\" \"),t(\"li\",[v._v(\"安装 \"),t(\"code\",[v._v(\"git\")]),v._v(\"、\"),t(\"code\",[v._v(\"Maven\")])]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 安装包\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"c-优点-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#c-优点-3\"}},[v._v(\"#\")]),v._v(\" (c) 优点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[t(\"strong\",[v._v(\"单机\")]),v._v(\" 支持 \"),t(\"code\",[v._v(\"1\")]),v._v(\" 万以上 \"),t(\"strong\",[v._v(\"持久化队列\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 的所有消息都是 \"),t(\"strong\",[v._v(\"持久化的\")]),v._v(\"，先写入系统  \"),t(\"code\",[v._v(\"PAGECACHE\")]),v._v(\"，然后 \"),t(\"strong\",[v._v(\"刷盘\")]),v._v(\"，可以保证 \"),t(\"strong\",[v._v(\"内存\")]),v._v(\" 与 \"),t(\"strong\",[v._v(\"磁盘\")]),v._v(\" 都有一份数据，而 \"),t(\"strong\",[v._v(\"访问\")]),v._v(\" 时，直接 \"),t(\"strong\",[v._v(\"从内存读取\")]),v._v(\"。\")]),v._v(\" \"),t(\"li\",[v._v(\"模型简单，接口易用（\"),t(\"code\",[v._v(\"JMS\")]),v._v(\" 的接口很多场合并不太实用）；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"性能非常好\")]),v._v(\"，可以允许 \"),t(\"strong\",[v._v(\"大量堆积消息\")]),v._v(\" 在 \"),t(\"code\",[v._v(\"Broker\")]),v._v(\" 中；\")]),v._v(\" \"),t(\"li\",[v._v(\"支持 \"),t(\"strong\",[v._v(\"多种消费模式\")]),v._v(\"，包括 \"),t(\"strong\",[v._v(\"集群消费\")]),v._v(\"、\"),t(\"strong\",[v._v(\"广播消费\")]),v._v(\"等；\")]),v._v(\" \"),t(\"li\",[v._v(\"各个环节 \"),t(\"strong\",[v._v(\"分布式扩展设计\")]),v._v(\"，支持 \"),t(\"strong\",[v._v(\"主从\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"高可用\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"开发度较活跃，版本更新很快。\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"d-缺点-3\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#d-缺点-3\"}},[v._v(\"#\")]),v._v(\" (d) 缺点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[v._v(\"支持的 \"),t(\"strong\",[v._v(\"客户端语言\")]),v._v(\" 不多，目前是 \"),t(\"code\",[v._v(\"Java\")]),v._v(\" 及 \"),t(\"code\",[v._v(\"C++\")]),v._v(\"，其中 \"),t(\"code\",[v._v(\"C++\")]),v._v(\" 还不成熟；\")]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 社区关注度及成熟度也不及前两者；\")]),v._v(\" \"),t(\"li\",[v._v(\"没有 \"),t(\"code\",[v._v(\"Web\")]),v._v(\" 管理界面，提供了一个 \"),t(\"code\",[v._v(\"CLI\")]),v._v(\" (命令行界面) 管理工具带来 \"),t(\"strong\",[v._v(\"查询\")]),v._v(\"、\"),t(\"strong\",[v._v(\"管理\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"诊断各种问题\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"没有在 \"),t(\"code\",[v._v(\"MQ\")]),v._v(\" 核心里实现 \"),t(\"code\",[v._v(\"JMS\")]),v._v(\" 等接口；\")])]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_7-4-kafka\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-4-kafka\"}},[v._v(\"#\")]),v._v(\" 7.4. Kafka\")]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"Apache Kafka\")]),v._v(\" 是一个 \"),t(\"strong\",[v._v(\"分布式消息发布订阅\")]),v._v(\" 系统。它最初由 \"),t(\"code\",[v._v(\"LinkedIn\")]),v._v(\" 公司基于独特的设计实现为一个 \"),t(\"strong\",[v._v(\"分布式的日志提交系统\")]),v._v(\" (\"),t(\"code\",[v._v(\"a distributed commit log\")]),v._v(\")，之后成为 \"),t(\"code\",[v._v(\"Apache\")]),v._v(\" 项目的一部分。\"),t(\"code\",[v._v(\"Kafka\")]),v._v(\" \"),t(\"strong\",[v._v(\"性能高效\")]),v._v(\"、\"),t(\"strong\",[v._v(\"可扩展良好\")]),v._v(\" 并且 \"),t(\"strong\",[v._v(\"可持久化\")]),v._v(\"。它的 \"),t(\"strong\",[v._v(\"分区特性\")]),v._v(\"，\"),t(\"strong\",[v._v(\"可复制\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"可容错\")]),v._v(\" 都是其不错的特性。\")]),v._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://p.ipic.vip/hs1qip.png\",alt:\"img\"}})]),v._v(\" \"),t(\"h4\",{attrs:{id:\"a-主要特性-4\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#a-主要特性-4\"}},[v._v(\"#\")]),v._v(\" (a) 主要特性\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[t(\"strong\",[v._v(\"快速持久化\")]),v._v(\"：可以在 \"),t(\"code\",[v._v(\"O(1)\")]),v._v(\" 的系统开销下进行 \"),t(\"strong\",[v._v(\"消息持久化\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"高吞吐\")]),v._v(\"：在一台普通的服务器上既可以达到 \"),t(\"code\",[v._v(\"10W/s\")]),v._v(\" 的 \"),t(\"strong\",[v._v(\"吞吐速率\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"完全的分布式系统\")]),v._v(\"：\"),t(\"code\",[v._v(\"Broker\")]),v._v(\"、\"),t(\"code\",[v._v(\"Producer\")]),v._v(\" 和 \"),t(\"code\",[v._v(\"Consumer\")]),v._v(\" 都原生自动支持 \"),t(\"strong\",[v._v(\"分布式\")]),v._v(\"，自动实现 \"),t(\"strong\",[v._v(\"负载均衡\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"支持 \"),t(\"strong\",[v._v(\"同步\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"异步\")]),v._v(\" 复制两种 \"),t(\"strong\",[v._v(\"高可用机制\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"支持 \"),t(\"strong\",[v._v(\"数据批量发送\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"拉取\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"零拷贝技术(zero-copy)\")]),v._v(\"：减少 \"),t(\"code\",[v._v(\"IO\")]),v._v(\" 操作步骤，提高 \"),t(\"strong\",[v._v(\"系统吞吐量\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"数据迁移\")]),v._v(\"、\"),t(\"strong\",[v._v(\"扩容\")]),v._v(\" 对用户透明；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"无需停机\")]),v._v(\" 即可扩展机器；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"其他特性\")]),v._v(\"：丰富的 \"),t(\"strong\",[v._v(\"消息拉取模型\")]),v._v(\"、高效 \"),t(\"strong\",[v._v(\"订阅者水平扩展\")]),v._v(\"、实时的 \"),t(\"strong\",[v._v(\"消息订阅\")]),v._v(\"、亿级的 \"),t(\"strong\",[v._v(\"消息堆积能力\")]),v._v(\"、定期删除机制；\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"b-部署环境-4\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#b-部署环境-4\"}},[v._v(\"#\")]),v._v(\" (b) 部署环境\")]),v._v(\" \"),t(\"p\",[v._v(\"使用 \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\" 需要：\")]),v._v(\" \"),t(\"ul\",[t(\"li\",[t(\"code\",[v._v(\"Java JDK\")])]),v._v(\" \"),t(\"li\",[t(\"code\",[v._v(\"Kafka\")]),v._v(\" 安装包\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"c-优点-4\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#c-优点-4\"}},[v._v(\"#\")]),v._v(\" (c) 优点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[t(\"strong\",[v._v(\"客户端语言丰富\")]),v._v(\"：支持 \"),t(\"code\",[v._v(\"Java\")]),v._v(\"、\"),t(\"code\",[v._v(\".Net\")]),v._v(\"、\"),t(\"code\",[v._v(\"PHP\")]),v._v(\"、\"),t(\"code\",[v._v(\"Ruby\")]),v._v(\"、\"),t(\"code\",[v._v(\"Python\")]),v._v(\"、\"),t(\"code\",[v._v(\"Go\")]),v._v(\" 等多种语言；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"高性能\")]),v._v(\"：单机写入 \"),t(\"code\",[v._v(\"TPS\")]),v._v(\" 约在 \"),t(\"code\",[v._v(\"100\")]),v._v(\" 万条/秒，消息大小 \"),t(\"code\",[v._v(\"10\")]),v._v(\" 个字节；\")]),v._v(\" \"),t(\"li\",[v._v(\"提供 \"),t(\"strong\",[v._v(\"完全分布式架构\")]),v._v(\"，并有 \"),t(\"code\",[v._v(\"replica\")]),v._v(\" 机制，拥有较高的 \"),t(\"strong\",[v._v(\"可用性\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"可靠性\")]),v._v(\"，理论上支持 \"),t(\"strong\",[v._v(\"消息无限堆积\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"支持批量操作；\")]),v._v(\" \"),t(\"li\",[t(\"strong\",[v._v(\"消费者\")]),v._v(\" 采用 \"),t(\"code\",[v._v(\"Pull\")]),v._v(\" 方式获取消息。\"),t(\"strong\",[v._v(\"消息有序\")]),v._v(\"，\"),t(\"strong\",[v._v(\"通过控制\")]),v._v(\" 能够保证所有消息被消费且仅被消费 \"),t(\"strong\",[v._v(\"一次\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"有优秀的第三方 \"),t(\"code\",[v._v(\"Kafka Web\")]),v._v(\" 管理界面 \"),t(\"code\",[v._v(\"Kafka-Manager\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"在 \"),t(\"strong\",[v._v(\"日志领域\")]),v._v(\" 比较成熟，被多家公司和多个开源项目使用。\")])]),v._v(\" \"),t(\"h4\",{attrs:{id:\"d-缺点-4\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#d-缺点-4\"}},[v._v(\"#\")]),v._v(\" (d) 缺点\")]),v._v(\" \"),t(\"ol\",[t(\"li\",[t(\"code\",[v._v(\"Kafka\")]),v._v(\" 单机超过 \"),t(\"code\",[v._v(\"64\")]),v._v(\" 个 \"),t(\"strong\",[v._v(\"队列/分区\")]),v._v(\" 时，\"),t(\"code\",[v._v(\"Load\")]),v._v(\" 时会发生明显的飙高现象。\"),t(\"strong\",[v._v(\"队列\")]),v._v(\" 越多，\"),t(\"strong\",[v._v(\"负载\")]),v._v(\" 越高，发送消息 \"),t(\"strong\",[v._v(\"响应时间变长\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"使用 \"),t(\"strong\",[v._v(\"短轮询方式\")]),v._v(\"，\"),t(\"strong\",[v._v(\"实时性\")]),v._v(\" 取决于 \"),t(\"strong\",[v._v(\"轮询间隔时间\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"消费失败 \"),t(\"strong\",[v._v(\"不支持重试\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"支持 \"),t(\"strong\",[v._v(\"消息顺序\")]),v._v(\"，但是 \"),t(\"strong\",[v._v(\"一台代理宕机\")]),v._v(\" 后，就会产生 \"),t(\"strong\",[v._v(\"消息乱序\")]),v._v(\"；\")]),v._v(\" \"),t(\"li\",[v._v(\"社区更新较慢。\")])]),v._v(\" \"),t(\"h3\",{attrs:{id:\"_7-5-几种消息队列对比\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-5-几种消息队列对比\"}},[v._v(\"#\")]),v._v(\" 7.5. 几种消息队列对比\")]),v._v(\" \"),t(\"p\",[v._v(\"这里列举了上述四种消息队列的差异对比：\")]),v._v(\" \"),t(\"table\",[t(\"thead\",[t(\"tr\",[t(\"th\"),v._v(\" \"),t(\"th\",[v._v(\"RabbitMQ\")]),v._v(\" \"),t(\"th\",[v._v(\"ActiveMQ\")]),v._v(\" \"),t(\"th\",[v._v(\"RocketMQ\")]),v._v(\" \"),t(\"th\",[v._v(\"Kafka\")])])]),v._v(\" \"),t(\"tbody\",[t(\"tr\",[t(\"td\",[v._v(\"所属社区/公司\")]),v._v(\" \"),t(\"td\",[v._v(\"Rabbit\")]),v._v(\" \"),t(\"td\",[v._v(\"Apache\")]),v._v(\" \"),t(\"td\",[v._v(\"Ali\")]),v._v(\" \"),t(\"td\",[v._v(\"Apache\")])]),v._v(\" \"),t(\"tr\",[t(\"td\",[v._v(\"开发语言\")]),v._v(\" \"),t(\"td\",[v._v(\"Erlang\")]),v._v(\" \"),t(\"td\",[v._v(\"Java\")]),v._v(\" \"),t(\"td\",[v._v(\"Java\")]),v._v(\" \"),t(\"td\",[v._v(\"Scala&Java\")])]),v._v(\" \"),t(\"tr\",[t(\"td\",[v._v(\"多语言支持\")]),v._v(\" \"),t(\"td\",[v._v(\"语言无关\")]),v._v(\" \"),t(\"td\",[v._v(\"支持，Java优先\")]),v._v(\" \"),t(\"td\",[v._v(\"Java\")]),v._v(\" \"),t(\"td\",[v._v(\"支持，Java优先\")])]),v._v(\" \"),t(\"tr\",[t(\"td\",[v._v(\"消息推拉模式\")]),v._v(\" \"),t(\"td\",[v._v(\"多协议，Pull/Push均支持\")]),v._v(\" \"),t(\"td\",[v._v(\"多协议，Pull/Push均支持\")]),v._v(\" \"),t(\"td\",[v._v(\"多协议，Pull/Push均支持\")]),v._v(\" \"),t(\"td\",[v._v(\"Pull\")])]),v._v(\" \"),t(\"tr\",[t(\"td\",[v._v(\"HA\")]),v._v(\" \"),t(\"td\",[v._v(\"master/slave模式，master提供服务，slave仅作备份\")]),v._v(\" \"),t(\"td\",[v._v(\"基于zookeeper+levelDB的master-slave实现方式\")]),v._v(\" \"),t(\"td\",[v._v(\"支持多master模式、多master多slave模式、异步复制模式、\")]),v._v(\" \"),t(\"td\",[v._v(\"支持replica机制。leader宕掉后，备份自动顶替，并重选leader\")])]),v._v(\" \"),t(\"tr\",[t(\"td\",[v._v(\"事务\")]),v._v(\" \"),t(\"td\",[v._v(\"不支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"不支持，可通过Low Level API保证仅消费一次\")])]),v._v(\" \"),t(\"tr\",[t(\"td\",[v._v(\"集群\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")])]),v._v(\" \"),t(\"tr\",[t(\"td\",[v._v(\"负载均衡\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")]),v._v(\" \"),t(\"td\",[v._v(\"支持\")])])])]),v._v(\" \"),t(\"p\",[t(\"code\",[v._v(\"Kafka\")]),v._v(\" 在于 \"),t(\"strong\",[v._v(\"分布式架构\")]),v._v(\"，\"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 基于 \"),t(\"code\",[v._v(\"AMQP\")]),v._v(\" \"),t(\"strong\",[v._v(\"协议\")]),v._v(\" 来实现，\"),t(\"code\",[v._v(\"RocketMQ\")]),v._v(\" 的思路来源于 \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\"，改成了 \"),t(\"strong\",[v._v(\"主从结构\")]),v._v(\"，在 \"),t(\"strong\",[v._v(\"事务性\")]),v._v(\" 和 \"),t(\"strong\",[v._v(\"可靠性\")]),v._v(\" 方面做了优化。广泛来说，\"),t(\"strong\",[v._v(\"电商\")]),v._v(\"、\"),t(\"strong\",[v._v(\"金融\")]),v._v(\" 等对 \"),t(\"strong\",[v._v(\"事务一致性\")]),v._v(\" 要求很高的，可以考虑 \"),t(\"code\",[v._v(\"RabbitMQ\")]),v._v(\" 和 \"),t(\"code\",[v._v(\"RocketMQ\")]),v._v(\"，对 \"),t(\"strong\",[v._v(\"性能要求高\")]),v._v(\" 的可考虑 \"),t(\"code\",[v._v(\"Kafka\")]),v._v(\"。\")]),v._v(\" \"),t(\"h2\",{attrs:{id:\"参考与感谢\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#参考与感谢\"}},[v._v(\"#\")]),v._v(\" 参考与感谢\")]),v._v(\" \"),t(\"p\",[v._v(\"https://juejin.im/post/5b41fe36e51d45191252e79e#heading-2\")])])}),[],!1,null,null,null);_.default=s.exports}}]);","extractedComments":[]}