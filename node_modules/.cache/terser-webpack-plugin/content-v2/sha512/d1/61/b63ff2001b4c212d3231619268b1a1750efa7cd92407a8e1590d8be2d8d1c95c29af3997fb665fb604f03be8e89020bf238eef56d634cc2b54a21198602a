{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{598:function(e,v,r){\"use strict\";r.r(v);var _=r(4),o=Object(_.a)({},(function(){var e=this,v=e.$createElement,r=e._self._c||v;return r(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[r(\"h2\",{attrs:{id:\"è°ˆä¸‹ä½ å¯¹-zookeeper-çš„è®¤è¯†\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#è°ˆä¸‹ä½ å¯¹-zookeeper-çš„è®¤è¯†\"}},[e._v(\"#\")]),e._v(\" è°ˆä¸‹ä½ å¯¹ Zookeeper çš„è®¤è¯†ï¼Ÿ\")]),e._v(\" \"),r(\"p\",[e._v(\"ZooKeeper æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œå¼€æ”¾æºç çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºåè°ƒæœåŠ¡ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡çš„è½¯ä»¶ï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åŸŸåæœåŠ¡ã€åˆ†å¸ƒå¼åŒæ­¥ã€ç»„æœåŠ¡ç­‰ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"ZooKeeper çš„ç›®æ ‡å°±æ˜¯å°è£…å¥½å¤æ‚æ˜“å‡ºé”™çš„å…³é”®æœåŠ¡ï¼Œå°†ç®€å•æ˜“ç”¨çš„æ¥å£å’Œæ€§èƒ½é«˜æ•ˆã€åŠŸèƒ½ç¨³å®šçš„ç³»ç»Ÿæä¾›ç»™ç”¨æˆ·ã€‚\")]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"zookeeper-éƒ½æœ‰å“ªäº›åŠŸèƒ½\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#zookeeper-éƒ½æœ‰å“ªäº›åŠŸèƒ½\"}},[e._v(\"#\")]),e._v(\" Zookeeper éƒ½æœ‰å“ªäº›åŠŸèƒ½ï¼Ÿ\")]),e._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[e._v(\"é›†ç¾¤ç®¡ç†ï¼šç›‘æ§èŠ‚ç‚¹å­˜æ´»çŠ¶æ€ã€è¿è¡Œè¯·æ±‚ç­‰ï¼›\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"ä¸»èŠ‚ç‚¹é€‰ä¸¾ï¼šä¸»èŠ‚ç‚¹æŒ‚æ‰äº†ä¹‹åå¯ä»¥ä»å¤‡ç”¨çš„èŠ‚ç‚¹å¼€å§‹æ–°ä¸€è½®é€‰ä¸»ï¼Œä¸»èŠ‚ç‚¹é€‰ä¸¾è¯´çš„å°±æ˜¯è¿™ä¸ªé€‰ä¸¾çš„è¿‡ç¨‹ï¼Œä½¿ç”¨ Zookeeper å¯ä»¥ååŠ©å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼›\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"åˆ†å¸ƒå¼é”ï¼šZookeeper æä¾›ä¸¤ç§é”ï¼šç‹¬å é”ã€å…±äº«é”ã€‚ç‹¬å é”å³ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨èµ„æºï¼Œå…±äº«é”æ˜¯è¯»é”å…±äº«ï¼Œè¯»å†™äº’æ–¥ï¼Œå³å¯ä»¥æœ‰å¤šçº¿çº¿ç¨‹åŒæ—¶è¯»åŒä¸€ä¸ªèµ„æºï¼Œå¦‚æœè¦ä½¿ç”¨å†™é”ä¹Ÿåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚Zookeeper å¯ä»¥å¯¹åˆ†å¸ƒå¼é”è¿›è¡Œæ§åˆ¶ã€‚\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"å‘½åæœåŠ¡ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé€šè¿‡ä½¿ç”¨å‘½åæœåŠ¡ï¼Œå®¢æˆ·ç«¯åº”ç”¨èƒ½å¤Ÿæ ¹æ®æŒ‡å®šåå­—æ¥è·å–èµ„æºæˆ–æœåŠ¡çš„åœ°å€ï¼Œæä¾›è€…ç­‰ä¿¡æ¯ã€‚\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"ç»Ÿä¸€é…ç½®ç®¡ç†ï¼šåˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œé…ç½®æ–‡ä»¶ç®¡ç†å’ŒåŒæ­¥æ˜¯ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼Œä¸€ä¸ªé›†ç¾¤ä¸­ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„é…ç½®ä¿¡æ¯æ˜¯ä¸€è‡´çš„ï¼Œæ¯”å¦‚ Hadoop é›†ç¾¤ã€é›†ç¾¤ä¸­çš„æ•°æ®åº“é…ç½®ä¿¡æ¯ç­‰å…¨å±€é…ç½®\")])])]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"zookeeperè´Ÿè½½å‡è¡¡å’Œnginxè´Ÿè½½å‡è¡¡åŒºåˆ«\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#zookeeperè´Ÿè½½å‡è¡¡å’Œnginxè´Ÿè½½å‡è¡¡åŒºåˆ«\"}},[e._v(\"#\")]),e._v(\" zookeeperè´Ÿè½½å‡è¡¡å’Œnginxè´Ÿè½½å‡è¡¡åŒºåˆ«\")]),e._v(\" \"),r(\"p\",[e._v(\"Nginxæ˜¯è‘—åçš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œzkæ˜¯åˆ†å¸ƒå¼åè°ƒæœåŠ¡æ¡†æ¶ï¼Œéƒ½å¯ä»¥åšè´Ÿè½½å‡è¡¡\")]),e._v(\" \"),r(\"p\",[e._v(\"zkçš„è´Ÿè½½å‡è¡¡æ˜¯å¯ä»¥è°ƒæ§ï¼Œnginxåªæ˜¯èƒ½è°ƒæƒé‡ï¼Œå…¶ä»–éœ€è¦å¯æ§çš„éƒ½éœ€è¦è‡ªå·±å†™æ’ä»¶ï¼›\")]),e._v(\" \"),r(\"p\",[e._v(\"ä½†æ˜¯nginxçš„ååé‡æ¯”zkå¤§å¾ˆå¤šï¼Œåº”è¯¥è¯´æŒ‰ä¸šåŠ¡é€‰æ‹©ç”¨å“ªç§æ–¹å¼\")]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"ä¸€è‡´æ€§åè®®2pcã€3pc\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#ä¸€è‡´æ€§åè®®2pcã€3pc\"}},[e._v(\"#\")]),e._v(\" ä¸€è‡´æ€§åè®®2PCã€3PCï¼Ÿ\")]),e._v(\" \"),r(\"h3\",{attrs:{id:\"_2pc\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2pc\"}},[e._v(\"#\")]),e._v(\" 2PC\")]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"é˜¶æ®µä¸€ï¼šæäº¤äº‹åŠ¡è¯·æ±‚ï¼ˆâ€æŠ•ç¥¨é˜¶æ®µâ€œï¼‰\")])]),e._v(\" \"),r(\"p\",[e._v(\"å½“è¦æ‰§è¡Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„æ—¶å€™ï¼Œäº‹åŠ¡å‘èµ·è€…é¦–å…ˆå‘åè°ƒè€…å‘èµ·äº‹åŠ¡è¯·æ±‚ï¼Œç„¶ååè°ƒè€…ä¼šç»™æ‰€æœ‰å‚ä¸è€…å‘é€ \"),r(\"code\",[e._v(\"prepare\")]),e._v(\" è¯·æ±‚ï¼ˆå…¶ä¸­åŒ…æ‹¬äº‹åŠ¡å†…å®¹ï¼‰å‘Šè¯‰å‚ä¸è€…ä½ ä»¬éœ€è¦æ‰§è¡Œäº‹åŠ¡äº†ï¼Œå¦‚æœèƒ½æ‰§è¡Œæˆ‘å‘çš„äº‹åŠ¡å†…å®¹é‚£ä¹ˆå°±å…ˆæ‰§è¡Œä½†ä¸æäº¤ï¼Œæ‰§è¡Œåè¯·ç»™æˆ‘å›å¤ã€‚ç„¶åå‚ä¸è€…æ”¶åˆ° \"),r(\"code\",[e._v(\"prepare\")]),e._v(\" æ¶ˆæ¯åï¼Œä»–ä»¬ä¼šå¼€å§‹æ‰§è¡Œäº‹åŠ¡ï¼ˆä½†ä¸æäº¤ï¼‰ï¼Œå¹¶å°† \"),r(\"code\",[e._v(\"Undo\")]),e._v(\" å’Œ \"),r(\"code\",[e._v(\"Redo\")]),e._v(\" ä¿¡æ¯è®°å…¥äº‹åŠ¡æ—¥å¿—ä¸­ï¼Œä¹‹åå‚ä¸è€…å°±å‘åè°ƒè€…åé¦ˆæ˜¯å¦å‡†å¤‡å¥½äº†\")]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"é˜¶æ®µäºŒï¼šæ‰§è¡Œäº‹åŠ¡æäº¤\")])]),e._v(\" \"),r(\"p\",[e._v(\"åè°ƒè€…æ ¹æ®å„å‚ä¸è€…çš„åé¦ˆæƒ…å†µå†³å®šæœ€ç»ˆæ˜¯å¦å¯ä»¥æäº¤äº‹åŠ¡ï¼Œå¦‚æœåé¦ˆéƒ½æ˜¯Yesï¼Œå‘é€æäº¤\"),r(\"code\",[e._v(\"commit\")]),e._v(\"è¯·æ±‚ï¼Œå‚ä¸è€…æäº¤æˆåŠŸåè¿”å› \"),r(\"code\",[e._v(\"Ack\")]),e._v(\" æ¶ˆæ¯ï¼Œåè°ƒè€…æ¥æ”¶åå°±å®Œæˆäº†ã€‚å¦‚æœåé¦ˆæ˜¯No æˆ–è€…è¶…æ—¶æœªåé¦ˆï¼Œå‘é€ \"),r(\"code\",[e._v(\"Rollback\")]),e._v(\" è¯·æ±‚ï¼Œåˆ©ç”¨é˜¶æ®µä¸€è®°å½•è¡¨çš„ \"),r(\"code\",[e._v(\"Undo\")]),e._v(\" ä¿¡æ¯æ‰§è¡Œå›æ»šï¼Œå¹¶åé¦ˆç»™åè°ƒè€…\"),r(\"code\",[e._v(\"Ack\")]),e._v(\" ï¼Œä¸­æ–­æ¶ˆæ¯\")]),e._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:\"https://tva1.sinaimg.cn/large/00831rSTly1gclosfvncqj30hs09j0td.jpg\",alt:\"\"}})]),e._v(\" \"),r(\"p\",[e._v(\"ä¼˜ç‚¹ï¼šåŸç†ç®€å•ã€å®ç°æ–¹ä¾¿ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"ç¼ºç‚¹ï¼š\")]),e._v(\" \"),r(\"ul\",[r(\"li\",[r(\"strong\",[e._v(\"å•ç‚¹æ•…éšœé—®é¢˜\")]),e._v(\"ï¼Œå¦‚æœåè°ƒè€…æŒ‚äº†é‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿéƒ½å¤„äºä¸å¯ç”¨çš„çŠ¶æ€äº†\")]),e._v(\" \"),r(\"li\",[r(\"strong\",[e._v(\"é˜»å¡é—®é¢˜\")]),e._v(\"ï¼Œå³å½“åè°ƒè€…å‘é€ \"),r(\"code\",[e._v(\"prepare\")]),e._v(\" è¯·æ±‚ï¼Œå‚ä¸è€…æ”¶åˆ°ä¹‹åå¦‚æœèƒ½å¤„ç†é‚£ä¹ˆå®ƒå°†ä¼šè¿›è¡Œäº‹åŠ¡çš„å¤„ç†ä½†å¹¶ä¸æäº¤ï¼Œè¿™ä¸ªæ—¶å€™ä¼šä¸€ç›´å ç”¨ç€èµ„æºä¸é‡Šæ”¾ï¼Œå¦‚æœæ­¤æ—¶åè°ƒè€…æŒ‚äº†ï¼Œé‚£ä¹ˆè¿™äº›èµ„æºéƒ½ä¸ä¼šå†é‡Šæ”¾äº†ï¼Œè¿™ä¼šæå¤§å½±å“æ€§èƒ½\")]),e._v(\" \"),r(\"li\",[r(\"strong\",[e._v(\"æ•°æ®ä¸ä¸€è‡´é—®é¢˜\")]),e._v(\"ï¼Œæ¯”å¦‚å½“ç¬¬äºŒé˜¶æ®µï¼Œåè°ƒè€…åªå‘é€äº†ä¸€éƒ¨åˆ†çš„ \"),r(\"code\",[e._v(\"commit\")]),e._v(\" è¯·æ±‚å°±æŒ‚äº†ï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€ï¼Œæ”¶åˆ°æ¶ˆæ¯çš„å‚ä¸è€…ä¼šè¿›è¡Œäº‹åŠ¡çš„æäº¤ï¼Œè€Œåé¢æ²¡æ”¶åˆ°çš„åˆ™ä¸ä¼šè¿›è¡Œäº‹åŠ¡æäº¤ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±ä¼šäº§ç”Ÿæ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜\")])]),e._v(\" \"),r(\"h3\",{attrs:{id:\"_3pc\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3pc\"}},[e._v(\"#\")]),e._v(\" 3PC\")]),e._v(\" \"),r(\"p\",[e._v(\"3PCï¼Œæ˜¯ Three-Phase-Comimit çš„ç¼©å†™ï¼Œå³ã€Œ\"),r(\"strong\",[e._v(\"ä¸‰é˜¶æ®µæäº¤\")]),e._v(\"ã€ï¼Œæ˜¯äºŒé˜¶æ®µçš„æ”¹è¿›ç‰ˆï¼Œå°†äºŒé˜¶æ®µæäº¤åè®®çš„â€œæäº¤äº‹åŠ¡è¯·æ±‚â€è¿‡ç¨‹ä¸€åˆ†ä¸ºäºŒã€‚\")]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"é˜¶æ®µä¸€ï¼šCanCommit\")])]),e._v(\" \"),r(\"p\",[e._v(\"åè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€ \"),r(\"code\",[e._v(\"CanCommit\")]),e._v(\" è¯·æ±‚ï¼Œå‚ä¸è€…æ”¶åˆ°è¯·æ±‚åä¼šæ ¹æ®è‡ªèº«æƒ…å†µæŸ¥çœ‹æ˜¯å¦èƒ½æ‰§è¡Œäº‹åŠ¡ï¼Œå¦‚æœå¯ä»¥åˆ™è¿”å› YES å“åº”å¹¶è¿›å…¥é¢„å¤‡çŠ¶æ€ï¼Œå¦åˆ™è¿”å› NO\")]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"é˜¶æ®µäºŒï¼šPreCommit\")])]),e._v(\" \"),r(\"p\",[e._v(\"åè°ƒè€…æ ¹æ®å‚ä¸è€…è¿”å›çš„å“åº”æ¥å†³å®šæ˜¯å¦å¯ä»¥è¿›è¡Œä¸‹é¢çš„ \"),r(\"code\",[e._v(\"PreCommit\")]),e._v(\" æ“ä½œã€‚å¦‚æœä¸Šé¢å‚ä¸è€…è¿”å›çš„éƒ½æ˜¯ YESï¼Œé‚£ä¹ˆåè°ƒè€…å°†å‘æ‰€æœ‰å‚ä¸è€…å‘é€ \"),r(\"code\",[e._v(\"PreCommit\")]),e._v(\" é¢„æäº¤è¯·æ±‚ï¼Œ\"),r(\"strong\",[e._v(\"å‚ä¸è€…æ”¶åˆ°é¢„æäº¤è¯·æ±‚åï¼Œä¼šè¿›è¡Œäº‹åŠ¡çš„æ‰§è¡Œæ“ä½œï¼Œå¹¶å°† Undo å’Œ Redo ä¿¡æ¯å†™å…¥äº‹åŠ¡æ—¥å¿—ä¸­\")]),e._v(\" ï¼Œæœ€åå¦‚æœå‚ä¸è€…é¡ºåˆ©æ‰§è¡Œäº†äº‹åŠ¡åˆ™ç»™åè°ƒè€…è¿”å›æˆåŠŸçš„ \"),r(\"code\",[e._v(\"Ack\")]),e._v(\" å“åº”ã€‚å¦‚æœåœ¨ç¬¬ä¸€é˜¶æ®µåè°ƒè€…æ”¶åˆ°äº† \"),r(\"strong\",[e._v(\"ä»»ä½•ä¸€ä¸ª NO\")]),e._v(\" çš„ä¿¡æ¯ï¼Œæˆ–è€… \"),r(\"strong\",[e._v(\"åœ¨ä¸€å®šæ—¶é—´å†…\")]),e._v(\" å¹¶æ²¡æœ‰æ”¶åˆ°å…¨éƒ¨çš„å‚ä¸è€…çš„å“åº”ï¼Œé‚£ä¹ˆå°±ä¼šä¸­æ–­äº‹åŠ¡ï¼Œå®ƒä¼šå‘æ‰€æœ‰å‚ä¸è€…å‘é€ä¸­æ–­è¯·æ±‚ \"),r(\"code\",[e._v(\"abort\")]),e._v(\"ï¼Œå‚ä¸è€…æ”¶åˆ°ä¸­æ–­è¯·æ±‚ä¹‹åä¼šç«‹å³ä¸­æ–­äº‹åŠ¡ï¼Œæˆ–è€…åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°åè°ƒè€…çš„è¯·æ±‚ï¼Œå®ƒä¹Ÿä¼šä¸­æ–­äº‹åŠ¡\")]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"é˜¶æ®µä¸‰ï¼šDoCommit\")])]),e._v(\" \"),r(\"p\",[e._v(\"è¿™ä¸ªé˜¶æ®µå…¶å®å’Œ \"),r(\"code\",[e._v(\"2PC\")]),e._v(\" çš„ç¬¬äºŒé˜¶æ®µå·®ä¸å¤šï¼Œå¦‚æœåè°ƒè€…æ”¶åˆ°äº†æ‰€æœ‰å‚ä¸è€…åœ¨ \"),r(\"code\",[e._v(\"PreCommit\")]),e._v(\" é˜¶æ®µçš„ YES å“åº”ï¼Œé‚£ä¹ˆåè°ƒè€…å°†ä¼šç»™æ‰€æœ‰å‚ä¸è€…å‘é€ \"),r(\"code\",[e._v(\"DoCommit\")]),e._v(\" è¯·æ±‚ï¼Œ\"),r(\"strong\",[e._v(\"å‚ä¸è€…æ”¶åˆ° DoCommit è¯·æ±‚ååˆ™ä¼šè¿›è¡Œäº‹åŠ¡çš„æäº¤å·¥ä½œ\")]),e._v(\"ï¼Œå®Œæˆååˆ™ä¼šç»™åè°ƒè€…è¿”å›å“åº”ï¼Œåè°ƒè€…æ”¶åˆ°æ‰€æœ‰å‚ä¸è€…è¿”å›çš„äº‹åŠ¡æäº¤æˆåŠŸçš„å“åº”ä¹‹ååˆ™å®Œæˆäº‹åŠ¡ã€‚è‹¥åè°ƒè€…åœ¨ \"),r(\"code\",[e._v(\"PreCommit\")]),e._v(\" é˜¶æ®µ \"),r(\"strong\",[e._v(\"æ”¶åˆ°äº†ä»»ä½•ä¸€ä¸ª NO æˆ–è€…åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°æ‰€æœ‰å‚ä¸è€…çš„å“åº”\")]),e._v(\" ï¼Œé‚£ä¹ˆå°±ä¼šè¿›è¡Œä¸­æ–­è¯·æ±‚çš„å‘é€ï¼Œå‚ä¸è€…æ”¶åˆ°ä¸­æ–­è¯·æ±‚ååˆ™ä¼š \"),r(\"strong\",[e._v(\"é€šè¿‡ä¸Šé¢è®°å½•çš„å›æ»šæ—¥å¿—\")]),e._v(\" æ¥è¿›è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œï¼Œå¹¶å‘åè°ƒè€…åé¦ˆå›æ»šçŠ¶å†µï¼Œåè°ƒè€…æ”¶åˆ°å‚ä¸è€…è¿”å›çš„æ¶ˆæ¯åï¼Œä¸­æ–­äº‹åŠ¡ã€‚\")]),e._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:\"https://tva1.sinaimg.cn/large/00831rSTly1gclot2rul3j30j60cpgmo.jpg\",alt:\"\"}})]),e._v(\" \"),r(\"p\",[e._v(\"é™ä½äº†å‚ä¸è€…çš„é˜»å¡èŒƒå›´ï¼Œä¸”èƒ½åœ¨å•ç‚¹æ•…éšœåç»§ç»­è¾¾æˆä¸€è‡´ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"ä½†æ˜¯æœ€é‡è¦çš„ä¸€è‡´æ€§å¹¶æ²¡æœ‰å¾—åˆ°æ ¹æœ¬çš„è§£å†³ï¼Œæ¯”å¦‚åœ¨ \"),r(\"code\",[e._v(\"PreCommit\")]),e._v(\" é˜¶æ®µï¼Œå½“ä¸€ä¸ªå‚ä¸è€…æ”¶åˆ°äº†è¯·æ±‚ä¹‹åå…¶ä»–å‚ä¸è€…å’Œåè°ƒè€…æŒ‚äº†æˆ–è€…å‡ºç°äº†ç½‘ç»œåˆ†åŒºï¼Œè¿™ä¸ªæ—¶å€™æ”¶åˆ°æ¶ˆæ¯çš„å‚ä¸è€…éƒ½ä¼šè¿›è¡Œäº‹åŠ¡æäº¤ï¼Œè¿™å°±ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚\")]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"è®²ä¸€è®²-paxos-ç®—æ³•\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#è®²ä¸€è®²-paxos-ç®—æ³•\"}},[e._v(\"#\")]),e._v(\" è®²ä¸€è®² Paxos ç®—æ³•ï¼Ÿ\")]),e._v(\" \"),r(\"p\",[r(\"code\",[e._v(\"Paxos\")]),e._v(\" ç®—æ³•æ˜¯åŸºäº\"),r(\"strong\",[e._v(\"æ¶ˆæ¯ä¼ é€’ä¸”å…·æœ‰é«˜åº¦å®¹é”™ç‰¹æ€§çš„ä¸€è‡´æ€§ç®—æ³•\")]),e._v(\"ï¼Œæ˜¯ç›®å‰å…¬è®¤çš„è§£å†³åˆ†å¸ƒå¼ä¸€è‡´æ€§é—®é¢˜æœ€æœ‰æ•ˆçš„ç®—æ³•ä¹‹ä¸€ï¼Œ\"),r(\"strong\",[e._v(\"å…¶è§£å†³çš„é—®é¢˜å°±æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¦‚ä½•å°±æŸä¸ªå€¼ï¼ˆå†³è®®ï¼‰è¾¾æˆä¸€è‡´\")]),e._v(\" ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"åœ¨ \"),r(\"code\",[e._v(\"Paxos\")]),e._v(\" ä¸­ä¸»è¦æœ‰ä¸‰ä¸ªè§’è‰²ï¼Œåˆ†åˆ«ä¸º \"),r(\"code\",[e._v(\"Proposerææ¡ˆè€…\")]),e._v(\"ã€\"),r(\"code\",[e._v(\"Acceptorè¡¨å†³è€…\")]),e._v(\"ã€\"),r(\"code\",[e._v(\"Learnerå­¦ä¹ è€…\")]),e._v(\"ã€‚\"),r(\"code\",[e._v(\"Paxos\")]),e._v(\" ç®—æ³•å’Œ \"),r(\"code\",[e._v(\"2PC\")]),e._v(\" ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸¤ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«ä¸º \"),r(\"code\",[e._v(\"Prepare\")]),e._v(\" å’Œ \"),r(\"code\",[e._v(\"accept\")]),e._v(\" é˜¶æ®µã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"åœ¨å…·ä½“çš„å®ç°ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹å¯èƒ½åŒæ—¶å……å½“å¤šç§è§’è‰²ã€‚æ¯”å¦‚ä¸€ä¸ªè¿›ç¨‹å¯èƒ½æ—¢æ˜¯ Proposer åˆæ˜¯ Acceptor åˆæ˜¯Learnerã€‚Proposer è´Ÿè´£æå‡ºææ¡ˆï¼ŒAcceptor è´Ÿè´£å¯¹ææ¡ˆä½œå‡ºè£å†³ï¼ˆacceptä¸å¦ï¼‰ï¼Œlearner è´Ÿè´£å­¦ä¹ ææ¡ˆç»“æœã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µå«ã€Œ\"),r(\"strong\",[e._v(\"ææ¡ˆ\")]),e._v(\"ã€ï¼ˆProposalï¼‰ã€‚æœ€ç»ˆè¦è¾¾æˆä¸€è‡´çš„ value å°±åœ¨ææ¡ˆé‡Œã€‚åªè¦ Proposer å‘çš„ææ¡ˆè¢«åŠæ•°ä»¥ä¸Šçš„ Acceptor æ¥å—ï¼ŒProposer å°±è®¤ä¸ºè¯¥ææ¡ˆé‡Œçš„ value è¢«é€‰å®šäº†ã€‚Acceptor å‘Šè¯‰ Learner å“ªä¸ª value è¢«é€‰å®šï¼ŒLearner å°±è®¤ä¸ºé‚£ä¸ª value è¢«é€‰å®šã€‚\")]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"é˜¶æ®µä¸€ï¼šprepare é˜¶æ®µ\")])]),e._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[r(\"code\",[e._v(\"Proposer\")]),e._v(\" è´Ÿè´£æå‡º \"),r(\"code\",[e._v(\"proposal\")]),e._v(\"ï¼Œæ¯ä¸ªææ¡ˆè€…åœ¨æå‡ºææ¡ˆæ—¶éƒ½ä¼šé¦–å…ˆè·å–åˆ°ä¸€ä¸ª \"),r(\"strong\",[e._v(\"å…·æœ‰å…¨å±€å”¯ä¸€æ€§çš„ã€é€’å¢çš„ææ¡ˆç¼–å·N\")]),e._v(\"ï¼Œå³åœ¨æ•´ä¸ªé›†ç¾¤ä¸­æ˜¯å”¯ä¸€çš„ç¼–å· Nï¼Œç„¶åå°†è¯¥ç¼–å·èµ‹äºˆå…¶è¦æå‡ºçš„ææ¡ˆï¼Œåœ¨\"),r(\"strong\",[e._v(\"ç¬¬ä¸€é˜¶æ®µæ˜¯åªå°†ææ¡ˆç¼–å·å‘é€ç»™æ‰€æœ‰çš„è¡¨å†³è€…\")]),e._v(\"ã€‚\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"å¦‚æœä¸€ä¸ª Acceptor æ”¶åˆ°ä¸€ä¸ªç¼–å·ä¸º N çš„ Prepare è¯·æ±‚ï¼Œå¦‚æœå°äºå®ƒå·²ç»å“åº”è¿‡çš„è¯·æ±‚ï¼Œåˆ™æ‹’ç»ï¼Œä¸å›åº”æˆ–å›å¤errorã€‚è‹¥ N å¤§äºè¯¥ Acceptor å·²ç»å“åº”è¿‡çš„æ‰€æœ‰ Prepare è¯·æ±‚çš„ç¼–å·ï¼ˆmaxNï¼‰ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå°†å®ƒ\"),r(\"strong\",[e._v(\"å·²ç»æ‰¹å‡†è¿‡çš„ç¼–å·æœ€å¤§çš„ææ¡ˆ\")]),e._v(\"ï¼ˆå¦‚æœæœ‰çš„è¯ï¼Œå¦‚æœè¿˜æ²¡æœ‰çš„acceptææ¡ˆçš„è¯è¿”å›{pokï¼Œnullï¼Œnull}ï¼‰ä½œä¸ºå“åº”åé¦ˆç»™ Proposerï¼ŒåŒæ—¶è¯¥ Acceptor æ‰¿è¯ºä¸å†æ¥å—ä»»ä½•ç¼–å·å°äº N çš„ææ¡ˆ\")]),e._v(\" \"),r(\"p\",[e._v(\"egï¼šå‡å®šä¸€ä¸ª Acceptor å·²ç»å“åº”è¿‡çš„æ‰€æœ‰ Prepare è¯·æ±‚å¯¹åº”çš„ææ¡ˆç¼–å·åˆ†åˆ«æ˜¯1ã€2ã€...5å’Œ7ï¼Œé‚£ä¹ˆè¯¥ Acceptor åœ¨æ¥æ”¶åˆ°ä¸€ä¸ªç¼–å·ä¸º8çš„ Prepare è¯·æ±‚åï¼Œå°±ä¼šå°† 7 çš„ææ¡ˆä½œä¸ºå“åº”åé¦ˆç»™ Proposerã€‚\")])])]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"é˜¶æ®µäºŒï¼šaccept é˜¶æ®µ\")])]),e._v(\" \"),r(\"ol\",[r(\"li\",[e._v(\"å¦‚æœä¸€ä¸ª Proposer æ”¶åˆ°åŠæ•°ä»¥ä¸Š Acceptor å¯¹å…¶å‘å‡ºçš„ç¼–å·ä¸º N çš„ Prepare è¯·æ±‚çš„å“åº”ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå‘é€ä¸€ä¸ªé’ˆå¯¹ [N,V] ææ¡ˆçš„ Accept è¯·æ±‚åŠæ•°ä»¥ä¸Šçš„ Acceptorã€‚æ³¨æ„ï¼šV å°±æ˜¯æ”¶åˆ°çš„å“åº”ä¸­ç¼–å·æœ€å¤§çš„ææ¡ˆçš„ valueï¼Œå¦‚æœå“åº”ä¸­ä¸åŒ…å«ä»»ä½•ææ¡ˆï¼Œé‚£ä¹ˆ V å°±ç”± Proposer è‡ªå·±å†³å®š\")]),e._v(\" \"),r(\"li\",[e._v(\"å¦‚æœ Acceptor æ”¶åˆ°ä¸€ä¸ªé’ˆå¯¹ç¼–å·ä¸ºNçš„ææ¡ˆçš„Acceptè¯·æ±‚ï¼Œåªè¦è¯¥ Acceptor æ²¡æœ‰å¯¹ç¼–å·å¤§äº N çš„ Prepare è¯·æ±‚åšå‡ºè¿‡å“åº”ï¼Œå®ƒå°±é€šè¿‡è¯¥ææ¡ˆã€‚å¦‚æœNå°äº Acceptor ä»¥åŠå“åº”çš„ prepare è¯·æ±‚ï¼Œåˆ™æ‹’ç»ï¼Œä¸å›åº”æˆ–å›å¤errorï¼ˆå½“proposeræ²¡æœ‰æ”¶åˆ°è¿‡åŠçš„å›åº”ï¼Œé‚£ä¹ˆä»–ä¼šé‡æ–°è¿›å…¥ç¬¬ä¸€é˜¶æ®µï¼Œé€’å¢ææ¡ˆå·ï¼Œé‡æ–°æå‡ºprepareè¯·æ±‚ï¼‰\")]),e._v(\" \"),r(\"li\",[e._v(\"æœ€åæ˜¯ Learner è·å–é€šè¿‡çš„ææ¡ˆï¼ˆæœ‰å¤šç§æ–¹å¼ï¼‰\")])]),e._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:\"https://tva1.sinaimg.cn/large/00831rSTly1gcloyv70qsj30sg0lc0ve.jpg\",alt:\"\"}})]),e._v(\" \"),r(\"p\",[r(\"strong\",[r(\"code\",[e._v(\"paxos\")]),e._v(\" ç®—æ³•çš„æ­»å¾ªç¯é—®é¢˜\")])]),e._v(\" \"),r(\"p\",[e._v(\"å…¶å®å°±æœ‰ç‚¹ç±»ä¼¼äºä¸¤ä¸ªäººåµæ¶ï¼Œå°æ˜è¯´æˆ‘æ˜¯å¯¹çš„ï¼Œå°çº¢è¯´æˆ‘æ‰æ˜¯å¯¹çš„ï¼Œä¸¤ä¸ªäººæ®ç†åŠ›äº‰çš„è°ä¹Ÿä¸è®©è°ğŸ¤¬ğŸ¤¬ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"æ¯”å¦‚è¯´ï¼Œæ­¤æ—¶ææ¡ˆè€… P1 æå‡ºä¸€ä¸ªæ–¹æ¡ˆ M1ï¼Œå®Œæˆäº† \"),r(\"code\",[e._v(\"Prepare\")]),e._v(\" é˜¶æ®µçš„å·¥ä½œï¼Œè¿™ä¸ªæ—¶å€™ \"),r(\"code\",[e._v(\"acceptor\")]),e._v(\" åˆ™æ‰¹å‡†äº† M1ï¼Œä½†æ˜¯æ­¤æ—¶ææ¡ˆè€… P2 åŒæ—¶ä¹Ÿæå‡ºäº†ä¸€ä¸ªæ–¹æ¡ˆ M2ï¼Œå®ƒä¹Ÿå®Œæˆäº† \"),r(\"code\",[e._v(\"Prepare\")]),e._v(\" é˜¶æ®µçš„å·¥ä½œã€‚ç„¶å P1 çš„æ–¹æ¡ˆå·²ç»ä¸èƒ½åœ¨ç¬¬äºŒé˜¶æ®µè¢«æ‰¹å‡†äº†ï¼ˆå› ä¸º \"),r(\"code\",[e._v(\"acceptor\")]),e._v(\" å·²ç»æ‰¹å‡†äº†æ¯” M1 æ›´å¤§çš„ M2ï¼‰ï¼Œæ‰€ä»¥ P1 è‡ªå¢æ–¹æ¡ˆå˜ä¸º M3 é‡æ–°è¿›å…¥ \"),r(\"code\",[e._v(\"Prepare\")]),e._v(\" é˜¶æ®µï¼Œç„¶å \"),r(\"code\",[e._v(\"acceptor\")]),e._v(\" ï¼Œåˆæ‰¹å‡†äº†æ–°çš„ M3 æ–¹æ¡ˆï¼Œå®ƒåˆä¸èƒ½æ‰¹å‡† M2 äº†ï¼Œè¿™ä¸ªæ—¶å€™ M2 åˆè‡ªå¢è¿›å…¥ \"),r(\"code\",[e._v(\"Prepare\")]),e._v(\" é˜¶æ®µã€‚ã€‚ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"å°±è¿™æ ·æ— ä¼‘æ— æ­¢çš„æ°¸è¿œææ¡ˆä¸‹å»ï¼Œè¿™å°±æ˜¯ \"),r(\"code\",[e._v(\"paxos\")]),e._v(\" ç®—æ³•çš„æ­»å¾ªç¯é—®é¢˜ã€‚\")]),e._v(\" \"),r(\"h2\",{attrs:{id:\"è°ˆä¸‹ä½ å¯¹-zab-åè®®çš„äº†è§£\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#è°ˆä¸‹ä½ å¯¹-zab-åè®®çš„äº†è§£\"}},[e._v(\"#\")]),e._v(\" è°ˆä¸‹ä½ å¯¹ ZAB åè®®çš„äº†è§£ï¼Ÿ\")]),e._v(\" \"),r(\"p\",[e._v(\"ZABï¼ˆZookeeper Atomic Broadcastï¼‰ åè®®æ˜¯ä¸ºåˆ†å¸ƒå¼åè°ƒæœåŠ¡ Zookeeper ä¸“é—¨è®¾è®¡çš„ä¸€ç§æ”¯æŒ\"),r(\"strong\",[e._v(\"å´©æºƒæ¢å¤çš„åŸå­å¹¿æ’­åè®®\")]),e._v(\"ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"åœ¨ Zookeeper ä¸­ï¼Œä¸»è¦ä¾èµ– ZAB åè®®æ¥å®ç°åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§ï¼ŒåŸºäºè¯¥åè®®ï¼ŒZooKeeper å®ç°äº†ä¸€ç§ä¸»å¤‡æ¨¡å¼çš„ç³»ç»Ÿæ¶æ„æ¥ä¿æŒé›†ç¾¤ä¸­å„å‰¯æœ¬ä¹‹é—´æ•°æ®çš„ä¸€è‡´æ€§ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"å°½ç®¡ ZAB ä¸æ˜¯ Paxos çš„å®ç°ï¼Œä½†æ˜¯ ZAB ä¹Ÿå‚è€ƒäº†ä¸€äº› Paxos çš„ä¸€äº›è®¾è®¡æ€æƒ³ï¼Œæ¯”å¦‚ï¼š\")]),e._v(\" \"),r(\"ul\",[r(\"li\",[e._v(\"leader å‘ follows æå‡ºææ¡ˆ(proposal)\")]),e._v(\" \"),r(\"li\",[e._v(\"leader éœ€è¦åœ¨è¾¾åˆ°æ³•å®šæ•°é‡(åŠæ•°ä»¥ä¸Š)çš„ follows ç¡®è®¤ä¹‹åæ‰ä¼šè¿›è¡Œ commit\")]),e._v(\" \"),r(\"li\",[e._v(\"æ¯ä¸€ä¸ª proposal éƒ½æœ‰ä¸€ä¸ªçºªå…ƒ(epoch)å·ï¼Œç±»ä¼¼äº Paxos ä¸­çš„é€‰ç¥¨(ballot)\")])]),e._v(\" \"),r(\"p\",[r(\"code\",[e._v(\"ZAB\")]),e._v(\" ä¸­æœ‰ä¸‰ä¸ªä¸»è¦çš„è§’è‰²ï¼Œ\"),r(\"code\",[e._v(\"Leader é¢†å¯¼è€…\")]),e._v(\"ã€\"),r(\"code\",[e._v(\"Followerè·Ÿéšè€…\")]),e._v(\"ã€\"),r(\"code\",[e._v(\"Observerè§‚å¯Ÿè€…\")]),e._v(\" ã€‚\")]),e._v(\" \"),r(\"ul\",[r(\"li\",[r(\"code\",[e._v(\"Leader\")]),e._v(\" ï¼šé›†ç¾¤ä¸­ \"),r(\"strong\",[e._v(\"å”¯ä¸€çš„å†™è¯·æ±‚å¤„ç†è€…\")]),e._v(\" ï¼Œèƒ½å¤Ÿå‘èµ·æŠ•ç¥¨ï¼ˆæŠ•ç¥¨ä¹Ÿæ˜¯ä¸ºäº†è¿›è¡Œå†™è¯·æ±‚ï¼‰ã€‚\")]),e._v(\" \"),r(\"li\",[r(\"code\",[e._v(\"Follower\")]),e._v(\"ï¼šèƒ½å¤Ÿæ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¦‚æœæ˜¯è¯»è¯·æ±‚åˆ™å¯ä»¥è‡ªå·±å¤„ç†ï¼Œ\"),r(\"strong\",[e._v(\"å¦‚æœæ˜¯å†™è¯·æ±‚åˆ™è¦è½¬å‘ç»™ Leader ã€‚åœ¨é€‰ä¸¾è¿‡ç¨‹ä¸­ä¼šå‚ä¸æŠ•ç¥¨ï¼Œæœ‰é€‰ä¸¾æƒå’Œè¢«é€‰ä¸¾æƒ ã€‚\")])]),e._v(\" \"),r(\"li\",[r(\"strong\",[e._v(\"Observer ï¼šå°±æ˜¯æ²¡æœ‰é€‰ä¸¾æƒå’Œè¢«é€‰ä¸¾æƒçš„ Follower ã€‚\")])])]),e._v(\" \"),r(\"p\",[e._v(\"åœ¨ ZAB åè®®ä¸­å¯¹ zkServer(å³ä¸Šé¢æˆ‘ä»¬è¯´çš„ä¸‰ä¸ªè§’è‰²çš„æ€»ç§°) è¿˜æœ‰ä¸¤ç§æ¨¡å¼çš„å®šä¹‰ï¼Œåˆ†åˆ«æ˜¯æ¶ˆæ¯å¹¿æ’­å’Œå´©æºƒæ¢å¤\")]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"æ¶ˆæ¯å¹¿æ’­æ¨¡å¼\")])]),e._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:\"http://file.sunwaiting.com/zab_broadcast.png\",alt:\"ZABå¹¿æ’­\"}})]),e._v(\" \"),r(\"ol\",[r(\"li\",[e._v(\"Leaderä»å®¢æˆ·ç«¯æ”¶åˆ°ä¸€ä¸ªäº‹åŠ¡è¯·æ±‚ï¼ˆå¦‚æœæ˜¯é›†ç¾¤ä¸­å…¶ä»–æœºå™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„äº‹åŠ¡è¯·æ±‚ï¼Œä¼šç›´æ¥è½¬å‘ç»™ Leader æœåŠ¡å™¨ï¼‰\")]),e._v(\" \"),r(\"li\",[e._v(\"Leader æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„äº‹åŠ¡ Proposalï¼Œå¹¶ä¸ºè¿™ä¸ªäº‹åŠ¡ç”Ÿæˆä¸€ä¸ªå…¨å±€é€’å¢çš„å”¯ä¸€çš„ZXIDï¼ˆé€šè¿‡å…¶ ZXID æ¥è¿›è¡Œæ’åºä¿è¯é¡ºåºæ€§ï¼‰\")]),e._v(\" \"),r(\"li\",[e._v(\"Leader å°†è¿™ä¸ªäº‹åŠ¡å‘é€ç»™æ‰€æœ‰çš„ Follows èŠ‚ç‚¹\")]),e._v(\" \"),r(\"li\",[e._v(\"Follower èŠ‚ç‚¹å°†æ”¶åˆ°çš„äº‹åŠ¡è¯·æ±‚åŠ å…¥åˆ°å†å²é˜Ÿåˆ—(Leader ä¼šä¸ºæ¯ä¸ª Follower åˆ†é…ä¸€ä¸ªå•ç‹¬çš„é˜Ÿåˆ—å…ˆè¿›å…ˆå‡ºï¼Œé¡ºåºä¿è¯æ¶ˆæ¯çš„å› æœå…³ç³»)ä¸­ï¼Œå¹¶å‘é€ ack ç»™ Leader\")]),e._v(\" \"),r(\"li\",[e._v(\"å½“ Leader æ”¶åˆ°è¶…è¿‡åŠæ•° Follower çš„ ack æ¶ˆæ¯ï¼ŒLeaderä¼šå¹¿æ’­ä¸€ä¸ª commit æ¶ˆæ¯\")]),e._v(\" \"),r(\"li\",[e._v(\"å½“ Follower æ”¶åˆ° commit è¯·æ±‚æ—¶ï¼Œä¼šåˆ¤æ–­è¯¥äº‹åŠ¡çš„ ZXID æ˜¯ä¸æ˜¯æ¯”å†å²é˜Ÿåˆ—ä¸­çš„ä»»ä½•äº‹åŠ¡çš„ ZXID éƒ½å°ï¼Œå¦‚æœæ˜¯åˆ™æäº¤ï¼Œå¦‚æœä¸æ˜¯åˆ™ç­‰å¾…æ¯”å®ƒæ›´å°çš„äº‹åŠ¡çš„ commit\")])]),e._v(\" \"),r(\"p\",[r(\"img\",{attrs:{src:\"http://file.sunwaiting.com/zab_commit_1.png\",alt:\"zab \\bcommitæµç¨‹\"}})]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"å´©æºƒæ¢å¤æ¨¡å¼\")])]),e._v(\" \"),r(\"p\",[e._v(\"ZAB çš„åŸå­å¹¿æ’­åè®®åœ¨æ­£å¸¸æƒ…å†µä¸‹è¿è¡Œè‰¯å¥½ï¼Œä½†å¤©æœ‰ä¸æµ‹é£äº‘ï¼Œä¸€æ—¦ Leader æœåŠ¡å™¨æŒ‚æ‰æˆ–è€…ç”±äºç½‘ç»œåŸå› å¯¼è‡´ä¸åŠæ•°çš„ Follower çš„æœåŠ¡å™¨å¤±å»è”ç³»ï¼Œé‚£ä¹ˆå°±ä¼šè¿›å…¥å´©æºƒæ¢å¤æ¨¡å¼ã€‚æ•´ä¸ªæ¢å¤è¿‡ç¨‹ç»“æŸåéœ€è¦é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„ Leader æœåŠ¡å™¨ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"æ¢å¤æ¨¡å¼å¤§è‡´å¯ä»¥åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š\"),r(\"strong\",[e._v(\"é€‰ä¸¾ã€å‘ç°ã€åŒæ­¥ã€å¹¿æ’­\")])]),e._v(\" \"),r(\"ol\",[r(\"li\",[e._v(\"å½“ leader å´©æºƒåï¼Œé›†ç¾¤è¿›å…¥é€‰ä¸¾é˜¶æ®µï¼Œå¼€å§‹é€‰ä¸¾å‡ºæ½œåœ¨çš„æ–° leader(ä¸€èˆ¬ä¸ºé›†ç¾¤ä¸­æ‹¥æœ‰æœ€å¤§ ZXID çš„èŠ‚ç‚¹)\")]),e._v(\" \"),r(\"li\",[e._v(\"è¿›å…¥å‘ç°é˜¶æ®µï¼Œfollower ä¸æ½œåœ¨çš„æ–° leader è¿›è¡Œæ²Ÿé€šï¼Œå¦‚æœå‘ç°è¶…è¿‡æ³•å®šäººæ•°çš„ follower åŒæ„ï¼Œåˆ™æ½œåœ¨çš„æ–°leader å°† epoc håŠ 1ï¼Œè¿›å…¥æ–°çš„çºªå…ƒã€‚æ–°çš„ leader äº§ç”Ÿ\")]),e._v(\" \"),r(\"li\",[e._v(\"é›†ç¾¤é—´è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¿è¯é›†ç¾¤ä¸­å„ä¸ªèŠ‚ç‚¹çš„äº‹åŠ¡ä¸€è‡´\")]),e._v(\" \"),r(\"li\",[e._v(\"é›†ç¾¤æ¢å¤åˆ°å¹¿æ’­æ¨¡å¼ï¼Œå¼€å§‹æ¥å—å®¢æˆ·ç«¯çš„å†™è¯·æ±‚\")])]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"zookeeper-æ€ä¹ˆä¿è¯ä¸»ä»èŠ‚ç‚¹çš„çŠ¶æ€åŒæ­¥-æˆ–è€…è¯´åŒæ­¥æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#zookeeper-æ€ä¹ˆä¿è¯ä¸»ä»èŠ‚ç‚¹çš„çŠ¶æ€åŒæ­¥-æˆ–è€…è¯´åŒæ­¥æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„\"}},[e._v(\"#\")]),e._v(\" Zookeeper æ€ä¹ˆä¿è¯ä¸»ä»èŠ‚ç‚¹çš„çŠ¶æ€åŒæ­¥ï¼Ÿæˆ–è€…è¯´åŒæ­¥æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„\")]),e._v(\" \"),r(\"p\",[e._v(\"Zookeeper çš„æ ¸å¿ƒæ˜¯åŸå­å¹¿æ’­æœºåˆ¶ï¼Œè¿™ä¸ªæœºåˆ¶ä¿è¯äº†å„ä¸ª server ä¹‹é—´çš„åŒæ­¥ã€‚å®ç°è¿™ä¸ªæœºåˆ¶çš„åè®®å«åš Zab åè®®ã€‚Zab åè®®æœ‰ä¸¤ç§æ¨¡å¼ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ¢å¤æ¨¡å¼å’Œå¹¿æ’­æ¨¡å¼ã€‚åŒä¸Š\")]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"é›†ç¾¤ä¸­ä¸ºä»€ä¹ˆè¦æœ‰ä¸»èŠ‚ç‚¹\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#é›†ç¾¤ä¸­ä¸ºä»€ä¹ˆè¦æœ‰ä¸»èŠ‚ç‚¹\"}},[e._v(\"#\")]),e._v(\" é›†ç¾¤ä¸­ä¸ºä»€ä¹ˆè¦æœ‰ä¸»èŠ‚ç‚¹ï¼Ÿ\")]),e._v(\" \"),r(\"p\",[e._v(\"åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œæœ‰äº›ä¸šåŠ¡é€»è¾‘åªéœ€è¦é›†ç¾¤ä¸­çš„æŸä¸€å°æœºå™¨è¿›è¡Œæ‰§è¡Œï¼Œå…¶ä»–çš„æœºå™¨å¯ä»¥å…±äº«è¿™ä¸ªç»“æœï¼Œè¿™æ ·å¯ä»¥å¤§å¤§å‡å°‘é‡å¤è®¡ç®—ï¼Œæé«˜æ€§èƒ½ï¼Œäºæ˜¯å°±éœ€è¦è¿›è¡Œ leader é€‰ä¸¾ã€‚\")]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"é›†ç¾¤ä¸­æœ‰-3-å°æœåŠ¡å™¨-å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹å®•æœº-è¿™ä¸ªæ—¶å€™-zookeeper-è¿˜å¯ä»¥ä½¿ç”¨å—\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#é›†ç¾¤ä¸­æœ‰-3-å°æœåŠ¡å™¨-å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹å®•æœº-è¿™ä¸ªæ—¶å€™-zookeeper-è¿˜å¯ä»¥ä½¿ç”¨å—\"}},[e._v(\"#\")]),e._v(\" é›†ç¾¤ä¸­æœ‰ 3 å°æœåŠ¡å™¨ï¼Œå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œè¿™ä¸ªæ—¶å€™ Zookeeper è¿˜å¯ä»¥ä½¿ç”¨å—ï¼Ÿ\")]),e._v(\" \"),r(\"p\",[e._v(\"å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œå•æ•°æœåŠ¡å™¨åªè¦æ²¡è¶…è¿‡ä¸€åŠçš„æœåŠ¡å™¨å®•æœºå°±å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"é›†ç¾¤è§„åˆ™ä¸º 2N+1 å°ï¼ŒN >0ï¼Œå³æœ€å°‘éœ€è¦ 3 å°ã€‚\")]),e._v(\" \"),r(\"h2\",{attrs:{id:\"zookeeper-å®•æœºå¦‚ä½•å¤„ç†\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#zookeeper-å®•æœºå¦‚ä½•å¤„ç†\"}},[e._v(\"#\")]),e._v(\" Zookeeper å®•æœºå¦‚ä½•å¤„ç†ï¼Ÿ\")]),e._v(\" \"),r(\"p\",[e._v(\"Zookeeper æœ¬èº«ä¹Ÿæ˜¯é›†ç¾¤ï¼Œæ¨èé…ç½®ä¸å°‘äº 3 ä¸ªæœåŠ¡å™¨ã€‚Zookeeper è‡ªèº«ä¹Ÿè¦ä¿è¯å½“ä¸€ä¸ªèŠ‚ç‚¹å®•æœºæ—¶ï¼Œå…¶ä»–èŠ‚ç‚¹ä¼šç»§ç»­æä¾›æœåŠ¡ã€‚å¦‚æœæ˜¯ä¸€ä¸ª Follower å®•æœºï¼Œè¿˜æœ‰ 2 å°æœåŠ¡å™¨æä¾›è®¿é—®ï¼Œå› ä¸º Zookeeper ä¸Šçš„æ•°æ®æ˜¯æœ‰å¤šä¸ªå‰¯æœ¬çš„ï¼Œæ•°æ®å¹¶ä¸ä¼šä¸¢å¤±ï¼›å¦‚æœæ˜¯ä¸€ä¸ª Leader å®•æœºï¼ŒZookeeper ä¼šé€‰ä¸¾å‡ºæ–°çš„ Leaderã€‚\")]),e._v(\" \"),r(\"p\",[e._v(\"Zookeeper é›†ç¾¤çš„æœºåˆ¶æ˜¯åªè¦è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æ­£å¸¸ï¼Œé›†ç¾¤å°±èƒ½æ­£å¸¸æä¾›æœåŠ¡ã€‚åªæœ‰åœ¨ Zookeeper èŠ‚ç‚¹æŒ‚å¾—å¤ªå¤šï¼Œåªå‰©ä¸€åŠæˆ–ä¸åˆ°ä¸€åŠèŠ‚ç‚¹èƒ½å·¥ä½œï¼Œé›†ç¾¤æ‰å¤±æ•ˆã€‚æ‰€ä»¥ï¼š\")]),e._v(\" \"),r(\"p\",[e._v(\"3 ä¸ªèŠ‚ç‚¹çš„ cluster å¯ä»¥æŒ‚æ‰ 1 ä¸ªèŠ‚ç‚¹(leader å¯ä»¥å¾—åˆ° 2 ç¥¨ > 1.5)\")]),e._v(\" \"),r(\"p\",[e._v(\"2 ä¸ªèŠ‚ç‚¹çš„ cluster å°±ä¸èƒ½æŒ‚æ‰ä»»ä½•1ä¸ªèŠ‚ç‚¹äº†(leader å¯ä»¥å¾—åˆ° 1 ç¥¨ <= 1)\")]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"è¯´ä¸‹å››ç§ç±»å‹çš„æ•°æ®èŠ‚ç‚¹-znode\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#è¯´ä¸‹å››ç§ç±»å‹çš„æ•°æ®èŠ‚ç‚¹-znode\"}},[e._v(\"#\")]),e._v(\" è¯´ä¸‹å››ç§ç±»å‹çš„æ•°æ®èŠ‚ç‚¹ Znodeï¼Ÿ\")]),e._v(\" \"),r(\"ol\",[r(\"li\",[r(\"p\",[e._v(\"PERSISTENTï¼šæŒä¹…èŠ‚ç‚¹ï¼Œé™¤éæ‰‹åŠ¨åˆ é™¤ï¼Œå¦åˆ™èŠ‚ç‚¹ä¸€ç›´å­˜åœ¨äº Zookeeper ä¸Šã€‚\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"EPHEMERALï¼šä¸´æ—¶èŠ‚ç‚¹ï¼Œä¸´æ—¶èŠ‚ç‚¹çš„ç”Ÿå‘½å‘¨æœŸä¸å®¢æˆ·ç«¯ä¼šè¯ç»‘å®šï¼Œä¸€æ—¦å®¢æˆ·ç«¯ä¼šè¯å¤±æ•ˆï¼ˆå®¢æˆ·ç«¯ä¸ Zookeeperè¿æ¥æ–­å¼€ä¸ä¸€å®šä¼šè¯å¤±æ•ˆï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¢æˆ·ç«¯åˆ›å»ºçš„æ‰€æœ‰ä¸´æ—¶èŠ‚ç‚¹éƒ½ä¼šè¢«ç§»é™¤ã€‚\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"PERSISTENT_SEQUENTIALï¼šæŒä¹…é¡ºåºèŠ‚ç‚¹ï¼ŒåŸºæœ¬ç‰¹æ€§åŒæŒä¹…èŠ‚ç‚¹ï¼Œåªæ˜¯å¢åŠ äº†é¡ºåºå±æ€§ï¼ŒèŠ‚ç‚¹ååè¾¹ä¼šè¿½åŠ ä¸€ä¸ªç”±çˆ¶èŠ‚ç‚¹ç»´æŠ¤çš„è‡ªå¢æ•´å‹æ•°å­—ã€‚\")])]),e._v(\" \"),r(\"li\",[r(\"p\",[e._v(\"EPHEMERAL_SEQUENTIALï¼šä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼ŒåŸºæœ¬ç‰¹æ€§åŒä¸´æ—¶èŠ‚ç‚¹ï¼Œå¢åŠ äº†é¡ºåºå±æ€§ï¼ŒèŠ‚ç‚¹ååè¾¹ä¼šè¿½åŠ ä¸€ä¸ªç”±çˆ¶èŠ‚ç‚¹ç»´æŠ¤çš„è‡ªå¢æ•´å‹æ•°å­—ã€‚\")])])]),e._v(\" \"),r(\"hr\"),e._v(\" \"),r(\"h2\",{attrs:{id:\"zookeeperé€‰ä¸¾æœºåˆ¶\"}},[r(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#zookeeperé€‰ä¸¾æœºåˆ¶\"}},[e._v(\"#\")]),e._v(\" Zookeeperé€‰ä¸¾æœºåˆ¶\")]),e._v(\" \"),r(\"ol\",[r(\"li\",[e._v(\"é¦–å…ˆå¯¹æ¯”zxidã€‚zxidå¤§çš„æœåŠ¡å™¨ä¼˜å…ˆä½œä¸ºLeader\")]),e._v(\" \"),r(\"li\",[e._v(\"è‹¥zxidç›¸åŒï¼Œæ¯”å¦‚åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæ¯ä¸ªServerçš„zxidéƒ½ä¸º0ï¼Œå°±ä¼šæ¯”è¾ƒmyidï¼Œmyidå¤§çš„é€‰å‡ºæ¥åšLeaderã€‚\")])]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"æœåŠ¡å™¨åˆå§‹åŒ–æ—¶é€‰ä¸¾\")])]),e._v(\" \"),r(\"blockquote\",[r(\"p\",[e._v(\"ç›®å‰æœ‰3å°æœåŠ¡å™¨ï¼Œæ¯å°æœåŠ¡å™¨å‡æ²¡æœ‰æ•°æ®ï¼Œå®ƒä»¬çš„ç¼–å·åˆ†åˆ«æ˜¯1,2,3æŒ‰ç¼–å·ä¾æ¬¡å¯åŠ¨ï¼Œå®ƒä»¬çš„é€‰æ‹©ä¸¾è¿‡ç¨‹å¦‚ä¸‹ï¼š\")])]),e._v(\" \"),r(\"ol\",[r(\"li\",[e._v(\"Server1å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ˆ1,0ï¼‰ï¼Œç„¶åå‘æŠ•ç¥¨ä¿¡æ¯ï¼Œç”±äºå…¶å®ƒæœºå™¨è¿˜æ²¡æœ‰å¯åŠ¨æ‰€ä»¥å®ƒæ”¶ä¸åˆ°åé¦ˆä¿¡æ¯ï¼ŒServer1çš„çŠ¶æ€ä¸€ç›´å±äºLookingã€‚\")]),e._v(\" \"),r(\"li\",[e._v(\"Server2å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ˆ2,0ï¼‰ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„Server1äº¤æ¢ç»“æœï¼Œç”±äºServer2çš„ç¼–å·å¤§æ‰€ä»¥Server2èƒœå‡ºï¼Œ\"),r(\"strong\",[e._v(\"ä½†æ­¤æ—¶æŠ•ç¥¨æ•°æ­£å¥½å¤§äºåŠæ•°\")]),e._v(\"ï¼Œæ‰€ä»¥Server2æˆä¸ºé¢†å¯¼è€…ï¼ŒServer1æˆä¸ºå°å¼Ÿã€‚\")]),e._v(\" \"),r(\"li\",[e._v(\"Server3å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ˆ3,0ï¼‰ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„Server1,Server2æ¢ä¿¡æ¯ï¼Œå°½ç®¡Server3çš„ç¼–å·å¤§ï¼Œä½†ä¹‹å‰Server2å·²ç»èƒœå‡ºï¼Œæ‰€ä»¥Server3åªèƒ½æˆä¸ºå°å¼Ÿã€‚\")]),e._v(\" \"),r(\"li\",[e._v(\"å½“ç¡®å®šäº†Leaderä¹‹åï¼Œæ¯ä¸ªServeræ›´æ–°è‡ªå·±çš„çŠ¶æ€ï¼ŒLeaderå°†çŠ¶æ€æ›´æ–°ä¸ºLeadingï¼ŒFollowerå°†çŠ¶æ€æ›´æ–°ä¸ºFollowingã€‚\")])]),e._v(\" \"),r(\"p\",[r(\"strong\",[e._v(\"æœåŠ¡å™¨è¿è¡ŒæœŸé—´çš„é€‰ä¸¾\")])]),e._v(\" \"),r(\"blockquote\",[r(\"p\",[e._v(\"zookeeperè¿è¡ŒæœŸé—´ï¼Œå¦‚æœæœ‰æ–°çš„ServeråŠ å…¥ï¼Œæˆ–è€…éLeaderçš„Serverå®•æœºï¼Œé‚£ä¹ˆLeaderå°†ä¼šåŒæ­¥æ•°æ®åˆ°æ–°Serveræˆ–è€…å¯»æ‰¾å…¶ä»–å¤‡ç”¨Serveræ›¿ä»£å®•æœºçš„Serverã€‚è‹¥Leaderå®•æœºï¼Œæ­¤æ—¶é›†ç¾¤æš‚åœå¯¹å¤–æœåŠ¡ï¼Œå¼€å§‹åœ¨å†…éƒ¨é€‰ä¸¾æ–°çš„Leaderã€‚å‡è®¾å½“å‰é›†ç¾¤ä¸­æœ‰Server1ã€Server2ã€Server3ä¸‰å°æœåŠ¡å™¨ï¼ŒServer2ä¸ºå½“å‰é›†ç¾¤çš„Leaderï¼Œç”±äºæ„å¤–æƒ…å†µï¼ŒServer2å®•æœºäº†ï¼Œä¾¿å¼€å§‹è¿›å…¥é€‰ä¸¾çŠ¶æ€ã€‚è¿‡ç¨‹å¦‚ä¸‹\")])]),e._v(\" \"),r(\"ol\",[r(\"li\",[e._v(\"å˜æ›´çŠ¶æ€ã€‚å…¶ä»–çš„éObserveræœåŠ¡å™¨å°†è‡ªå·±çš„çŠ¶æ€æ”¹å˜ä¸ºLookingï¼Œå¼€å§‹è¿›å…¥Leaderé€‰ä¸¾ã€‚\")]),e._v(\" \"),r(\"li\",[e._v(\"æ¯ä¸ªServerå‘å‡ºä¸€ä¸ªæŠ•ç¥¨ï¼ˆmyidï¼Œzxidï¼‰ï¼Œç”±äºæ­¤é›†ç¾¤å·²ç»è¿è¡Œè¿‡ï¼Œæ‰€ä»¥æ¯ä¸ªServerä¸Šçš„zxidå¯èƒ½ä¸åŒã€‚å‡è®¾Server1çš„zxidä¸º100ï¼ŒServer3çš„ä¸º99ï¼Œç¬¬ä¸€è½®æŠ•ç¥¨ä¸­ï¼ŒServer1å’ŒServer3éƒ½æŠ•è‡ªå·±ï¼Œç¥¨åˆ†åˆ«ä¸ºï¼ˆ1ï¼Œ100ï¼‰,ï¼ˆ3,99ï¼‰,å°†è‡ªå·±çš„ç¥¨å‘é€ç»™é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨ã€‚\")]),e._v(\" \"),r(\"li\",[e._v(\"æ¯ä¸ªServeræ¥æ”¶æ¥æ”¶æ¥è‡ªå…¶ä»–Serverçš„æŠ•ç¥¨ï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤ä¸å¯åŠ¨æ—¶æ­¥éª¤ç›¸åŒã€‚\")])])])}),[],!1,null,null,null);v.default=o.exports}}]);","extractedComments":[]}