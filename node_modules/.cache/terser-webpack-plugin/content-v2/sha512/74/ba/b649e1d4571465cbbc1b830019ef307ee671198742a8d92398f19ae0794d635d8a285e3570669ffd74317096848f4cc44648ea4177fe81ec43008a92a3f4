{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{577:function(t,s,a){\"use strict\";a.r(s);var r=a(6),e=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[a(\"blockquote\",[a(\"p\",[t._v(\"对于正在运行的 MySQL，性能如何，参数设置的是否合理，账号设置的是否存在安全隐患，你是否了然于胸呢？\")]),t._v(\" \"),a(\"p\",[t._v(\"俗话说工欲善其事，必先利其器，定期对你的 MySQL 数据库进行一个体检，是保证数据库安全运行的重要手段，因为，好的工具是使你的工作效率倍增！\")]),t._v(\" \"),a(\"p\",[t._v(\"今天和大家分享几个 MySQL 优化的工具，你可以使用它们对你的 MySQL 进行一个体检，生成 awr 报告，让你从整体上把握你的数据库的性能情况。\")])]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/Jstarfish/picBed/img/00000.png\",alt:\"\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"一、mysqltuner-pl\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#一、mysqltuner-pl\"}},[t._v(\"#\")]),t._v(\" 一、mysqltuner.pl\")]),t._v(\" \"),a(\"p\",[t._v(\"是 MySQL 一个常用的数据库性能诊断工具，主要检查参数设置的合理性包括日志文件、存储引擎、安全建议及性能分析。针对潜在的问题，给出改进的建议。是 MySQL 优化的好帮手。\")]),t._v(\" \"),a(\"p\",[t._v(\"在上一版本中，MySQLTuner支持 MySQL / MariaDB / Percona Server 的约 300 个指标。\")]),t._v(\" \"),a(\"p\",[t._v(\"项目地址：\"),a(\"a\",{attrs:{href:\"https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fmajor%2FMySQLTuner-perl\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"https://github.com/major/MySQLTuner-perl\"),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"h3\",{attrs:{id:\"_1-1-下载\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-1-下载\"}},[t._v(\"#\")]),t._v(\" 1.1 下载\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-cpp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-cpp\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root@localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"#wget https\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//raw.githubusercontent.com/major/MySQLTuner-perl/master/mysqltuner.pl\")]),t._v(\"\\n\")])])]),a(\"h3\",{attrs:{id:\"_1-2-使用\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-2-使用\"}},[t._v(\"#\")]),t._v(\" 1.2 使用\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-csharp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-csharp\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root@localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"# \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysqltuner\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"pl \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"socket \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"sock\\n \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">>\")]),t._v(\" MySQLTuner \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1.7\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".4\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\" Major Hayden \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"<\")]),t._v(\"major@mhtx\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"net\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\"\\n \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">>\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Bug\")]),t._v(\" reports\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"feature\")]),t._v(\" requests\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"and\")]),t._v(\" downloads \"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"at\")]),t._v(\" http\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysqltuner\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"com\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"\\n \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">>\")]),t._v(\" Run with '\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"help' \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"for\")]),t._v(\" additional options \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"and\")]),t._v(\" output filtering\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" Skipped version check \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"for\")]),t._v(\" MySQLTuner script\\nPlease enter your MySQL \"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"administrative\")]),t._v(\" login\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" root\\nPlease enter your MySQL \"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"administrative\")]),t._v(\" password\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),a(\"span\",{pre:!0,attrs:{class:\"token attribute\"}},[a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"OK\")])]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" Currently running supported MySQL version \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"5.7\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".23\")]),t._v(\"\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"OK\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\" Operating \"),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"on\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"64\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"bit architecture\\n\")])])]),a(\"h3\",{attrs:{id:\"_1-3-报告分析\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-3-报告分析\"}},[t._v(\"#\")]),t._v(\" 1.3 报告分析\")]),t._v(\" \"),a(\"p\",[t._v(\"1）重要关注[!!]（中括号有叹号的项）例如[!!] Maximum possible memory usage: 4.8G (244.13% of installed RAM)，表示内存已经严重用超了。\")]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/Jstarfish/picBed/img/11111.png\",alt:\"\"}})]),t._v(\" \"),a(\"p\",[t._v(\"2）关注最后给的建议“Recommendations ”。\")]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/Jstarfish/picBed/img/22222.png\",alt:\"\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"二、tuning-primer-sh\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#二、tuning-primer-sh\"}},[t._v(\"#\")]),t._v(\" 二、tuning-primer.sh\")]),t._v(\" \"),a(\"p\",[t._v(\"MySQL 的另一个优化工具，针于MySQL的整体进行一个体检，对潜在的问题，给出优化的建议。\")]),t._v(\" \"),a(\"p\",[t._v(\"项目地址：\"),a(\"a\",{attrs:{href:\"https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2FBMDan%2Ftuning-primer.sh\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"https://github.com/BMDan/tuning-primer.sh\"),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"p\",[t._v(\"目前，支持检测和优化建议的内容如下：\")]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/Jstarfish/picBed/img/33333.png\",alt:\"\"}})]),t._v(\" \"),a(\"p\",[t._v(\"2.1 下载\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-cpp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-cpp\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root@localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"#wget https\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"//launchpad.net/mysql-tuning-primer/trunk/1.6-r1/+download/tuning-primer.sh\")]),t._v(\"\\n\")])])]),a(\"p\",[t._v(\"2.2 使用\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-ruby extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-ruby\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root\"),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"@localhost\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),a(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"# [root@localhost dba]# ./tuning-primer.sh\")]),t._v(\"\\n\\n \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"MYSQL\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"PERFORMANCE\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"TUNING\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"PRIMER\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"\\n \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"By\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"Matthew\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token constant\"}},[t._v(\"Montgomery\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"\\n\")])])]),a(\"p\",[t._v(\"2.3 报告分析\")]),t._v(\" \"),a(\"p\",[t._v(\"重点查看有红色告警的选项，根据建议结合自己系统的实际情况进行修改，例如：\")]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/Jstarfish/picBed/img/44444.png\",alt:\"\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"三、pt-variable-advisor\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#三、pt-variable-advisor\"}},[t._v(\"#\")]),t._v(\" 三、pt-variable-advisor\")]),t._v(\" \"),a(\"p\",[t._v(\"pt-variable-advisor 可以分析MySQL变量并就可能出现的问题提出建议。\")]),t._v(\" \"),a(\"p\",[t._v(\"3.1 安装\")]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.percona.com%2Fdownloads%2Fpercona-toolkit%2FLATEST%2F\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"https://www.percona.com/downloads/percona-toolkit/LATEST/\"),a(\"OutboundLink\")],1)]),t._v(\" \"),a(\"div\",{staticClass:\"language-csharp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-csharp\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root@localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"#\"),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"wget\")]),t._v(\" https\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"www\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"percona\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"com\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"downloads\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"percona\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"toolkit\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"3.0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".13\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"binary\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"redhat\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"7\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"x86_64\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"percona\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"toolkit\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"3.0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".13\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"re85ce15\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"el7\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"x86_64\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"bundle\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"tar\\n\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root@localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"#yum install percona\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"toolkit\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"3.0\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\".13\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"1\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"el7\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"x86_64\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"rpm\\n\")])])]),a(\"p\",[t._v(\"3.2 使用\")]),t._v(\" \"),a(\"p\",[t._v(\"pt-variable-advisor是pt工具集的一个子工具，主要用来诊断你的参数设置是否合理。\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-csharp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-csharp\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root@localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"# pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"variable\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"advisor localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"socket \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"sock\\n\")])])]),a(\"p\",[t._v(\"3.3 报告分析\")]),t._v(\" \"),a(\"p\",[t._v(\"重点关注有WARN的信息的条目，例如：\")]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/Jstarfish/picBed/img/55555.png\",alt:\"\"}})]),t._v(\" \"),a(\"h2\",{attrs:{id:\"四、pt-qurey-digest\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#四、pt-qurey-digest\"}},[t._v(\"#\")]),t._v(\" 四、pt-qurey-digest\")]),t._v(\" \"),a(\"p\",[t._v(\"pt-query-digest 主要功能是从日志、进程列表和tcpdump分析MySQL查询。\")]),t._v(\" \"),a(\"p\",[t._v(\"4.1安装\")]),t._v(\" \"),a(\"p\",[t._v(\"具体参考3.1节\")]),t._v(\" \"),a(\"p\",[t._v(\"4.2使用\")]),t._v(\" \"),a(\"p\",[t._v(\"pt-query-digest主要用来分析mysql的慢日志，与mysqldumpshow工具相比，py-query_digest 工具的分析结果更具体，更完善。\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-csharp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-csharp\"}},[a(\"code\",[a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"[\")]),t._v(\"root@localhost \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"~\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"]\")]),t._v(\"# pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"query\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"digest \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"slowtest\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"slow\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\\n\")])])]),a(\"p\",[t._v(\"4.3 常见用法分析\")]),t._v(\" \"),a(\"p\",[t._v(\"1）直接分析慢查询文件:\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-cpp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-cpp\"}},[a(\"code\",[t._v(\"pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"query\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"digest \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"var\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"slowtest\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"slow\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" slow_report\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\\n\")])])]),a(\"p\",[t._v(\"2）分析最近12小时内的查询：\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-cpp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-cpp\"}},[a(\"code\",[t._v(\"pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"query\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"digest \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"since\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"12\")]),t._v(\"h \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"var\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"slowtest\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"slow\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" slow_report2\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\\n\")])])]),a(\"p\",[t._v(\"3）分析指定时间范围内的查询：\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-csharp extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-csharp\"}},[a(\"code\",[t._v(\"pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"query\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"digest \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"slowtest\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"slow\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"since '\"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"2017\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"01\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"07\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"09\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"30\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"00\")]),t._v(\"' \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"until '\"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"2017\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"01\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"07\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"10\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"00\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\":\")]),a(\"span\",{pre:!0,attrs:{class:\"token number\"}},[t._v(\"00\")]),t._v(\"'\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" slow_report3\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\\n\")])])]),a(\"p\",[t._v(\"4）分析指含有select语句的慢查询\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-dart extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-dart\"}},[a(\"code\",[t._v(\"pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"query\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"digest \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"filter \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'$event->{fingerprint} =~ m/^select/i'\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"slowtest\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"slow\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" slow_report4\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\\n\")])])]),a(\"p\",[t._v(\"5）针对某个用户的慢查询\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-dart extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-dart\"}},[a(\"code\",[t._v(\"pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"query\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"digest \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"--\")]),t._v(\"filter \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v(\"'($event->{user} || \\\"\\\") =~ m/^root/i'\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),a(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"var\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"slowtest\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"slow\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" slow_report5\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\\n\")])])]),a(\"p\",[t._v(\"6）查询所有所有的全表扫描或full join的慢查询\")]),t._v(\" \"),a(\"div\",{staticClass:\"language-rust extra-class\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-rust\"}},[a(\"code\",[t._v(\"pt\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"query\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"digest \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"filter '\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$event\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"->\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Full_scan\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"||\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" eq \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"yes\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"||\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[t._v(\"$event\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"->\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),a(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Full_join\")]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"||\")]),t._v(\" \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" eq \"),a(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"yes\"')]),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"' \"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"var\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"lib\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"mysql\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"/\")]),t._v(\"slowtest\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"-\")]),t._v(\"slow\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\"),a(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\">\")]),t._v(\" slow_report6\"),a(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),t._v(\"log\\n\")])])]),a(\"p\",[t._v(\"4.4 报告分析\")]),t._v(\" \"),a(\"ul\",[a(\"li\",[t._v(\"第一部分：总体统计结果 Overall：总共有多少条查询 Time range：查询执行的时间范围 unique：唯一查询数量，即对查询条件进行参数化以后，总共有多少个不同的查询 total：总计 min：最小 max：最大 avg：平均 95%：把所有值从小到大排列，位置位于95%的那个数，这个数一般最具有参考价值 median：中位数，把所有值从小到大排列，位置位于中间那个数\")]),t._v(\" \"),a(\"li\",[t._v(\"第二部分：查询分组统计结果 Rank：所有语句的排名，默认按查询时间降序排列，通过--order-by指定 Query ID：语句的ID，（去掉多余空格和文本字符，计算hash值） Response：总的响应时间 time：该查询在本次分析中总的时间占比 calls：执行次数，即本次分析总共有多少条这种类型的查询语句 R/Call：平均每次执行的响应时间 V/M：响应时间Variance-to-mean的比率 Item：查询对象\")]),t._v(\" \"),a(\"li\",[t._v(\"第三部分：每一种查询的详细统计结果 ID：查询的ID号，和上图的Query ID对应 Databases：数据库名 Users：各个用户执行的次数（占比） Query_time distribution ：查询时间分布, 长短体现区间占比。Tables：查询中涉及到的表 Explain：SQL语句\")])]),t._v(\" \"),a(\"blockquote\",[a(\"p\",[t._v(\"来源：https://www.jianshu.com/p/cb2be017d5a9\")])]),t._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/Jstarfish/picBed/img/end%20(13).jpg\",alt:\"\"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);","extractedComments":[]}